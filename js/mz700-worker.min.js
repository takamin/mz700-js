!function(){return function e(t,c,n){function s(i,r){if(!c[i]){if(!t[i]){var a="function"==typeof require&&require;if(!r&&a)return a(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=c[i]={exports:{}};t[i][0].call(d.exports,function(e){return s(t[i][1][e]||e)},d,d.exports,e,t,c,n)}return c[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)s(n[i]);return s}}()({1:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});class n{constructor(e,t,c,n,s){this.strobe=e,this.bit=t,this.face=c||"&nbsp;",this.code=n||[],this.strcode=s||c}}class s{constructor(){this.keymap=new Array(10).fill(255)}getKeyData(e){let t=255;return(e&=15)<this.keymap.length&&(t=this.keymap[e]),t}setKeyMatrixState(e,t,c){c?this.keymap[e]&=255&~(1<<t):this.keymap[e]|=1<<t&255}}c.default=s,s.KeyCodes={Escape:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Numlock:44,ScrollLock:145,Pause:19,D0:48,D1:49,D2:50,D3:51,D4:52,D5:53,D6:54,D7:55,D8:56,D9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,Subtract:109,Caret:107,Atmark:192,Yen:106,Colon:186,SemiColon:187,Comma:188,Decimal:190,Divide:111,Backslash:226,OpenBrackets:219,CloseBrackets:221,Shift:16,Control:17,Alternate:18,Enter:13,Tab:9,Space:32,Backspace:8,Insert:45,Delete:46,Home:36,End:35,PageUp:33,PageDown:34,Left:37,Up:38,Right:39,Down:40,NumPad0:96,NumPad1:97,NumPad2:98,NumPad3:99,NumPad4:100,NumPad5:101,NumPad6:102,NumPad7:103,NumPad8:104,NumPad9:105,NumPadDivide:191,NumPadMultiply:220,NumPadSubtract:189,NumPadPlus:222,NumPadDecimal:110,Hankaku:243,Zenkaku:244},s.Keys=[new n(0,0,"CR",[s.KeyCodes.Enter]),new n(0,1,":",[s.KeyCodes.Colon]),new n(0,2,";",[s.KeyCodes.SemiColon]),new n(0,3),new n(0,4,"英数",[s.KeyCodes.F10,s.KeyCodes.End],"ALNUM"),new n(0,5,"=",[s.KeyCodes.Backspace]),new n(0,6,"GRAPH",[s.KeyCodes.F12,s.KeyCodes.PageDown,s.KeyCodes.Alternate],"GRAPH"),new n(0,7,"カナ",[s.KeyCodes.F11,s.KeyCodes.PageUp],"KANA"),new n(1,0),new n(1,1),new n(1,2),new n(1,3,")",[s.KeyCodes.CloseBrackets]),new n(1,4,"(",[s.KeyCodes.OpenBrackets]),new n(1,5,"@",[s.KeyCodes.Atmark]),new n(1,6,"Z",[s.KeyCodes.Z]),new n(1,7,"Y",[s.KeyCodes.Y]),new n(2,0,"X",[s.KeyCodes.X]),new n(2,1,"W",[s.KeyCodes.W]),new n(2,2,"V",[s.KeyCodes.V]),new n(2,3,"U",[s.KeyCodes.U]),new n(2,4,"T",[s.KeyCodes.T]),new n(2,5,"S",[s.KeyCodes.S]),new n(2,6,"R",[s.KeyCodes.R]),new n(2,7,"Q",[s.KeyCodes.Q]),new n(3,0,"P",[s.KeyCodes.P]),new n(3,1,"O",[s.KeyCodes.O]),new n(3,2,"N",[s.KeyCodes.N]),new n(3,3,"M",[s.KeyCodes.M]),new n(3,4,"L",[s.KeyCodes.L]),new n(3,5,"K",[s.KeyCodes.K]),new n(3,6,"J",[s.KeyCodes.J]),new n(3,7,"I",[s.KeyCodes.I]),new n(4,0,"H",[s.KeyCodes.H]),new n(4,1,"G",[s.KeyCodes.G]),new n(4,2,"F",[s.KeyCodes.F]),new n(4,3,"E",[s.KeyCodes.E]),new n(4,4,"D",[s.KeyCodes.D]),new n(4,5,"C",[s.KeyCodes.C]),new n(4,6,"B",[s.KeyCodes.B]),new n(4,7,"A",[s.KeyCodes.A]),new n(5,0,"8",[s.KeyCodes.D8,s.KeyCodes.NumPad8]),new n(5,1,"7",[s.KeyCodes.D7,s.KeyCodes.NumPad7]),new n(5,2,"6",[s.KeyCodes.D6,s.KeyCodes.NumPad6]),new n(5,3,"5",[s.KeyCodes.D5,s.KeyCodes.NumPad5]),new n(5,4,"4",[s.KeyCodes.D4,s.KeyCodes.NumPad4]),new n(5,5,"3",[s.KeyCodes.D3,s.KeyCodes.NumPad3]),new n(5,6,"2",[s.KeyCodes.D2,s.KeyCodes.NumPad2]),new n(5,7,"1",[s.KeyCodes.D1,s.KeyCodes.NumPad1]),new n(6,0,".",[s.KeyCodes.Decimal,110]),new n(6,1,",",[s.KeyCodes.Comma]),new n(6,2,"9",[s.KeyCodes.D9,s.KeyCodes.NumPad9]),new n(6,3,"0",[s.KeyCodes.D0,s.KeyCodes.NumPad0]),new n(6,4,"SPC",[s.KeyCodes.Space]," "),new n(6,5,"-",[s.KeyCodes.Subtract,s.KeyCodes.NumPadSubtract]),new n(6,6,"+",[s.KeyCodes.Caret,s.KeyCodes.NumPadPlus]),new n(6,7,"*",[s.KeyCodes.Yen,s.KeyCodes.NumPadMultiply]),new n(7,0,"/",[s.KeyCodes.Divide,s.KeyCodes.NumPadDivide]),new n(7,1,"?",[s.KeyCodes.Backslash]),new n(7,2,"←",[s.KeyCodes.Left],"LEFT"),new n(7,3,"→",[s.KeyCodes.Right],"RIGHT"),new n(7,4,"↓",[s.KeyCodes.Down],"DOWN"),new n(7,5,"↑",[s.KeyCodes.Up],"UP"),new n(7,6,"DEL",[s.KeyCodes.Delete]),new n(7,7,"INS",[s.KeyCodes.Insert]),new n(8,0,"SHIFT",[s.KeyCodes.Shift]),new n(8,1,"(BS)"),new n(8,2),new n(8,3,"(→)",[s.KeyCodes.Tab]),new n(8,4,"(CR)"),new n(8,5,"(SHIFT)"),new n(8,6,"CTRL",[s.KeyCodes.Control]),new n(8,7,"BREAK",[s.KeyCodes.Escape,s.KeyCodes.Pause]),new n(9,0,"HOME",[s.KeyCodes.Home]),new n(9,1,"(SPC)"),new n(9,2,"(↓)"),new n(9,3,"F5",[s.KeyCodes.F5]),new n(9,4,"F4",[s.KeyCodes.F4]),new n(9,5,"F3",[s.KeyCodes.F3]),new n(9,6,"F2",[s.KeyCodes.F2]),new n(9,7,"F1",[s.KeyCodes.F1])],s.KeyNames=(e=>(Object.keys(s.KeyCodes).forEach(t=>{const c=s.KeyCodes[t];e[c]=t}),e))({}),s.Code2Key=(()=>{const e=new Array(256);return s.Keys.forEach(t=>{t.code.forEach(c=>{e[c]=t})}),e})(),s.Str2Key=(()=>{const e={};return s.Keys.forEach(t=>{e[t.strcode]=t}),e})(),t.exports=s},{}],2:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./mz700-new-monitor")),o=n(e("../Z80/memory-block")),i=n(e("../Z80/memory-block-cbw")),r=n(e("../Z80/memory-block-cbrw")),a=n(e("../Z80/memory-bank"));class l extends a.default{constructor(){super({}),this._block1VRAM=!0,this._disabledBlock1=!1}create(e){super.create(e);const t=new s.default;t.create();const c=e.onVramUpdate||(()=>{}),n=Array(1e3).fill(0),a=Array(1e3).fill(113);this.memblks={IPL_AREA_ROM:t,IPL_AREA_RAM:new o.default({startAddr:0,size:4096}),FREE_RAM:new o.default({startAddr:4096,size:49152}),TEXT_VRAM:new i.default({startAddr:53248,size:2048,onPoke:(e,t)=>{if(53248<=e&&e<54248){const s=e-53248;n[s]=t,c(s,t,a[s])}}}),ATTR_VRAM:new i.default({startAddr:55296,size:2048,onPoke:(e,t)=>{if(55296<=e&&e<56296){const s=e-55296;a[s]=t,c(s,n[s],t)}}}),MMAPED_IO:new r.default({startAddr:57344,size:2048,onPeek:e.onMappedIoRead||(()=>0),onPoke:e.onMappedIoUpdate||(()=>{})}),EXTND_ROM:new o.default({startAddr:59392,size:6144}),DRAM:new o.default({startAddr:53248,size:12288})},this._block1VRAM=!0,this._disabledBlock1=!1,this.changeBlock0_MONITOR(),this.setMemoryBlock("FREE_RAM",this.memblks.FREE_RAM),this.changeBlock1_VRAM();for(let e=0;e<2048;e++)this.memblks.ATTR_VRAM.pokeByte(55296+e,113)}setMonitorRom(e){this.memblks.IPL_AREA_ROM.setBinary(e)}clear(){a.default.prototype.clear.call(this),Object.values(this.memblks).forEach(e=>e.clear())}getTextVram(){return this.memblks.TEXT_VRAM}getAttrVram(){return this.memblks.ATTR_VRAM}changeBlock0_MONITOR(){this.setMemoryBlock("IPL_AREA",this.memblks.IPL_AREA_ROM)}changeBlock0_DRAM(){this.setMemoryBlock("IPL_AREA",this.memblks.IPL_AREA_RAM)}changeBlock1_DRAM(){this._block1VRAM=!1,this._disabledBlock1=!1,this.setMemoryBlock("TEXT_VRAM",null),this.setMemoryBlock("ATTR_VRAM",null),this.setMemoryBlock("MMAPED_IO",null),this.setMemoryBlock("EXTND_ROM",null),this.setMemoryBlock("DRAM",this.memblks.DRAM)}changeBlock1_VRAM(){this._block1VRAM=!0,this._disabledBlock1=!1,this.setMemoryBlock("DRAM",null),this.setMemoryBlock("TEXT_VRAM",this.memblks.TEXT_VRAM),this.setMemoryBlock("ATTR_VRAM",this.memblks.ATTR_VRAM),this.setMemoryBlock("MMAPED_IO",this.memblks.MMAPED_IO),this.setMemoryBlock("EXTND_ROM",this.memblks.EXTND_ROM)}disableBlock1(){this._disabledBlock1||(this._disabledBlock1=!0,this.setMemoryBlock("TEXT_VRAM",null),this.setMemoryBlock("ATTR_VRAM",null),this.setMemoryBlock("MMAPED_IO",null),this.setMemoryBlock("EXTND_ROM",null),this.setMemoryBlock("DRAM",null))}enableBlock1(){this._disabledBlock1&&(this._block1VRAM?this.changeBlock1_VRAM():this.changeBlock1_DRAM(),this._disabledBlock1=!1)}}c.default=l,t.exports=l},{"../Z80/memory-bank":10,"../Z80/memory-block":13,"../Z80/memory-block-cbrw":11,"../Z80/memory-block-cbw":12,"./mz700-new-monitor":3}],3:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("../Z80/memory-block"));class o extends s.default{constructor(){super()}create(){s.default.prototype.create.call(this,{startAddr:0,size:4096})}setBinary(e){for(let t=0;t<this.size;t++){const c=this.startAddr+t;s.default.prototype.pokeByte.call(this,c,e[c])}}pokeByte(e,t){}}c.default=o,t.exports=o},{"../Z80/memory-block":13}],4:[function(e,t,c){"use strict";var n=this&&this.__awaiter||function(e,t,c,n){return new(c||(c=Promise))(function(s,o){function i(e){try{a(n.next(e))}catch(e){o(e)}}function r(e){try{a(n.throw(e))}catch(e){o(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof c?t:new c(function(e){e(t)})).then(i,r)}a((n=n.apply(e,t||[])).next())})},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const o=e("transworker"),i=s(e("./mz700")),r=s(e("../lib/mz700-canvas-renderer")),a=s(e("../lib/mz700-cg.js")),l=s(e("../lib/PCG-700.js"));function d(e,t){const c=new i.default;let n=!0;return c.create({started:()=>e.postNotify("start"),stopped:()=>e.postNotify("stop"),onBreak:()=>e.postNotify("onBreak"),onVramUpdate:(e,c,s)=>{t.writeVram(e,s,c),n=!0},startSound:t=>e.postNotify("startSound",[t]),stopSound:()=>e.postNotify("stopSound"),onStartDataRecorder:()=>e.postNotify("onStartDataRecorder"),onStopDataRecorder:()=>e.postNotify("onStopDataRecorder")}),e.listenTransferableObject("offscreenCanvas",c=>{t.create({canvas:c,CG:new a.default(a.default.ROM,8,8)}),t.setupRendering(),setInterval(()=>{if(n){const c=t.getImageData();e.postNotify("onUpdateScrn",c,[c.data.buffer]),n=!1}},1e3/24)}),c}(function(){return n(this,void 0,void 0,function*(){const e=new o,t=new r.default,c=d(e,t),n=new l.default(t);c.attachPCG700(n),e.create(c)})})().catch(e=>console.error(`Error: ${e.stack}`))},{"../lib/PCG-700.js":15,"../lib/mz700-canvas-renderer":24,"../lib/mz700-cg.js":25,"./mz700":5,transworker:39}],5:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("fractional-timer")),o=n(e("../lib/mz-tape-header")),i=n(e("../lib/mz-tape")),r=n(e("../lib/mz-data-recorder")),a=n(e("../lib/intel-8253")),l=n(e("../lib/flip-flop-counter")),d=n(e("../lib/ic556")),u=n(e("../lib/mz-mmio.js")),m=n(e("./mz700-key-matrix")),p=n(e("./mz700-memory.js")),f=n(e("../Z80/Z80.js")),h=n(e("../Z80/Z80-line-assembler")),y=n(e("../lib/PCG-700"));class A{constructor(){}create(e){this.keymatrix=new m.default,this.intel8253=new a.default,this.intel8253.counter(1).initCount(15700,()=>{this.intel8253.counter(2).count(1)}),this.intel8253.counter(2).initCount(43200,()=>{this.INTMSK&&this.z80.interrupt()}),this.hblank=new l.default(A.Z80_CLOCK/15700),this.hblank.addEventListener("change",()=>{this.intel8253.counter(1).count(1)}),this.vblank=new l.default(A.Z80_CLOCK/50),this.VBLK=!1,this.vblank.addEventListener("change",()=>{this.VBLK=!this.VBLK}),this.ic556=new d.default(A.Z80_CLOCK/3),this.ic556Out=!1,this.ic556.addEventListener("change",()=>{this.ic556Out=!this.ic556Out}),this.INTMSK=!1,this.MLDST=!1;let t=null;this.dataRecorder=new r.default(e=>{e?(null!=t&&(clearTimeout(t),t=null),this.opt.onStartDataRecorder()):t=setTimeout(()=>{t=null,this.opt.onStopDataRecorder()},100)}),this.opt={started:()=>{},stopped:()=>{},onBreak:()=>{},onVramUpdate:()=>{},onUpdateScrn:()=>{},onMmioRead:()=>{},onMmioWrite:()=>{},startSound:()=>{},stopSound:()=>{},onStartDataRecorder:()=>{},onStopDataRecorder:()=>{}},e=e||{},Object.keys(e).forEach(e=>{e in this.opt||console.warn(`Unknown option key ${e} is specified.`)}),Object.keys(this.opt).forEach(t=>{t in e&&(this.opt[t]=e[t])}),this.tid=null,this.clockFactor=1,this.tidMeasClock=null,this.tCycle0=0,this.actualClockFreq=0,this._cycleToWait=0,this.mmio=new u.default;for(let e=57344;e<59392;e++)this.mmio.onRead(e,t=>this.opt.onMmioRead(e,t)),this.mmio.onWrite(e,t=>this.opt.onMmioWrite(e,t));this.mmio.onWrite(57344,e=>{this.memory.poke(57345,this.keymatrix.getKeyData(e)),this.ic556.loadReset(0!=(128&e))}),this.mmio.onRead(57346,e=>(e&=15,this.dataRecorder.motor()?e|=16:e&=239,this.dataRecorder_readBit()?e|=32:e&=223,this.ic556Out?e|=64:e&=191,this.VBLK?e|=128:e&=127,e)),this.mmio.onWrite(57347,e=>{if(0==(128&e)){const t=0!=(1&e);switch((14&e)>>1){case 0:break;case 1:this.dataRecorder_writeBit(t);break;case 2:this.INTMSK=t;break;case 3:this.dataRecorder_motorOn(t)}}}),this.mmio.onRead(57348,()=>this.intel8253.counter(0).read()),this.mmio.onWrite(57348,e=>{this.intel8253.counter(0).load(e)&&this.MLDST&&this.opt.startSound(895e3/this.intel8253.counter(0).value)}),this.mmio.onRead(57349,()=>this.intel8253.counter(1).read()),this.mmio.onWrite(57349,e=>this.intel8253.counter(1).load(e)),this.mmio.onRead(57350,()=>this.intel8253.counter(2).read()),this.mmio.onWrite(57350,e=>this.intel8253.counter(2).load(e)),this.mmio.onWrite(57351,e=>this.intel8253.setCtrlWord(e)),this.mmio.onRead(57352,e=>(e&=254,this.hblank.readOutput()?e|=1:e&=254,e)),this.mmio.onWrite(57352,e=>{this.MLDST=0!=(1&e),this.MLDST?this.opt.startSound(895e3/this.intel8253.counter(0).value):this.opt.stopSound()}),this.memory=new p.default,this.memory.create({onVramUpdate:(e,t,c)=>{this.opt.onVramUpdate(e,t,c)},onMappedIoRead:(e,t)=>{const c=this.mmio.read(e,t);return null==c||void 0===c?t:c},onMappedIoUpdate:(e,t)=>(this.mmio.write(e,t),t)}),this.z80=new f.default({memory:this.memory}),this.z80.onWriteIoPort(224,()=>this.memory.changeBlock0_DRAM()),this.z80.onWriteIoPort(225,()=>this.memory.changeBlock1_DRAM()),this.z80.onWriteIoPort(226,()=>this.memory.changeBlock0_MONITOR()),this.z80.onWriteIoPort(227,()=>this.memory.changeBlock1_VRAM()),this.z80.onWriteIoPort(228,()=>{this.memory.changeBlock0_MONITOR(),this.memory.changeBlock1_VRAM()}),this.z80.onWriteIoPort(229,()=>this.memory.disableBlock1()),this.z80.onWriteIoPort(230,()=>this.memory.enableBlock1())}setMonitorRom(e){this.memory.setMonitorRom(e)}writeAsmCode(e){for(let t=0;t<e.buffer.length;t++)this.memory.poke(e.minAddr+t,e.buffer[t]);return e.minAddr}exec(e){e=e||1;try{for(let t=0;t<e;t++)this.z80.exec(),this.clock()}catch(e){return-1}return 0}clock(){this.hblank.count(),this.vblank.count(),this.ic556.count()}setCassetteTape(e){if(e.length>0){if(e.length<=128)return this.dataRecorder_setCmt([]),console.error("error buf.length <= 128"),null;if(this.mztArray=i.default.parseMZT(e),null==this.mztArray||this.mztArray.length<1)return console.error("setCassetteTape fail to parse"),null}return this.dataRecorder_setCmt(e),this.mztArray}getCassetteTape(){const e=this.dataRecorder.getCmt();return null==e?null:i.default.toBytes(e)}loadCassetteTape(){for(const e of this.mztArray)for(let t=0;t<e.header.fileSize;t++)this.memory.poke(e.header.addrLoad+t,e.body.buffer[t])}reset(){this.memory.enableBlock1(),this.memory.enableBlock1(),this.memory.changeBlock0_MONITOR(),this.memory.changeBlock1_VRAM();for(let e=0;e<1e3;e++)this.memory.poke(53248+e,0),this.memory.poke(55296+e,113);this.z80.reset()}getRegister(){const e=this.z80.reg.cloneRaw(),t=this.z80.regB.cloneRaw();return e.IFF1=this.z80.IFF1,e.IFF2=this.z80.IFF2,e.IM=this.z80.IM,e.HALT=this.z80.HALT,[e,t]}setPC(e){this.z80.reg.PC=e}readMemory(e,t){return t?Array(t-e).fill(null).map(()=>this.memory.peek(e++)):this.memory.peek(e)}setKeyState(e,t,c){this.keymatrix.setKeyMatrixState(e,t,c)}clearBreakPoints(){this.z80.clearBreakPoints()}getBreakPoints(){return this.z80.getBreakPoints()}removeBreak(e,t){this.z80.removeBreak(e,t)}addBreak(e,t){this.z80.setBreak(e,t)}start(){return"tid"in this&&null!=this.tid?(console.warn("MZ700.start(): already started"),!1):(this.startEmulation(),this.opt.started(),!0)}stop(){const e=null!=this.tid;this.stopEmulation(),e&&this.opt.stopped()}step(){"tid"in this&&null!=this.tid?this.stop():(this.exec(1),this.opt.started(),this.opt.stopped())}run(){try{if(this._cycleToWait>0)this._cycleToWait--;else{const e=this.z80.consumedTCycle;this.z80.exec(),this._cycleToWait=this.z80.consumedTCycle-e}this.clock()}catch(e){console.log("Error:",e),console.log(e.stack),this.stop(),this.opt.onBreak()}}dataRecorder_setCmt(e){if(0===e.length)return this.dataRecorder.setCmt([]),[];const t=i.default.fromBytes(e);return this.dataRecorder.setCmt(t),t}dataRecorder_ejectCmt(){if(this.dataRecorder.isCmtSet()){const e=this.dataRecorder.ejectCmt();if(null!=e)return i.default.toBytes(e)}return[]}dataRecorder_pushPlay(){this.dataRecorder.play()}dataRecorder_pushRec(){this.dataRecorder.isCmtSet()&&this.dataRecorder.ejectCmt(),this.dataRecorder.setCmt([]),this.dataRecorder.rec()}dataRecorder_pushStop(){this.dataRecorder.stop()}dataRecorder_motorOn(e){this.dataRecorder.m_on(e)}dataRecorder_readBit(){return this.dataRecorder.rdata(this.z80.consumedTCycle)}dataRecorder_writeBit(e){this.dataRecorder.wdata(e,this.z80.consumedTCycle)}getClockFactor(){return this.clockFactor}setClockFactor(e){const t=null!=this.tid;t&&this.stopEmulation(),this.clockFactor=e,t&&this.startEmulation()}getActualClockFreq(){return this.actualClockFreq}startEmulation(){const e=Math.round(200*this.clockFactor);this.tid=s.default.setInterval(this.run.bind(this),A.DEFAULT_TIMER_INTERVAL,80,e);this.tidMeasClock=setInterval(()=>{this.actualClockFreq=(this.z80.consumedTCycle-this.tCycle0)/1,this.tCycle0=this.z80.consumedTCycle},1e3)}stopEmulation(){null!=this.tid&&(s.default.clearInterval(this.tid),this.tid=null),null!=this.tidMeasClock&&(clearInterval(this.tidMeasClock),this.tidMeasClock=null,this.actualClockFreq=0)}static disassemble(e){const t=[];e.forEach(e=>{console.assert(e.header.constructor===o.default,"No MZT-header");const c=e.header.getHeadline().split("\n");Array.prototype.push.apply(t,c.map(e=>{const t=new h.default;return t.setComment(e),t})),Array.prototype.push.apply(t,f.default.dasm(e.body.buffer,0,e.header.fileSize,e.header.addrLoad))});const c=f.default.dasmlines(t);return{outbuf:c.join("\n")+"\n",dasmlines:c,asmlist:t}}attachPCG700(e){this.mmio.onWrite(57360,t=>e.setPattern(255&t)),this.mmio.onWrite(57361,t=>e.setAddrLo(255&t)),this.mmio.onWrite(57362,t=>{e.setAddrHi(t&y.default.ADDR),e.setCopy(t&y.default.COPY),e.setWE(t&y.default.WE),e.setSSW(t&y.default.SSW)}),this.memory.poke(57360,0),this.memory.poke(57361,0),this.memory.poke(57362,24)}}c.default=A,A.Z80_CLOCK=3579545,A.DEFAULT_TIMER_INTERVAL=1/A.Z80_CLOCK,t.exports=A},{"../Z80/Z80-line-assembler":6,"../Z80/Z80.js":7,"../lib/PCG-700":15,"../lib/flip-flop-counter":17,"../lib/ic556":18,"../lib/intel-8253":19,"../lib/mz-data-recorder":20,"../lib/mz-mmio.js":21,"../lib/mz-tape":23,"../lib/mz-tape-header":22,"./mz700-key-matrix":1,"./mz700-memory.js":2,"fractional-timer":36}],6:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("../lib/number-util")),o=n(e("../lib/oct")),i=n(e("../lib/mz700-charcode")),r=n(e("../lib/parse-addr"));class a{constructor(){this.address=null,this.bytecode=[],this.label=null,this.mnemonic=null,this.operand=null,this.comment="",this.refAddrTo=null,this.refCount=0}setAddress(e){this.address=e}setRefAddrTo(e){this.refAddrTo=e}setLabel(e){this.label=e}setComment(e){this.address=this.address||0,this.comment=e}getNextAddress(){return this.address+this.bytecode.length}getLastAddress(){return this.address+this.bytecode.length-1}static joinOperand(e){const t=[];let c=!0;return e.forEach(e=>{","===e?(t.push(e),c=!0):(c||t.push(" "),t.push(e),c=!1)}),t.join("")}static getBytecodesFromOperandOfDEFB(e,t){const c=[];return e.forEach(e=>{if(","!==e)if(e.match(/^[0-9]/)||e.match(/^[1-9A-F][0-9A-F]*H$/i))c.push(r.default.parseNumLiteral(e));else{let n=null;switch(e.charAt(0)){case"'":case'"':n=a.convertToAsciiCode(e.substring(1,e.length-1),!0);break;case"`":n=a.convertToAsciiCode(e.substring(1,e.length-1),!1);break;default:if(!(e in t))throw new Error(["Fatal: Unrecognized operand for DEFB.",e].join(" "));{const c=t[e];if(c>=256)throw new Error(["The character code exceeds the maximum","value of 8 bit with the label",e,"(","0x"+s.default.HEX(c,4),")"].join(" "));n=[c]}}Array.prototype.push.apply(c,n)}}),c}static convertToAsciiCode(e,t){const c=[];for(let n=0;n<e.length;){let s=e.charAt(n++);if("\\"===s)switch(s=e.charAt(n++)){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":{const t=s+e.substr(n,2);if(t.length<3)throw new Error(["Unexpected termination at a octal","character code sequence","at column",n-1,"in",e].join(" "));if(!t.match(/^[0-7]+$/))throw new Error(["No octal character exists at column",n-1,"in",e].join(" "));{const s=o.default(t);if(s>=256)throw new Error(["The character code exceeds the maximum","value of 8 bit at",n,"in",e].join(" "));n+=2,c.push(s)}}break;case"x":{const t=e.substr(n).replace(/^([0-9a-fA-F]*).*$/,"$1");if(0===t.length)throw new Error(["Unexpected termination at a hex","character code sequence","at column",n-1,"in",e].join(" "));const s=parseInt(t,16);if(s>=256)throw new Error(["The character code exeed 8 bit","length at",n,"in",e].join(" "));n+=t.length,c.push(s)}break;default:if(t)switch(s){case"r":c.push("\r".charCodeAt(0));break;default:c.push(s.charCodeAt(0))}else c.push(i.default.ascii2dispcode[s.charCodeAt(0)])}else t?c.push(s.charCodeAt(0)):c.push(i.default.ascii2dispcode[s.charCodeAt(0)])}return c}static parseIndexDisplacer(e,t){const c=t+(e[t].match(/^[+-]$/)?1:0),n=r.default.parseNumLiteral(e[c]);return c===t+1&&"-"===e[t]?s.default.to8bitUnsigned(-n):n}static create(e,t,c){const n=new a;return n.mnemonic=e,n.operand=t||"",n.bytecode=c||[],n}static assemble(e,t,c){const n=new a;n.address=t;const s=a.tokenize(e);let o=-1,i=-1;for(let e=0;e<s.length;e++)switch(s[e]){case":":o<0&&i<0&&(o=e);break;case";":i<0&&(i=e)}if(o>=0&&(n.label=s.slice(0,o).join(""),s.splice(0,o+1),i-=o+1),i>=0&&(n.comment=s.slice(i).join(""),s.splice(i)),s.length>0&&(n.mnemonic=s[0],n.operand=a.joinOperand(s.slice(1))),s.length>0)try{n.bytecode=n.assembleMnemonic(s,c)}catch(e){n.comment+="*** ASSEMBLE ERROR - "+e,console.error(`!!! Error !!! ${e.message}`),console.error(`tokens: ${s.join(" ")}`),console.error(e.stack)}return n}static tokenize(e){let t=0;const c=e.length;let n=0;const s=[];let o="";for(;n<c;){let i=e.charAt(n);switch(t){case 0:if(/\s/.test(i))n++;else if("-"===i||"+"===i)o+=i,n++,t=2;else if(/[0-9]/.test(i))t=2;else if(/[A-Z_?.*#!$]/i.test(i))o+=i,n++,t=3;else if("'"===i||'"'===i||"`"===i)o+=i,n++,t=4;else if("("===i||")"===i||","===i||"+"===i||":"===i)s.push(i),n++;else{if(";"!==i)throw"unrecognized char "+i+" at column "+n;{s.push(i),n++;const t=e.substr(n);s.push(t),n+=t.length,o=""}}break;case 2:/[0-9A-F]/i.test(i)?(o+=i,n++):/H/i.test(i)?(o+=i,n++,s.push(o.toUpperCase()),o="",t=0):(s.push(o.toUpperCase()),o="",t=0);break;case 3:/[A-Z_0-9?.*#!$']/i.test(i)?(o+=i,n++):(s.push(o.toUpperCase()),o="",t=0);break;case 4:"\\"===i?++n<c&&(o+="\\"+(i=e.charAt(n)),n++):i!==o.charAt(0)?(o+=i,n++):(o+=i,n++,s.push(o),o="",t=0);break;default:throw"unrecognized status "}}return""!==o&&s.push(o.toUpperCase()),s}resolveAddress(e){for(let t=0;t<this.bytecode.length;t++)if("function"==typeof this.bytecode[t]){const c=this.bytecode[t];this.bytecode[t]=c(e)}}assembleMnemonic(e,t){const c=this.label;if(f(e,["ORG",null]))return this.address=r.default._parseNumLiteral(e[1]),[];if(f(e,["ENT"]))return t[c]=this.address,[];if(f(e,["EQU",null])){if(null===c||""===c)throw"empty label for EQU";return t[c]=r.default._parseNumLiteral(e[1]),[]}if(f(e,["DEFB",null],!0))return a.getBytecodesFromOperandOfDEFB(e.slice(1),t);if(f(e,["DEFW",null]))return r.default.parseNumLiteralPair(e[1]);if(f(e,["DEFS",null])){const t=r.default._parseNumLiteral(e[1]);if(t<0)throw"negative DEFS number "+e[1];return Array(t).fill(0)}if(f(e,["LD","A",",","I"]))return[o.default("0355"),o.default("0127")];if(f(e,["LD","A",",","R"]))return[o.default("0355"),o.default("0137")];if(f(e,["LD","I",",","A"]))return[o.default("0355"),o.default("0107")];if(f(e,["LD","R",",","A"]))return[o.default("0355"),o.default("0117")];if(f(e,["LD","B",",","IXH"]))return[221,68];if(f(e,["LD","C",",","IXL"]))return[221,77];if(f(e,["LD","A",",","IXL"]))return[221,125];if(f(e,["ADD","A",",","IXH"]))return[221,132];if(f(e,["ADD","A",",","IXL"]))return[221,133];if(f(e,["LD",/^[BCDEHLA]$/,",",/^[BCDEHLA]$/])){const t=p(e[1]),c=p(e[3]);return[o.default("0100")|t<<3|c<<0]}if(f(e,["LD",/^[BCDEHLA]$/,",",null]))return(()=>{const t=p(e[1]),c=r.default.parseNumLiteral(e[3]);return[o.default("0006")|t<<3,c]})();if(f(e,["LD",/^[BCDEHLA]$/,",","(","HL",")"]))return(()=>{const t=p(e[1]);return[o.default("0106")|t<<3]})();if(f(e,["LD","(","HL",")",",",/^[BCDEHLA]$/]))return(()=>{const t=p(e[5]);return[o.default("0160")|t]})();if(f(e,["LD","(","HL",")",",",null]))return(()=>{const t=r.default.parseNumLiteral(e[5]);return[o.default("0066"),t]})();if(f(e,["LD","A",",","(",/^(BC|DE)$/,")"]))return(()=>{const t=u(e[4]);return[o.default("0012")|t<<4]})();if(f(e,["LD","A",",","(",null,")"]))return(()=>{const t=r.default.parseNumLiteralPair(e[4]);return[o.default("0072"),t[0],t[1]]})();if(f(e,["LD","(",/^(BC|DE)$/,")",",","A"]))return(()=>{const t=u(e[2]);return[o.default("0002")|t<<4]})();if(f(e,["LD","(",null,")",",","A"]))return(()=>{const t=r.default.parseNumLiteralPair(e[2]);return[o.default("0062"),t[0],t[1]]})();if(f(e,["LD","SP",",","HL"]))return[o.default("0371")];if(f(e,["LD","SP",",","IX"]))return[221,249];if(f(e,["LD","SP",",","IY"]))return[253,249];if(f(e,["LD",/^(BC|DE|HL|SP)$/,",",null]))return(()=>{const t=u(e[1]),c=r.default.parseNumLiteralPair(e[3]);return[o.default("0001")|t<<4,c[0],c[1]]})();if(f(e,["LD","HL",",","(",null,")"]))return(()=>{const t=r.default.parseNumLiteralPair(e[4]);return[o.default("0052"),t[0],t[1]]})();if(f(e,["LD","BC",",","(",null,")"]))return(()=>{const t=r.default.parseNumLiteralPair(e[4]);return[o.default("0355"),o.default("0113"),t[0],t[1]]})();if(f(e,["LD","DE",",","(",null,")"]))return(()=>{const t=r.default.parseNumLiteralPair(e[4]);return[o.default("0355"),o.default("0133"),t[0],t[1]]})();if(f(e,["LD","SP",",","(",null,")"]))return(()=>{const t=r.default.parseNumLiteralPair(e[4]);return[o.default("0355"),o.default("0173"),t[0],t[1]]})();if(f(e,["LD","(",null,")",",","HL"]))return(()=>{const t=r.default.parseNumLiteralPair(e[2]);return[o.default("0042"),t[0],t[1]]})();if(f(e,["LD","(",null,")",",","BC"]))return(()=>{const t=r.default.parseNumLiteralPair(e[2]);return[o.default("0355"),o.default("0103"),t[0],t[1]]})();if(f(e,["LD","(",null,")",",","DE"]))return(()=>{const t=r.default.parseNumLiteralPair(e[2]);return[o.default("0355"),o.default("0123"),t[0],t[1]]})();if(f(e,["LD","(",null,")",",","SP"]))return(()=>{const t=r.default.parseNumLiteralPair(e[2]);return[o.default("0355"),o.default("0163"),t[0],t[1]]})();if(f(e,["PUSH",/^(BC|DE|HL|AF)$/]))return(()=>{const t=m(e[1]);return[o.default("0305")|t<<4]})();if(f(e,["POP",/^(BC|DE|HL|AF)$/]))return(()=>{const t=m(e[1]);return[o.default("0301")|t<<4]})();if(f(e,["LD","IXH",",","B"]))return[221,96];if(f(e,["LD","IXL",",","C"]))return[221,105];if(f(e,["LD","IXH",",","A"]))return[221,103];if(f(e,["LD","IXL",",","A"]))return[221,111];if(f(e,["CP","IXL"]))return[221,189];if(f(e,["EX","DE",",","HL"]))return[235];if(f(e,["EX","AF",",","AF'"]))return[8];if(f(e,["EXX"]))return[217];if(f(e,["EX","(","SP",")",",","HL"]))return[227];if(f(e,["LDI"]))return[o.default("0355"),o.default("0240")];if(f(e,["LDIR"]))return[o.default("0355"),o.default("0260")];if(f(e,["LDD"]))return[o.default("0355"),o.default("0250")];if(f(e,["LDDR"]))return[o.default("0355"),o.default("0270")];if(f(e,["CPI"]))return[o.default("0355"),o.default("0241")];if(f(e,["CPIR"]))return[o.default("0355"),o.default("0261")];if(f(e,["CPD"]))return[o.default("0355"),o.default("0251")];if(f(e,["CPDR"]))return[o.default("0355"),o.default("0271")];if(f(e,["DAA"]))return[o.default("0047")];if(f(e,["CPL"]))return[o.default("0057")];if(f(e,["NEG"]))return[o.default("0355"),o.default("0104")];if(f(e,["CCF"]))return[o.default("0077")];if(f(e,["SCF"]))return[o.default("0067")];if(f(e,["NOP"]))return[o.default("0000")];if(f(e,["HALT"]))return[o.default("0166")];if(f(e,["DI"]))return[o.default("0363")];if(f(e,["EI"]))return[o.default("0373")];if(f(e,["IM0"]))return[o.default("0355"),o.default("0106")];if(f(e,["IM1"]))return[o.default("0355"),o.default("0126")];if(f(e,["IM2"]))return[o.default("0355"),o.default("0136")];if(f(e,["IM","0"]))return[o.default("0355"),o.default("0106")];if(f(e,["IM","1"]))return[o.default("0355"),o.default("0126")];if(f(e,["IM","2"]))return[o.default("0355"),o.default("0136")];if(f(e,[/^(ADD|ADC|SBC)$/,"HL",",",/^(BC|DE|HL|SP)$/])){let t=0;switch(e[3]){case"BC":t=0;break;case"DE":t=1;break;case"HL":t=2;break;case"SP":t=3}switch(e[0]){case"ADD":return[o.default("0011")|t<<4];case"ADC":return[o.default("0355"),o.default("0112")|t<<4];case"SBC":return[o.default("0355"),o.default("0102")|t<<4]}return[]}if(f(e,["ADD","IX",",",/^(BC|DE|IX|SP)$/])){switch(e[3]){case"BC":return[o.default("0335"),o.default("0011")];case"DE":return[o.default("0335"),o.default("0031")];case"IX":return[o.default("0335"),o.default("0051")];case"SP":return[o.default("0335"),o.default("0071")]}return[]}if(f(e,["ADD","IY",",",/^(BC|DE|IY|SP)$/])){switch(e[3]){case"BC":return[o.default("0375"),o.default("0011")];case"DE":return[o.default("0375"),o.default("0031")];case"IY":return[o.default("0375"),o.default("0051")];case"SP":return[o.default("0375"),o.default("0071")]}return[]}if(f(e,[/^(INC|DEC)$/,/^(BC|DE|HL|SP|IX|IY)$/])){switch(e[0]){case"INC":switch(e[1]){case"BC":return[o.default("0003")];case"DE":return[o.default("0023")];case"HL":return[o.default("0043")];case"SP":return[o.default("0063")];case"IX":return[o.default("0335"),o.default("0043")];case"IY":return[o.default("0375"),o.default("0043")]}break;case"DEC":switch(e[1]){case"BC":return[o.default("0013")];case"DE":return[o.default("0033")];case"HL":return[o.default("0053")];case"SP":return[o.default("0073")];case"IX":return[o.default("0335"),o.default("0053")];case"IY":return[o.default("0375"),o.default("0053")]}}return[]}if(f(e,["RLCA"]))return[o.default("0007")];if(f(e,["RLA"]))return[o.default("0027")];if(f(e,["RRCA"]))return[o.default("0017")];if(f(e,["RRA"]))return[o.default("0037")];if(f(e,[/^(RLC|RL|RRC|RR|SLA|SRA|SRL)$/,/^[BCDEHLA]$/])){switch(e[0]){case"RLC":return[o.default("0313"),o.default("0000")|p(e[1])];case"RL":return[o.default("0313"),o.default("0020")|p(e[1])];case"RRC":return[o.default("0313"),o.default("0010")|p(e[1])];case"RR":return[o.default("0313"),o.default("0030")|p(e[1])];case"SLA":return[o.default("0313"),o.default("0040")|p(e[1])];case"SRA":return[o.default("0313"),o.default("0050")|p(e[1])];case"SRL":return[o.default("0313"),o.default("0070")|p(e[1])]}return[]}if(f(e,[/^(RLC|RL|RRC|RR|SLA|SRA|SRL)$/,"(","HL",")"])){switch(e[0]){case"RLC":return[o.default("0313"),o.default("0006")];case"RL":return[o.default("0313"),o.default("0026")];case"RRC":return[o.default("0313"),o.default("0016")];case"RR":return[o.default("0313"),o.default("0036")];case"SLA":return[o.default("0313"),o.default("0046")];case"SRA":return[o.default("0313"),o.default("0056")];case"SRL":return[o.default("0313"),o.default("0076")]}return[]}if(f(e,[/^(RLC|RL|RRC|RR|SLA|SRA|SRL)$/,"(",/^(IX|IY)$/,/^[+-]$/,null,")"])||f(e,[/^(RLC|RL|RRC|RR|SLA|SRA|SRL)$/,"(",/^(IX|IY)$/,/^[+-].*/,")"])){const t=l(e[2]),c=a.parseIndexDisplacer(e,3);switch(e[0]){case"RLC":return[t,o.default("0313"),c,o.default("0006")];case"RL":return[t,o.default("0313"),c,o.default("0026")];case"RRC":return[t,o.default("0313"),c,o.default("0016")];case"RR":return[t,o.default("0313"),c,o.default("0036")];case"SLA":return[t,o.default("0313"),c,o.default("0046")];case"SRA":return[t,o.default("0313"),c,o.default("0056")];case"SRL":return[t,o.default("0313"),c,o.default("0076")]}return[]}if(f(e,["RLD"]))return[o.default("0355"),o.default("0157")];if(f(e,["RRD"]))return[o.default("0355"),o.default("0147")];if(f(e,[/^(BIT|SET|RES)$/,/^[0-7]$/,",",/^[BCDEHLA]$/])){switch(e[0]){case"BIT":return[o.default("0313"),o.default("0100")|parseInt(e[1],10)<<3|p(e[3])];case"SET":return[o.default("0313"),o.default("0300")|parseInt(e[1],10)<<3|p(e[3])];case"RES":return[o.default("0313"),o.default("0200")|parseInt(e[1],10)<<3|p(e[3])]}return[]}if(f(e,[/^(BIT|SET|RES)$/,/^[0-7]$/,",","(","HL",")"])){switch(e[0]){case"BIT":return[o.default("0313"),o.default("0106")|parseInt(e[1],10)<<3];case"SET":return[o.default("0313"),o.default("0306")|parseInt(e[1],10)<<3];case"RES":return[o.default("0313"),o.default("0206")|parseInt(e[1],10)<<3]}return[]}if(f(e,[/^(BIT|SET|RES)$/,/^[0-7]$/,",","(",/^(IX|IY)$/,/^[+-]$/,null,")"])||f(e,[/^(BIT|SET|RES)$/,/^[0-7]$/,",","(",/^(IX|IY)$/,/^[+-].*$/,")"])){const t=l(e[4]),c=a.parseIndexDisplacer(e,5);switch(e[0]){case"BIT":return[t,o.default("0313"),c,o.default("0106")|parseInt(e[1],10)<<3];case"SET":return[t,o.default("0313"),c,o.default("0306")|parseInt(e[1],10)<<3];case"RES":return[t,o.default("0313"),c,o.default("0206")|parseInt(e[1],10)<<3]}return[]}if(f(e,["JP",null]))return(()=>{const t=r.default.parseNumLiteralPair(e[1]);return[o.default("0303"),t[0],t[1]]})();if(f(e,["JP",/^(NZ|Z|NC|C|PO|PE|P|M)$/,",",null]))return(()=>{const t=r.default.parseNumLiteralPair(e[3]);switch(e[1]){case"NZ":return[o.default("0302"),t[0],t[1]];case"Z":return[o.default("0312"),t[0],t[1]];case"NC":return[o.default("0322"),t[0],t[1]];case"C":return[o.default("0332"),t[0],t[1]];case"PO":return[o.default("0342"),t[0],t[1]];case"PE":return[o.default("0352"),t[0],t[1]];case"P":return[o.default("0362"),t[0],t[1]];case"M":return[o.default("0372"),t[0],t[1]]}return[]})();if(f(e,["JR",null]))return(()=>{const t=r.default.parseRelAddr(e[1],this.address+2);return[o.default("0030"),t]})();if(f(e,["JR",/^(NZ|Z|NC|C)$/,",",null]))return(()=>{const t=r.default.parseRelAddr(e[3],this.address+2);switch(e[1]){case"NZ":return[o.default("0040"),t];case"Z":return[o.default("0050"),t];case"NC":return[o.default("0060"),t];case"C":return[o.default("0070"),t]}return[]})();if(f(e,["JP","(",/^(HL|IX|IY)$/,")"])){switch(e[2]){case"HL":return[o.default("0351")];case"IX":return[o.default("0335"),o.default("0351")];case"IY":return[o.default("0375"),o.default("0351")]}return[]}if(f(e,["DJNZ",null]))return(()=>{const t=r.default.parseRelAddr(e[1],this.address+2);return[o.default("0020"),t]})();if(f(e,["CALL",null]))return(()=>{const t=r.default.parseNumLiteralPair(e[1]);return[o.default("0315"),t[0],t[1]]})();if(f(e,["CALL",/^(NZ|Z|NC|C|PO|PE|P|M)$/,",",null]))return(()=>{const t=r.default.parseNumLiteralPair(e[3]);switch(e[1]){case"NZ":return[o.default("0304"),t[0],t[1]];case"Z":return[o.default("0314"),t[0],t[1]];case"NC":return[o.default("0324"),t[0],t[1]];case"C":return[o.default("0334"),t[0],t[1]];case"PO":return[o.default("0344"),t[0],t[1]];case"PE":return[o.default("0354"),t[0],t[1]];case"P":return[o.default("0364"),t[0],t[1]];case"M":return[o.default("0374"),t[0],t[1]]}return[]})();if(f(e,["RET"]))return[o.default("0311")];if(f(e,["RET",/^(NZ|Z|NC|C|PO|PE|P|M)$/])){switch(e[1]){case"NZ":return[o.default("0300")];case"Z":return[o.default("0310")];case"NC":return[o.default("0320")];case"C":return[o.default("0330")];case"PO":return[o.default("0340")];case"PE":return[o.default("0350")];case"P":return[o.default("0360")];case"M":return[o.default("0370")]}return[]}if(f(e,["RETI"]))return[o.default("0355"),o.default("0115")];if(f(e,["RETN"]))return[o.default("0355"),o.default("0105")];if(f(e,["RST",/^(00H|08H|10H|18H|20H|28H|30H|38H)$/])){switch(e[1]){case"00H":return[o.default("0307")];case"08H":return[o.default("0317")];case"10H":return[o.default("0327")];case"18H":return[o.default("0337")];case"20H":return[o.default("0347")];case"28H":return[o.default("0357")];case"30H":return[o.default("0367")];case"38H":return[o.default("0377")]}return[]}if(f(e,["IN",/^[BCDEHLA]$/,",","(","C",")"]))return(()=>{const t=p(e[1]);return[o.default("0355"),o.default("0100")|t<<3]})();if(f(e,["IN","A",",","(",null,")"]))return(()=>{const t=r.default.parseNumLiteral(e[4]);return[o.default("0333"),t]})();if(f(e,["OUT","(","C",")",",",/^[BCDEHLA]$/]))return(()=>{const t=p(e[5]);return[o.default("0355"),o.default("0101")|t<<3]})();if(f(e,["OUT","(",null,")",",","A"]))return(()=>{const t=r.default.parseNumLiteral(e[2]);return[o.default("0323"),t]})();if(f(e,["INI"]))return[o.default("0355"),o.default("0242")];if(f(e,["INIR"]))return[o.default("0355"),o.default("0262")];if(f(e,["IND"]))return[o.default("0355"),o.default("0252")];if(f(e,["INDR"]))return[o.default("0355"),o.default("0272")];if(f(e,["OUTI"]))return[o.default("0355"),o.default("0243")];if(f(e,["OTIR"]))return[o.default("0355"),o.default("0263")];if(f(e,["OUTD"]))return[o.default("0355"),o.default("0253")];if(f(e,["OTDR"]))return[o.default("0355"),o.default("0273")];if(f(e,["LD",/^[BCDEHLA]$/,",","(",/^(IX|IY)$/,/^[+-]$/,null,")"])||f(e,["LD",/^[BCDEHLA]$/,",","(",/^(IX|IY)$/,null,")"])){const t=p(e[1]),c=l(e[4]),n=a.parseIndexDisplacer(e,5);return[c,o.default("0106")|t<<3,n]}if(f(e,["LD","(",/^(IX|IY)$/,/^[+-]$/,null,")",",",/^[BCDEHLA]$/])||f(e,["LD","(",/^(IX|IY)$/,/^[+-].*$/,")",",",/^[BCDEHLA]$/])){const t=l(e[2]),c=a.parseIndexDisplacer(e,3),n="+"===e[3]||"-"===e[3]?7:6,s=p(e[n]);return[t,o.default("0160")|s,c]}if(f(e,["LD","(",/^(IX|IY)$/,/^[+-]$/,null,")",",",null])||f(e,["LD","(",/^(IX|IY)$/,/^[+-].*$/,")",",",null])){const t=l(e[2]),c=a.parseIndexDisplacer(e,3),n="+"===e[3]||"-"===e[3]?7:6;return[t,54,c,r.default.parseNumLiteral(e[n])]}if(f(e,["LD",/^(IX|IY)$/,",",null]))return(()=>{const t=r.default.parseNumLiteralPair(e[3]);return[l(e[1]),33,t[0],t[1]]})();if(f(e,["LD","(",null,")",",",/^(IX|IY)$/]))return(()=>{const t=r.default.parseNumLiteralPair(e[2]);return[l(e[5]),34,t[0],t[1]]})();if(f(e,["LD",/^(IX|IY)$/,",","(",null,")"]))return(()=>{const t=r.default.parseNumLiteralPair(e[4]);return[l(e[1]),42,t[0],t[1]]})();if(f(e,["PUSH",/^(IX|IY)$/]))return[l(e[1]),229];if(f(e,["POP",/^(IX|IY)$/]))return[l(e[1]),225];if(f(e,["EX","(","SP",")",",",/^(IX|IY)$/]))return[l(e[5]),227];if(f(e,[/^(ADD|ADC|SUB|SBC)$/,"A",",",/^[BCDEHLA]$/]))return(()=>{const t=d(e[0]),c=p(e[3]);return[o.default("0200")|t<<3|c]})();if(f(e,[/^(ADD|ADC|SUB|SBC)$/,"A",",",null]))return(()=>{const t=d(e[0]),c=r.default.parseNumLiteral(e[3]);return[o.default("0306")|t<<3,c]})();if(f(e,[/^(ADD|ADC|SUB|SBC)$/,"A",",","(","HL",")"]))return(()=>{const t=d(e[0]);return[o.default("0206")|t<<3]})();if(f(e,[/^(ADD|ADC|SUB|SBC)$/,"A",",","(",/^(IX|IY)$/,/^[+-]$/,null,")"])||f(e,[/^(ADD|ADC|SUB|SBC)$/,"A",",","(",/^(IX|IY)$/,/^[+-].*/,")"])){const t=d(e[0]),c=l(e[4]),n=a.parseIndexDisplacer(e,5);return[c,o.default("0206")|t<<3,n]}if(f(e,[/^(AND|OR|XOR|CP)$/,/^[BCDEHLA]$/]))return(()=>{const t=d(e[0]),c=p(e[1]);return[o.default("0200")|t<<3|c]})();if(f(e,[/^(AND|OR|XOR|CP)$/,null]))return(()=>{const t=d(e[0]),c=r.default.parseNumLiteral(e[1]);return[o.default("0306")|t<<3,c]})();if(f(e,[/^(AND|OR|XOR|CP)$/,"(","HL",")"]))return(()=>{const t=d(e[0]);return[o.default("0206")|t<<3]})();if(f(e,[/^(AND|OR|XOR|CP)$/,"(",/^(IX|IY)$/,/^[+-]$/,null,")"])||f(e,[/^(AND|OR|XOR|CP)$/,"(",/^(IX|IY)$/,/^[+-].*$/,")"])){const t=d(e[0]),c=l(e[2]),n=a.parseIndexDisplacer(e,3);return[c,o.default("0206")|t<<3,n]}if(f(e,[/^(INC|DEC)$/,/^[BCDEHLA]$/]))return(()=>{const t=p(e[1]);switch(e[0]){case"INC":return[o.default("0004")|t<<3];case"DEC":return[o.default("0005")|t<<3]}})();if(f(e,[/^(INC|DEC)$/,"(","HL",")"]))switch(e[0]){case"INC":return[o.default("0064")];case"DEC":return[o.default("0065")]}if(f(e,[/^(INC|DEC)$/,"(",/^(IX|IY)$/,/^[+-]$/,null,")"])||f(e,[/^(INC|DEC)$/,"(",/^(IX|IY)$/,/^[+-].*$/,")"])){const t=l(e[2]),c=a.parseIndexDisplacer(e,3);switch(e[0]){case"INC":return[t,o.default("0064"),c];case"DEC":return[t,o.default("0065"),c]}}return console.warn("**** ERROR: CANNOT ASSEMBLE:"+e.join(" / ")),[]}}function l(e){let t=0;switch(e){case"IX":t=o.default("0335");break;case"IY":t=o.default("0375")}return t}function d(e){let t=0;switch(e){case"ADD":t=0;break;case"ADC":t=1;break;case"SUB":t=2;break;case"SBC":t=3;break;case"AND":t=4;break;case"OR":t=6;break;case"XOR":t=5;break;case"CP":t=7}return t}function u(e){let t=null;switch(e){case"BC":t=0;break;case"DE":t=1;break;case"HL":t=2;break;case"SP":t=3}return t}function m(e){let t=null;switch(e){case"BC":t=0;break;case"DE":t=1;break;case"HL":t=2;break;case"AF":t=3}return t}function p(e){let t=null;switch(e){case"B":t=0;break;case"C":t=1;break;case"D":t=2;break;case"E":t=3;break;case"H":t=4;break;case"L":t=5;break;case"A":t=7}return t}function f(e,t,c){if(c=c||!1){if(e.length<t.length)return!1}else if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(null!=t[n]){if("string"==typeof t[n]){if(e[n]!==t[n])return!1}else if("object"==typeof t[n]&&t[n]instanceof RegExp){if(!t[n].test(e[n]))return!1}}else if(c&&n===t.length-1)break;return!0}c.default=a,t.exports=a},{"../lib/mz700-charcode":26,"../lib/number-util":27,"../lib/oct":28,"../lib/parse-addr":29}],7:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("../lib/oct")),o=n(e("./memory-block")),i=n(e("./register")),r=n(e("./bin-util")),a=n(e("./Z80-line-assembler")),l=n(e("../lib/number-util"));class d{constructor(e){this.IFF1=0,this.IFF2=0,this.IM=0,this.HALT=0,this.consumedTCycle=0,this.exec=d.exec,e=e||{memory:null},this.memory=e.memory,null==e.memory&&(this.memory=new o.default,this.memory.create()),this.ioPort=new Array(256).fill(0),this.reg=new i.default,this.regB=new i.default,this.bpmap=new Array(65536),this.consumedTCycle=0,this.createOpecodeTable(),this._onReadIoPort=new Array(256).fill(()=>{}),this._onWriteIoPort=new Array(256).fill(()=>{})}readIoPort(e){const t=this.ioPort[e];return this.reg.onReadIoPort(t),this._onReadIoPort[e](t),t}writeIoPort(e,t){this.ioPort[e]=t,this._onWriteIoPort[e](t)}reset(){this.IFF1=0,this.IFF2=0,this.IM=0,this.HALT=0,this.reg.clear(),this.regB.clear(),this.exec=d.exec,this.consumedTCycle=0}interrupt(){this.IFF1&&(this.pushPair(this.reg.PC),this.reg.PC=56)}clearBreakPoints(){this.bpmap=new Array(65536);for(let e=0;e<65536;e++)this.bpmap[e]=null}getBreakPoints(){return this.bpmap}removeBreak(e,t){for(let c=0;c<t;c++)this.bpmap[e+c]=null}setBreak(e,t){for(let c=0;c<t;c++)this.bpmap[e+c]=!0}fetch(){const e=this.reg.PC;return this.reg.PC=e+1&65535,this.memory.peek(e)}fetchSigned(){return l.default.to8bitSigned(this.fetch())}fetchPair(){const e=this.reg.PC;return this.reg.PC=e+2&65535,this.memory.peekPair(e)}pushPair(e){this.memory.poke(--this.reg.SP,r.default.hibyte(e)),this.memory.poke(--this.reg.SP,r.default.lobyte(e))}popPair(){const e=this.memory.peek(this.reg.SP++),t=this.memory.peek(this.reg.SP++);return r.default.pair(t,e)}incrementAt(e){this.memory.poke(e,this.reg.getINCValue(this.memory.peek(e)))}decrementAt(e){this.memory.poke(e,this.reg.getDECValue(this.memory.peek(e)))}disassemble(e,t){let c=null,n="";const s=this.memory.peek(e);try{const o=this.opecodeTable[s];if(null==o)n="UNKNOWN OPECODE";else if(null==o.disasm)n="NO DISASSEMBLER";else{const s=o.disasm(this.memory,e);null==s?n="NULL RETURNED":e+s.code.length>t?c=null:(c=a.default.create(s.mnemonic[0],s.mnemonic.slice(1).join(","),s.code),"refAddrTo"in s&&c.setRefAddrTo(s.refAddrTo))}}catch(e){n="EXCEPTION THROWN"}return null==c&&(c=a.default.create("DEFB",l.default.HEX(s,2)+"H",[s])).setComment(";*** DISASSEMBLE FAIL: "+n),c}createOpecodeTable(){this.opecodeTable=new Array(256);const e=new Array(256),t=new Array(256),c=new Array(256),n=new Array(256),o=new Array(256),a=new Array(256),u=d.prototype.fetch.bind(this),m=d.prototype.fetchSigned.bind(this),p=d.prototype.fetchPair.bind(this),f=this.memory.peek.bind(this.memory),h=this.memory.peekPair.bind(this.memory),y=this.memory.poke.bind(this.memory),A=d.prototype.pushPair.bind(this),k=d.prototype.popPair.bind(this);for(let s=0;s<256;s++)this.opecodeTable[s]={mnemonic:null,proc:()=>{throw"ILLEGAL OPCODE"},disasm:(e=>()=>({code:[e],mnemonic:["DEFB",l.default.HEX(e,2)+"H; *** UNKNOWN OPCODE"]}))(s)},e[s]={mnemonic:null,proc:(e=>()=>{throw"ILLEGAL OPCODE DD "+l.default.HEX(e,2)+" for IX command subset"})(s),disasm:(e=>()=>({code:[221],mnemonic:["DEFB","DDh; *** UNKNOWN OPCODE "+l.default.HEX(e,2)+"H"]}))(s)},t[s]={mnemonic:null,proc:(e=>()=>{throw"ILLEGAL OPCODE FD "+l.default.HEX(e,2)+" for IY command subset"})(s),disasm:(e=>()=>({code:[253],mnemonic:["DEFB","FDh; *** UNKNOWN OPCODE "+l.default.HEX(e,2)+"H"]}))(s)},c[s]={mnemonic:null,proc:(e=>()=>{throw"ILLEGAL OPCODE CB "+l.default.HEX(e,2)+" for Rotate command subset"})(s),disasm:(e=>()=>({code:[203],mnemonic:["DEFB","CBh; *** UNKNOWN OPCODE "+l.default.HEX(e,2)+"H"]}))(s)},n[s]={mnemonic:null,proc:(e=>()=>{throw"ILLEGAL OPCODE DD CB "+l.default.HEX(e,2)+" for Rotate IX command subset"})(s),disasm:(e=>()=>({code:[221,203],mnemonic:["DEFW","CBDDh; *** UNKNOWN OPCODE "+l.default.HEX(e,2)+"H"]}))(s)},o[s]={mnemonic:null,proc:(e=>()=>{throw"ILLEGAL OPCODE FD CB "+l.default.HEX(e,2)+" for Rotate IY command subset"})(s),disasm:(e=>()=>({code:[253,203],mnemonic:["DEFW","CBFDh; *** UNKNOWN OPCODE "+l.default.HEX(e,2)+"H"]}))(s)},a[s]={mnemonic:null,proc:(e=>()=>{throw"ILLEGAL OPCODE ED "+l.default.HEX(e,2)+" for Misc command subset"})(s),disasm:(e=>()=>({code:[237],mnemonic:["DEFB","EDh; *** UNKNOWN OPCODE "+l.default.HEX(e,2)+"H"]}))(s)};this.opecodeTable[221]={mnemonic:()=>e,proc:()=>{e[u()].proc()},disasm:(t,c)=>e[t.peek(c+1)].disasm(t,c)},this.opecodeTable[253]={mnemonic:()=>t,proc:()=>{t[u()].proc()},disasm:(e,c)=>t[e.peek(c+1)].disasm(e,c)},this.opecodeTable[203]={mnemonic:()=>c,proc:()=>{c[u()].proc()},disasm:(e,t)=>c[e.peek(t+1)].disasm(e,t)},this.opecodeTable[237]={mnemonic:()=>a,proc:()=>{a[u()].proc()},disasm:(e,t)=>a[e.peek(t+1)].disasm(e,t)};const C=this.reg,L=this.reg.getB.bind(this.reg),D=this.reg.getC.bind(this.reg),I=this.reg.getD.bind(this.reg),b=this.reg.getE.bind(this.reg),g=this.reg.getH.bind(this.reg),R=this.reg.getL.bind(this.reg),E=this.reg.getA.bind(this.reg),_=this.reg.setB.bind(this.reg),S=this.reg.setC.bind(this.reg),P=this.reg.setD.bind(this.reg),T=this.reg.setE.bind(this.reg),H=this.reg.setH.bind(this.reg),w=this.reg.setL.bind(this.reg),B=this.reg.setA.bind(this.reg),F=this.reg.getHL.bind(this.reg),X=this.reg.getBC.bind(this.reg),O=this.reg.getDE.bind(this.reg),N={"LD B,B":()=>{_(L())},"LD B,C":()=>{_(D())},"LD B,D":()=>{_(I())},"LD B,E":()=>{_(b())},"LD B,H":()=>{_(g())},"LD B,L":()=>{_(R())},"LD B,A":()=>{_(E())},"LD C,B":()=>{S(L())},"LD C,C":()=>{S(D())},"LD C,D":()=>{S(I())},"LD C,E":()=>{S(b())},"LD C,H":()=>{S(g())},"LD C,L":()=>{S(R())},"LD C,A":()=>{S(E())},"LD D,B":()=>{P(L())},"LD D,C":()=>{P(D())},"LD D,D":()=>{P(I())},"LD D,E":()=>{P(b())},"LD D,H":()=>{P(g())},"LD D,L":()=>{P(R())},"LD D,A":()=>{P(E())},"LD E,B":()=>{T(L())},"LD E,C":()=>{T(D())},"LD E,D":()=>{T(I())},"LD E,E":()=>{T(b())},"LD E,H":()=>{T(g())},"LD E,L":()=>{T(R())},"LD E,A":()=>{T(E())},"LD H,B":()=>{H(L())},"LD H,C":()=>{H(D())},"LD H,D":()=>{H(I())},"LD H,E":()=>{H(b())},"LD H,H":()=>{H(g())},"LD H,L":()=>{H(R())},"LD H,A":()=>{H(E())},"LD L,B":()=>{w(L())},"LD L,C":()=>{w(D())},"LD L,D":()=>{w(I())},"LD L,E":()=>{w(b())},"LD L,H":()=>{w(g())},"LD L,L":()=>{w(R())},"LD L,A":()=>{w(E())},"LD A,B":()=>{B(L())},"LD A,C":()=>{B(D())},"LD A,D":()=>{B(I())},"LD A,E":()=>{B(b())},"LD A,H":()=>{B(g())},"LD A,L":()=>{B(R())},"LD A,A":()=>{B(E())}};for(const e of Object.keys(i.default.REG_R_ID2NAME)){const t=parseInt(e,10),c=i.default.REG_R_ID2NAME[t];for(const e of Object.keys(i.default.REG_R_ID2NAME)){const n=i.default.REG_R_ID2NAME[e],s=64|t<<3|parseInt(e,10);this.opecodeTable[s]={mnemonic:"LD "+c+","+n,proc:N[`LD ${c},${n}`],cycle:4,disasm:((e,t,c)=>()=>({code:[e],mnemonic:["LD",t,c]}))(s,c,n)}}}const v=(e,t)=>{const c=e.peek(t),n=[c],s=0!=(64&c)?1:0,o=c>>3&7,r=c>>0&7,a=["???","???"];let d;switch(a[0]=6===o?"(HL)":i.default.REG_R_ID2NAME[o],s){case 0:d=e.peek(t+1),n.push(d),a[1]=l.default.HEX(d,2)+"H";break;case 1:a[1]=6===r?"(HL)":i.default.REG_R_ID2NAME[r]}return{code:n,mnemonic:["LD",a[0],a[1]]}};this.opecodeTable[s.default("0006")]={mnemonic:"LD B,n",proc:()=>{_(u())},cycle:7,disasm:v},this.opecodeTable[s.default("0016")]={mnemonic:"LD C,n",proc:()=>{S(u())},cycle:7,disasm:v},this.opecodeTable[s.default("0026")]={mnemonic:"LD D,n",proc:()=>{P(u())},cycle:7,disasm:v},this.opecodeTable[s.default("0036")]={mnemonic:"LD E,n",proc:()=>{T(u())},cycle:7,disasm:v},this.opecodeTable[s.default("0046")]={mnemonic:"LD H,n",proc:()=>{H(u())},cycle:7,disasm:v},this.opecodeTable[s.default("0056")]={mnemonic:"LD L,n",proc:()=>{w(u())},cycle:7,disasm:v},this.opecodeTable[s.default("0076")]={mnemonic:"LD A,n",proc:()=>{B(u())},cycle:7,disasm:v},this.opecodeTable[s.default("0106")]={mnemonic:"LD B,(HL)",proc:()=>{_(f(F()))},cycle:7,disasm:v},this.opecodeTable[s.default("0116")]={mnemonic:"LD C,(HL)",proc:()=>{S(f(F()))},cycle:7,disasm:v},this.opecodeTable[s.default("0126")]={mnemonic:"LD D,(HL)",proc:()=>{P(f(F()))},cycle:7,disasm:v},this.opecodeTable[s.default("0136")]={mnemonic:"LD E,(HL)",proc:()=>{T(f(F()))},cycle:7,disasm:v},this.opecodeTable[s.default("0146")]={mnemonic:"LD H,(HL)",proc:()=>{H(f(F()))},cycle:7,disasm:v},this.opecodeTable[s.default("0156")]={mnemonic:"LD L,(HL)",proc:()=>{w(f(F()))},cycle:7,disasm:v},this.opecodeTable[s.default("0176")]={mnemonic:"LD A,(HL)",proc:()=>{B(f(F()))},cycle:7,disasm:v},this.opecodeTable[s.default("0160")]={mnemonic:"LD (HL),B",proc:()=>{y(F(),L())},cycle:10,disasm:v},this.opecodeTable[s.default("0161")]={mnemonic:"LD (HL),C",proc:()=>{y(F(),D())},cycle:10,disasm:v},this.opecodeTable[s.default("0162")]={mnemonic:"LD (HL),D",proc:()=>{y(F(),I())},cycle:10,disasm:v},this.opecodeTable[s.default("0163")]={mnemonic:"LD (HL),E",proc:()=>{y(F(),b())},cycle:10,disasm:v},this.opecodeTable[s.default("0164")]={mnemonic:"LD (HL),H",proc:()=>{y(F(),g())},cycle:10,disasm:v},this.opecodeTable[s.default("0165")]={mnemonic:"LD (HL),L",proc:()=>{y(F(),R())},cycle:10,disasm:v},this.opecodeTable[s.default("0167")]={mnemonic:"LD (HL),A",proc:()=>{y(F(),E())},cycle:10,disasm:v},this.opecodeTable[s.default("0066")]={mnemonic:"LD (HL),n",proc:()=>{y(F(),u())},cycle:10,disasm:v},this.opecodeTable[s.default("0012")]={mnemonic:"LD A,(BC)",proc:()=>{B(f(X()))},cycle:7,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["LD","A","(BC)"]})},this.opecodeTable[s.default("0032")]={mnemonic:"LD A,(DE)",proc:()=>{B(f(O()))},cycle:7,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["LD","A","(DE)"]})},this.opecodeTable[s.default("0072")]={mnemonic:"LD A,(nn)",proc:()=>{B(f(p()))},cycle:13,disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1),e.peek(t+2)],mnemonic:["LD","A","("+l.default.HEX(e.peekPair(t+1),4)+"H)"]})},this.opecodeTable[s.default("0002")]={mnemonic:"LD (BC),A",proc:()=>{y(X(),E())},cycle:7,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["LD","(BC)","A"]})},this.opecodeTable[s.default("0022")]={mnemonic:"LD (DE),A",proc:()=>{y(O(),E())},cycle:7,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["LD","(DE)","A"]})},this.opecodeTable[s.default("0062")]={mnemonic:"LD (nn),A",proc:()=>{y(p(),E())},cycle:13,disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1),e.peek(t+2)],mnemonic:["LD","("+l.default.HEX(e.peekPair(t+1),4)+"H)","A"]})},a[s.default("0127")]={mnemonic:"LD A,I",proc:()=>{C.LD_A_I(this.IFF2)},cycle:9,disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","A","I"]})},a[s.default("0137")]={mnemonic:"LD A,R",proc:()=>{C.LD_A_R(this.IFF2,this.regB.R)},cycle:9,disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","A","R"]})},a[s.default("0107")]={mnemonic:"LD I,A",proc:()=>{C.I=E()},cycle:9,disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","I","A"]})},a[s.default("0117")]={mnemonic:"LD R,A",proc:()=>{C.R=this.regB.R=E()},cycle:9,disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","R","A"]})};const M=(e,t,c,n)=>{const s=e.peek(t+2);return{code:[e.peek(t),e.peek(t+1),s],mnemonic:["LD",c,"("+n+"+"+l.default.HEX(s,2)+"H)"]}},Y=(e,t,c,n)=>{const s=e.peek(t+2),o=l.default.to8bitSigned(s),i=`${o>=0?"+":""}${o}`;return{code:[e.peek(t),e.peek(t+1),s],mnemonic:["LD",`(${c}${i})`,n]}};e[s.default("0106")]={mnemonic:"LD B,(IX+d)",proc:()=>{_(f(C.IX+m()))},cycle:19,disasm:(e,t)=>M(e,t,"B","IX")},e[s.default("0116")]={mnemonic:"LD C,(IX+d)",proc:()=>{S(f(C.IX+m()))},cycle:19,disasm:(e,t)=>M(e,t,"C","IX")},e[s.default("0126")]={mnemonic:"LD D,(IX+d)",proc:()=>{P(f(C.IX+m()))},cycle:19,disasm:(e,t)=>M(e,t,"D","IX")},e[s.default("0136")]={mnemonic:"LD E,(IX+d)",proc:()=>{T(f(C.IX+m()))},cycle:19,disasm:(e,t)=>M(e,t,"E","IX")},e[s.default("0146")]={mnemonic:"LD H,(IX+d)",proc:()=>{H(f(C.IX+m()))},cycle:19,disasm:(e,t)=>M(e,t,"H","IX")},e[s.default("0156")]={mnemonic:"LD L,(IX+d)",proc:()=>{w(f(C.IX+m()))},cycle:19,disasm:(e,t)=>M(e,t,"L","IX")},e[s.default("0176")]={mnemonic:"LD A,(IX+d)",proc:()=>{B(f(C.IX+m()))},cycle:19,disasm:(e,t)=>M(e,t,"A","IX")},e[s.default("0160")]={mnemonic:"LD (IX+d),B",proc:()=>{y(C.IX+m(),L())},cycle:19,disasm:(e,t)=>Y(e,t,"IX","B")},e[s.default("0161")]={mnemonic:"LD (IX+d),C",proc:()=>{y(C.IX+m(),D())},cycle:19,disasm:(e,t)=>Y(e,t,"IX","C")},e[s.default("0162")]={mnemonic:"LD (IX+d),D",proc:()=>{y(C.IX+m(),I())},cycle:19,disasm:(e,t)=>Y(e,t,"IX","D")},e[s.default("0163")]={mnemonic:"LD (IX+d),E",proc:()=>{y(C.IX+m(),b())},cycle:19,disasm:(e,t)=>Y(e,t,"IX","E")},e[s.default("0164")]={mnemonic:"LD (IX+d),H",proc:()=>{y(C.IX+m(),g())},cycle:19,disasm:(e,t)=>Y(e,t,"IX","H")},e[s.default("0165")]={mnemonic:"LD (IX+d),L",proc:()=>{y(C.IX+m(),R())},cycle:19,disasm:(e,t)=>Y(e,t,"IX","L")},e[s.default("0167")]={mnemonic:"LD (IX+d),A",proc:()=>{y(C.IX+m(),E())},cycle:19,disasm:(e,t)=>Y(e,t,"IX","A")},t[s.default("0106")]={mnemonic:"LD B,(IY+d)",proc:()=>{_(f(C.IY+m()))},cycle:19,disasm:(e,t)=>M(e,t,"B","IY")},t[s.default("0116")]={mnemonic:"LD C,(IY+d)",proc:()=>{S(f(C.IY+m()))},cycle:19,disasm:(e,t)=>M(e,t,"C","IY")},t[s.default("0126")]={mnemonic:"LD D,(IY+d)",proc:()=>{P(f(C.IY+m()))},cycle:19,disasm:(e,t)=>M(e,t,"D","IY")},t[s.default("0136")]={mnemonic:"LD E,(IY+d)",proc:()=>{T(f(C.IY+m()))},cycle:19,disasm:(e,t)=>M(e,t,"E","IY")},t[s.default("0146")]={mnemonic:"LD H,(IY+d)",proc:()=>{H(f(C.IY+m()))},cycle:19,disasm:(e,t)=>M(e,t,"H","IY")},t[s.default("0156")]={mnemonic:"LD L,(IY+d)",proc:()=>{w(f(C.IY+m()))},cycle:19,disasm:(e,t)=>M(e,t,"L","IY")},t[s.default("0176")]={mnemonic:"LD A,(IY+d)",proc:()=>{B(f(C.IY+m()))},cycle:19,disasm:(e,t)=>M(e,t,"A","IY")},t[s.default("0160")]={mnemonic:"LD (IY+d),B",proc:()=>{y(C.IY+m(),L())},cycle:19,disasm:(e,t)=>Y(e,t,"IY","B")},t[s.default("0161")]={mnemonic:"LD (IY+d),C",proc:()=>{y(C.IY+m(),D())},cycle:19,disasm:(e,t)=>Y(e,t,"IY","C")},t[s.default("0162")]={mnemonic:"LD (IY+d),D",proc:()=>{y(C.IY+m(),I())},cycle:19,disasm:(e,t)=>Y(e,t,"IY","D")},t[s.default("0163")]={mnemonic:"LD (IY+d),E",proc:()=>{y(C.IY+m(),b())},cycle:19,disasm:(e,t)=>Y(e,t,"IY","E")},t[s.default("0164")]={mnemonic:"LD (IY+d),H",proc:()=>{y(C.IY+m(),g())},cycle:19,disasm:(e,t)=>Y(e,t,"IY","H")},t[s.default("0165")]={mnemonic:"LD (IY+d),L",proc:()=>{y(C.IY+m(),R())},cycle:19,disasm:(e,t)=>Y(e,t,"IY","L")},t[s.default("0167")]={mnemonic:"LD (IY+d),A",proc:()=>{y(C.IY+m(),E())},cycle:19,disasm:(e,t)=>Y(e,t,"IY","A")};const j=(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=r.default.pair(s,n),i=c>>4&3,a=["BC","DE","HL","SP"];if(i>=a.length)throw"*** LD dd,nn; but unknown dd.";return{code:[c,n,s],mnemonic:["LD",a[i],l.default.HEX(o,4)+"H"]}};this.opecodeTable[s.default("0001")]={mnemonic:"LD BC,nn",cycle:10,proc:()=>{S(u()),_(u())},disasm:j},this.opecodeTable[s.default("0021")]={mnemonic:"LD DE,nn",cycle:10,proc:()=>{T(u()),P(u())},disasm:j},this.opecodeTable[s.default("0041")]={mnemonic:"LD HL,nn",cycle:10,proc:()=>{w(u()),H(u())},disasm:j},this.opecodeTable[s.default("0061")]={mnemonic:"LD SP,nn",cycle:10,proc:()=>{C.SP=p()},disasm:j},this.opecodeTable[s.default("0052")]={mnemonic:"LD HL,(nn)",cycle:16,proc:()=>{const e=p();w(f(e+0)),H(f(e+1))},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=r.default.pair(s,n);return{code:[c,n,s],mnemonic:["LD","HL","("+l.default.HEX(o,4)+"H)"]}}},a[s.default("0113")]={mnemonic:"LD BC,(nn)",cycle:20,proc:()=>{const e=p();S(f(e+0)),_(f(e+1))},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=e.peek(t+3),i=r.default.pair(o,s);return{code:[c,n,s,o],mnemonic:["LD","BC","("+l.default.HEX(i,4)+"H)"]}}},a[s.default("0133")]={mnemonic:"LD DE,(nn)",cycle:20,proc:()=>{const e=p();T(f(e+0)),P(f(e+1))},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=e.peek(t+3),i=r.default.pair(o,s);return{code:[c,n,s,o],mnemonic:["LD","DE","("+l.default.HEX(i,4)+"H)"]}}},a[s.default("0153")]={mnemonic:"LD HL,(nn)",cycle:20,proc:()=>{const e=p();w(f(e+0)),H(f(e+1))},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=e.peek(t+3),i=r.default.pair(o,s);return{code:[c,n,s,o],mnemonic:["LD","HL","("+l.default.HEX(i,4)+"H)"]}}},a[s.default("0173")]={mnemonic:"LD SP,(nn)",cycle:20,proc:()=>{C.SP=h(p())},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=e.peek(t+3),i=r.default.pair(o,s);return{code:[c,n,s,o],mnemonic:["LD","SP","("+l.default.HEX(i,4)+"H)"]}}},this.opecodeTable[s.default("0042")]={mnemonic:"LD (nn), HL",cycle:16,proc:()=>{const e=p();y(e+0,R()),y(e+1,g())},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=r.default.pair(s,n);return{code:[c,n,s],mnemonic:["LD","("+l.default.HEX(o,4)+"H)","HL"]}}},a[s.default("0103")]={mnemonic:"LD (nn),BC",cycle:20,proc:()=>{const e=p();y(e+0,D()),y(e+1,L())},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=e.peek(t+3),i=r.default.pair(o,s);return{code:[c,n,s,o],mnemonic:["LD","("+l.default.HEX(i,4)+"H)","BC"]}}},a[s.default("0123")]={mnemonic:"LD (nn),DE",cycle:20,proc:()=>{const e=p();y(e+0,b()),y(e+1,I())},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=e.peek(t+3),i=r.default.pair(o,s);return{code:[c,n,s,o],mnemonic:["LD","("+l.default.HEX(i,4)+"H)","DE"]}}},a[s.default("0143")]={mnemonic:"LD (nn),HL",cycle:20,proc:()=>{const e=p();y(e+0,R()),y(e+1,g())},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=e.peek(t+3),i=r.default.pair(o,s);return{code:[c,n,s,o],mnemonic:["LD","("+l.default.HEX(i,4)+"H)","HL"]}}},a[s.default("0163")]={mnemonic:"LD (nn),SP",cycle:20,proc:()=>{const e=p();y(e+0,C.SP>>0&255),y(e+1,C.SP>>8&255)},disasm:(e,t)=>{const c=e.peek(t),n=e.peek(t+1),s=e.peek(t+2),o=e.peek(t+3),i=r.default.pair(o,s);return{code:[c,n,s,o],mnemonic:["LD","("+l.default.HEX(i,4)+"H)","SP"]}}},this.opecodeTable[s.default("0371")]={mnemonic:"LD SP,HL",cycle:6,proc:()=>{C.SP=F()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["LD","SP","HL"]})},this.opecodeTable[197]={mnemonic:"PUSH BC",cycle:11,proc:()=>{y(--C.SP,L()),y(--C.SP,D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["PUSH","BC"]})},this.opecodeTable[213]={mnemonic:"PUSH DE",cycle:11,proc:()=>{y(--C.SP,I()),y(--C.SP,b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["PUSH","DE"]})},this.opecodeTable[229]={mnemonic:"PUSH HL",cycle:11,proc:()=>{y(--C.SP,g()),y(--C.SP,R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["PUSH","HL"]})},this.opecodeTable[245]={mnemonic:"PUSH AF",cycle:11,proc:()=>{y(--C.SP,E()),y(--C.SP,C.getF())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["PUSH","AF"]})},this.opecodeTable[193]={mnemonic:"POP BC",cycle:10,proc:()=>{S(f(C.SP++)),_(f(C.SP++))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["POP","BC"]})},this.opecodeTable[209]={mnemonic:"POP DE",cycle:10,proc:()=>{T(f(C.SP++)),P(f(C.SP++))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["POP","DE"]})},this.opecodeTable[225]={mnemonic:"POP HL",cycle:10,proc:()=>{w(f(C.SP++)),H(f(C.SP++))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["POP","HL"]})},this.opecodeTable[241]={mnemonic:"POP AF",cycle:10,proc:()=>{C.setF(f(C.SP++)),B(f(C.SP++))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["POP","AF"]})},e[33]={mnemonic:"LD IX,nn",cycle:14,proc:()=>{C.IX=p()},disasm:(e,t)=>({code:[221,33,e.peek(t+2),e.peek(t+3)],mnemonic:["LD","IX",l.default.HEX(e.peekPair(t+2),4)+"H"]})},e[34]={mnemonic:"LD (nn),IX",cycle:20,proc:()=>{const e=p(),t=255&C.IX,c=C.IX>>8&255;y(e,t),y(e+1,c)},disasm:(e,t)=>({code:[221,34,e.peek(t+2),e.peek(t+3)],mnemonic:["LD","("+l.default.HEX(e.peekPair(t+2),4)+"H)","IX"]})},e[42]={mnemonic:"LD IX,(nn)",cycle:20,proc:()=>{C.IX=h(p())},disasm:(e,t)=>({code:[221,42,e.peek(t+2),e.peek(t+3)],mnemonic:["LD","IX","("+l.default.HEX(e.peekPair(t+2),4)+"H)"]})},e[54]={mnemonic:"LD (IX+d),n",cycle:19,proc:()=>{const e=m(),t=u();y(C.IX+e,t)},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`,o=e.peek(t+3);return{code:[221,54,c,o],mnemonic:["LD",`(IX${s})`,l.default.HEX(o,2)+"H"]}}},e[249]={mnemonic:"LD SP,IX",cycle:10,proc:()=>{C.SP=C.IX},disasm:()=>({code:[221,249],mnemonic:["LD","SP","IX"]})},e[229]={mnemonic:"PUSH IX",cycle:15,proc:()=>{y(--C.SP,r.default.hibyte(C.IX)),y(--C.SP,r.default.lobyte(C.IX))},disasm:()=>({code:[221,229],mnemonic:["PUSH","IX"]})},e[225]={mnemonic:"POP IX",cycle:14,proc:()=>{C.IX=h(C.SP),C.SP+=2},disasm:()=>({code:[221,225],mnemonic:["POP","IX"]})},e[227]={mnemonic:"EX (SP),IX",cycle:23,proc:()=>{const e=f(C.SP+1);y(C.SP+1,r.default.hibyte(C.IX));const t=f(C.SP);y(C.SP,r.default.lobyte(C.IX)),C.IX=r.default.pair(e,t)},disasm:()=>({code:[221,227],mnemonic:["EX","(SP)","IX"]})},t[33]={mnemonic:"LD IY,nn",cycle:14,proc:()=>{C.IY=p()},disasm:(e,t)=>({code:[253,33,e.peek(t+2),e.peek(t+3)],mnemonic:["LD","IY",l.default.HEX(e.peekPair(t+2),4)+"H"]})},t[34]={mnemonic:"LD (nn),IY",cycle:20,proc:()=>{const e=p(),t=255&C.IY,c=C.IY>>8&255;y(e,t),y(e+1,c)},disasm:(e,t)=>({code:[253,34,e.peek(t+2),e.peek(t+3)],mnemonic:["LD","("+l.default.HEX(e.peekPair(t+2),4)+"H)","IY"]})},t[42]={mnemonic:"LD IY,(nn)",cycle:20,proc:()=>{C.IY=h(p())},disasm:(e,t)=>({code:[253,42,e.peek(t+2),e.peek(t+3)],mnemonic:["LD","IY","("+l.default.HEX(e.peekPair(t+2),4)+"H)"]})},t[54]={mnemonic:"LD (IY+d),n",cycle:19,proc:()=>{const e=m(),t=u();y(C.IY+e,t)},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`,o=e.peek(t+3);return{code:[253,54,c,o],mnemonic:["LD",`(IY${s})`,l.default.HEX(o,2)+"H"]}}},t[249]={mnemonic:"LD SP,IY",cycle:10,proc:()=>{C.SP=C.IY},disasm:()=>({code:[253,249],mnemonic:["LD","SP","IY"]})},t[229]={mnemonic:"PUSH IY",cycle:15,proc:()=>{y(--C.SP,r.default.hibyte(C.IY)),y(--C.SP,r.default.lobyte(C.IY))},disasm:()=>({code:[253,229],mnemonic:["PUSH","IY"]})},t[225]={mnemonic:"POP IY",cycle:14,proc:()=>{C.IY=h(C.SP),C.SP+=2},disasm:()=>({code:[253,225],mnemonic:["POP","IY"]})},t[227]={mnemonic:"EX (SP),IY",cycle:23,proc:()=>{const e=f(C.SP+1);y(C.SP+1,C.IY>>8&255);const t=f(C.SP);y(C.SP,C.IY>>0&255),C.IY=(e<<8)+t},disasm:()=>({code:[253,227],mnemonic:["EX","(SP)","IY"]})},this.opecodeTable[235]={mnemonic:"EX DE,HL ",cycle:4,proc:()=>{let e=I();P(g()),H(e),e=b(),T(R()),w(e)},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["EX","DE","HL"]})},this.opecodeTable[8]={mnemonic:"EX AF,AF'",cycle:4,proc:()=>{let e=E();B(this.regB.getA()),this.regB.setA(e),e=C.getF(),C.setF(this.regB.getF()),this.regB.setF(e)},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["EX","AF","AF'"]})},this.opecodeTable[217]={mnemonic:"EXX",cycle:4,proc:()=>{let e=L();_(this.regB.getB()),this.regB.setB(e),e=D(),S(this.regB.getC()),this.regB.setC(e),e=I(),P(this.regB.getD()),this.regB.setD(e),e=b(),T(this.regB.getE()),this.regB.setE(e),e=g(),H(this.regB.getH()),this.regB.setH(e),e=R(),w(this.regB.getL()),this.regB.setL(e)},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["EXX"]})},this.opecodeTable[227]={mnemonic:"EX (SP),HL",cycle:19,proc:()=>{let e=f(C.SP+1);y(C.SP+1,g()),H(e),e=f(C.SP),y(C.SP,R()),w(e)},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["EX","(SP)","HL"]})},a[s.default("0240")]={mnemonic:"LDI",cycle:16,proc:()=>{y(O(),f(F())),C.onLDI()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LDI"]})},a[s.default("0260")]={mnemonic:"LDIR",cycle:"BC≠0→21, BC=0→16",proc:()=>(y(O(),f(F())),C.onLDI(),0!==X()?(C.PC-=2,21):16),disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LDIR"]})},a[s.default("0250")]={mnemonic:"LDD",cycle:16,proc:()=>{y(O(),f(F())),C.onLDD()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LDD"]})},a[s.default("0270")]={mnemonic:"LDDR",cycle:"BC≠0→21, BC=0→16",proc:()=>(y(O(),f(F())),C.onLDD(),0!==X()?(C.PC-=2,21):16),disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LDDR"]})},a[s.default("0241")]={mnemonic:"CPI",cycle:16,proc:()=>{C.CPI(f(F()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["CPI"]})},a[s.default("0261")]={mnemonic:"CPIR",cycle:"{BC≠0 && A≠(HL)}→21, {BC=0 || A=(HL)}→16",proc:()=>(C.CPI(f(F())),0===X()||C.flagZ()?16:(C.PC-=2,21)),disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["CPIR"]})},a[s.default("0251")]={mnemonic:"CPD",cycle:16,proc:()=>{C.CPD(f(F()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["CPD"]})},a[s.default("0271")]={mnemonic:"CPDR",cycle:"{BC≠0 && A≠(HL)}→21, {BC=0 || A=(HL)}→16",proc:()=>(C.CPD(f(F())),0===X()||C.flagZ()?16:(C.PC-=2,21)),disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["CPDR"]})},this.opecodeTable[s.default("0200")]={mnemonic:"ADD A,B",cycle:4,proc:()=>{C.addAcc(L())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","A","B"]})},this.opecodeTable[s.default("0201")]={mnemonic:"ADD A,C",cycle:4,proc:()=>{C.addAcc(D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","A","C"]})},this.opecodeTable[s.default("0202")]={mnemonic:"ADD A,D",cycle:4,proc:()=>{C.addAcc(I())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","A","D"]})},this.opecodeTable[s.default("0203")]={mnemonic:"ADD A,E",cycle:4,proc:()=>{C.addAcc(b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","A","E"]})},this.opecodeTable[s.default("0204")]={mnemonic:"ADD A,H",cycle:4,proc:()=>{C.addAcc(g())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","A","H"]})},this.opecodeTable[s.default("0205")]={mnemonic:"ADD A,L",cycle:4,proc:()=>{C.addAcc(R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","A","L"]})},this.opecodeTable[s.default("0207")]={mnemonic:"ADD A,A",cycle:4,proc:()=>{C.addAcc(E())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","A","A"]})},this.opecodeTable[s.default("0306")]={mnemonic:"ADD A,n",cycle:7,proc:()=>{C.addAcc(u())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[e.peek(t),c],mnemonic:["ADD","A",l.default.HEX(c,2)+"H"]}}},this.opecodeTable[s.default("0206")]={mnemonic:"ADD A,(HL)",cycle:7,proc:()=>{C.addAcc(f(F()))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","A","(HL)"]})},e[s.default("0206")]={mnemonic:"ADD A,(IX+d)",cycle:19,proc:()=>{C.addAcc(f(C.IX+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["ADD","A",`(IX${s})`]}}},t[s.default("0206")]={mnemonic:"ADD A,(IY+d)",cycle:19,proc:()=>{C.addAcc(f(C.IY+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["ADD","A",`(IY${s})`]}}},this.opecodeTable[s.default("0210")]={mnemonic:"ADC A,B",cycle:4,proc:()=>{C.addAccWithCarry(L())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADC","A","B"]})},this.opecodeTable[s.default("0211")]={mnemonic:"ADC A,C",cycle:4,proc:()=>{C.addAccWithCarry(D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADC","A","C"]})},this.opecodeTable[s.default("0212")]={mnemonic:"ADC A,D",cycle:4,proc:()=>{C.addAccWithCarry(I())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADC","A","D"]})},this.opecodeTable[s.default("0213")]={mnemonic:"ADC A,E",cycle:4,proc:()=>{C.addAccWithCarry(b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADC","A","E"]})},this.opecodeTable[s.default("0214")]={mnemonic:"ADC A,H",cycle:4,proc:()=>{C.addAccWithCarry(g())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADC","A","H"]})},this.opecodeTable[s.default("0215")]={mnemonic:"ADC A,L",cycle:4,proc:()=>{C.addAccWithCarry(R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADC","A","L"]})},this.opecodeTable[s.default("0217")]={mnemonic:"ADC A,A",cycle:4,proc:()=>{C.addAccWithCarry(E())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADC","A","A"]})},this.opecodeTable[s.default("0316")]={mnemonic:"ADC A,n",cycle:7,proc:()=>{C.addAccWithCarry(u())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[e.peek(t),c],mnemonic:["ADC","A",l.default.HEX(c,2)+"H"]}}},this.opecodeTable[s.default("0216")]={mnemonic:"ADC A,(HL)",cycle:7,proc:()=>{C.addAccWithCarry(f(F()))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADC","A","(HL)"]})},e[s.default("0216")]={mnemonic:"ADC A,(IX+d)",cycle:19,proc:()=>{C.addAccWithCarry(f(C.IX+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["ADC","A",`(IX${s})`]}}},t[s.default("0216")]={mnemonic:"ADC A,(IY+d)",cycle:19,proc:()=>{C.addAccWithCarry(f(C.IY+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["ADC","A",`(IY${s})`]}}},this.opecodeTable[s.default("0220")]={mnemonic:"SUB A,B",cycle:4,proc:()=>{C.subAcc(L())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SUB","A","B"]})},this.opecodeTable[s.default("0221")]={mnemonic:"SUB A,C",cycle:4,proc:()=>{C.subAcc(D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SUB","A","C"]})},this.opecodeTable[s.default("0222")]={mnemonic:"SUB A,D",cycle:4,proc:()=>{C.subAcc(I())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SUB","A","D"]})},this.opecodeTable[s.default("0223")]={mnemonic:"SUB A,E",cycle:4,proc:()=>{C.subAcc(b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SUB","A","E"]})},this.opecodeTable[s.default("0224")]={mnemonic:"SUB A,H",cycle:4,proc:()=>{C.subAcc(g())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SUB","A","H"]})},this.opecodeTable[s.default("0225")]={mnemonic:"SUB A,L",cycle:4,proc:()=>{C.subAcc(R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SUB","A","L"]})},this.opecodeTable[s.default("0227")]={mnemonic:"SUB A,A",cycle:4,proc:()=>{C.subAcc(E())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SUB","A","A"]})},this.opecodeTable[s.default("0326")]={mnemonic:"SUB A,n",cycle:7,proc:()=>{C.subAcc(u())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[e.peek(t),c],mnemonic:["SUB","A",l.default.HEX(c,2)+"H"]}}},this.opecodeTable[s.default("0226")]={mnemonic:"SUB A,(HL)",cycle:7,proc:()=>{C.subAcc(f(F()))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SUB","A","(HL)"]})},e[s.default("0226")]={mnemonic:"SUB A,(IX+d)",cycle:19,proc:()=>{C.subAcc(f(C.IX+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["SUB","A",`(IX${s})`]}}},t[s.default("0226")]={mnemonic:"SUB A,(IY+d)",cycle:19,proc:()=>{C.subAcc(f(C.IY+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["SUB","A",`(IY${s})`]}}},this.opecodeTable[s.default("0230")]={mnemonic:"SBC A,B",cycle:4,proc:()=>{C.subAccWithCarry(L())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SBC","A","B"]})},this.opecodeTable[s.default("0231")]={mnemonic:"SBC A,C",cycle:4,proc:()=>{C.subAccWithCarry(D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SBC","A","C"]})},this.opecodeTable[s.default("0232")]={mnemonic:"SBC A,D",cycle:4,proc:()=>{C.subAccWithCarry(I())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SBC","A","D"]})},this.opecodeTable[s.default("0233")]={mnemonic:"SBC A,E",cycle:4,proc:()=>{C.subAccWithCarry(b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SBC","A","E"]})},this.opecodeTable[s.default("0234")]={mnemonic:"SBC A,H",cycle:4,proc:()=>{C.subAccWithCarry(g())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SBC","A","H"]})},this.opecodeTable[s.default("0235")]={mnemonic:"SBC A,L",cycle:4,proc:()=>{C.subAccWithCarry(R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SBC","A","L"]})},this.opecodeTable[s.default("0237")]={mnemonic:"SBC A,A",cycle:4,proc:()=>{C.subAccWithCarry(E())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SBC","A","A"]})},this.opecodeTable[s.default("0336")]={mnemonic:"SBC A,n",cycle:7,proc:()=>{C.subAccWithCarry(u())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[e.peek(t),c],mnemonic:["SBC","A,"+l.default.HEX(c,2)+"H"]}}},this.opecodeTable[s.default("0236")]={mnemonic:"SBC A,(HL)",cycle:7,proc:()=>{C.subAccWithCarry(f(F()))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SBC","A","(HL)"]})},e[s.default("0236")]={mnemonic:"SBC A,(IX+d)",cycle:19,proc:()=>{C.subAccWithCarry(f(C.IX+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["SBC","A",`(IX${s})`]}}},t[s.default("0236")]={mnemonic:"SBC A,(IY+d)",cycle:19,proc:()=>{C.subAccWithCarry(f(C.IY+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["SBC","A",`(IY${s})`]}}},this.opecodeTable[s.default("0240")]={mnemonic:"AND B",cycle:4,proc:()=>{C.andAcc(L())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["AND","B"]})},this.opecodeTable[s.default("0241")]={mnemonic:"AND C",cycle:4,proc:()=>{C.andAcc(D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["AND","C"]})},this.opecodeTable[s.default("0242")]={mnemonic:"AND D",cycle:4,proc:()=>{C.andAcc(I())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["AND","D"]})},this.opecodeTable[s.default("0243")]={mnemonic:"AND E",cycle:4,proc:()=>{C.andAcc(b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["AND","E"]})},this.opecodeTable[s.default("0244")]={mnemonic:"AND H",cycle:4,proc:()=>{C.andAcc(g())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["AND","H"]})},this.opecodeTable[s.default("0245")]={mnemonic:"AND L",cycle:4,proc:()=>{C.andAcc(R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["AND","L"]})},this.opecodeTable[s.default("0247")]={mnemonic:"AND A",cycle:4,proc:()=>{C.andAcc(E())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["AND","A"]})},this.opecodeTable[s.default("0346")]={mnemonic:"AND n",cycle:7,proc:()=>{C.andAcc(u())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[e.peek(t),c],mnemonic:["AND",l.default.HEX(c,2)+"H"]}}},this.opecodeTable[s.default("0246")]={mnemonic:"AND (HL)",cycle:7,proc:()=>{C.andAcc(f(F()))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["AND","(HL)"]})},e[s.default("0246")]={mnemonic:"AND (IX+d)",cycle:19,proc:()=>{C.andAcc(f(C.IX+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["AND",`(IX${s})`]}}},t[s.default("0246")]={mnemonic:"AND (IY+d)",cycle:19,proc:()=>{C.andAcc(f(C.IY+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["AND",`(IY${s})`]}}},this.opecodeTable[s.default("0260")]={mnemonic:"OR B",cycle:4,proc:()=>{C.orAcc(L())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["OR","B"]})},this.opecodeTable[s.default("0261")]={mnemonic:"OR C",cycle:4,proc:()=>{C.orAcc(D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["OR","C"]})},this.opecodeTable[s.default("0262")]={mnemonic:"OR D",cycle:4,proc:()=>{C.orAcc(I())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["OR","D"]})},this.opecodeTable[s.default("0263")]={mnemonic:"OR E",cycle:4,proc:()=>{C.orAcc(b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["OR","E"]})},this.opecodeTable[s.default("0264")]={mnemonic:"OR H",cycle:4,proc:()=>{C.orAcc(g())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["OR","H"]})},this.opecodeTable[s.default("0265")]={mnemonic:"OR L",cycle:4,proc:()=>{C.orAcc(R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["OR","L"]})},this.opecodeTable[s.default("0267")]={mnemonic:"OR A",cycle:4,proc:()=>{C.orAcc(E())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["OR","A"]})},this.opecodeTable[s.default("0366")]={mnemonic:"OR n",cycle:7,proc:()=>{C.orAcc(u())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[e.peek(t),c],mnemonic:["OR",l.default.HEX(c,2)+"H"]}}},this.opecodeTable[s.default("0266")]={mnemonic:"OR (HL)",cycle:7,proc:()=>{C.orAcc(f(F()))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["OR","(HL)"]})},e[s.default("0266")]={mnemonic:"OR (IX+d)",cycle:19,proc:()=>{C.orAcc(f(C.IX+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["OR",`(IX${s})`]}}},t[s.default("0266")]={mnemonic:"OR (IY+d)",cycle:19,proc:()=>{C.orAcc(f(C.IY+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["OR",`(IY${s})`]}}},this.opecodeTable[s.default("0250")]={mnemonic:"XOR B",cycle:4,proc:()=>{C.xorAcc(L())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["XOR","B"]})},this.opecodeTable[s.default("0251")]={mnemonic:"XOR C",cycle:4,proc:()=>{C.xorAcc(D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["XOR","C"]})},this.opecodeTable[s.default("0252")]={mnemonic:"XOR D",cycle:4,proc:()=>{C.xorAcc(I())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["XOR","D"]})},this.opecodeTable[s.default("0253")]={mnemonic:"XOR E",cycle:4,proc:()=>{C.xorAcc(b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["XOR","E"]})},this.opecodeTable[s.default("0254")]={mnemonic:"XOR H",cycle:4,proc:()=>{C.xorAcc(g())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["XOR","H"]})},this.opecodeTable[s.default("0255")]={mnemonic:"XOR L",cycle:4,proc:()=>{C.xorAcc(R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["XOR","L"]})},this.opecodeTable[s.default("0257")]={mnemonic:"XOR A",cycle:4,proc:()=>{C.xorAcc(E())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["XOR","A"]})},this.opecodeTable[s.default("0356")]={mnemonic:"XOR n",cycle:7,proc:()=>{C.xorAcc(u())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[e.peek(t),c],mnemonic:["XOR",l.default.HEX(c,2)+"H"]}}},this.opecodeTable[s.default("0256")]={mnemonic:"XOR (HL)",cycle:7,proc:()=>{C.xorAcc(f(F()))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["XOR","(HL)"]})},e[s.default("0256")]={mnemonic:"XOR (IX+d)",cycle:19,proc:()=>{C.xorAcc(f(C.IX+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["XOR",`(IX${s})`]}}},t[s.default("0256")]={mnemonic:"XOR (IY+d)",cycle:19,proc:()=>{C.xorAcc(f(C.IY+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["XOR",`(IY${s})`]}}},this.opecodeTable[s.default("0270")]={mnemonic:"CP B",cycle:4,proc:()=>{C.compareAcc(L())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CP","B"]})},this.opecodeTable[s.default("0271")]={mnemonic:"CP C",cycle:4,proc:()=>{C.compareAcc(D())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CP","C"]})},this.opecodeTable[s.default("0272")]={mnemonic:"CP D",cycle:4,proc:()=>{C.compareAcc(I())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CP","D"]})},this.opecodeTable[s.default("0273")]={mnemonic:"CP E",cycle:4,proc:()=>{C.compareAcc(b())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CP","E"]})},this.opecodeTable[s.default("0274")]={mnemonic:"CP H",cycle:4,proc:()=>{C.compareAcc(g())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CP","H"]})},this.opecodeTable[s.default("0275")]={mnemonic:"CP L",cycle:4,proc:()=>{C.compareAcc(R())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CP","L"]})},this.opecodeTable[s.default("0277")]={mnemonic:"CP A",cycle:4,proc:()=>{C.compareAcc(E())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CP","A"]})},this.opecodeTable[s.default("0376")]={mnemonic:"CP n",cycle:7,proc:()=>{C.compareAcc(u())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[e.peek(t),c],mnemonic:["CP",l.default.HEX(c,2)+"H"]}}},this.opecodeTable[s.default("0276")]={mnemonic:"CP (HL)",cycle:7,proc:()=>{C.compareAcc(f(F()))},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CP","(HL)"]})},e[s.default("0276")]={mnemonic:"CP (IX+d)",cycle:19,proc:()=>{C.compareAcc(f(C.IX+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["CP",`(IX${s})`]}}},t[s.default("0276")]={mnemonic:"CP (IY+d)",cycle:19,proc:()=>{C.compareAcc(f(C.IY+m()))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["CP",`(IY${s})`]}}},this.opecodeTable[s.default("0004")]={mnemonic:"INC B",cycle:4,proc:()=>{C.increment("B")},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","B"]})},this.opecodeTable[s.default("0014")]={mnemonic:"INC C",cycle:4,proc:()=>{C.increment("C")},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","C"]})},this.opecodeTable[s.default("0024")]={mnemonic:"INC D",cycle:4,proc:()=>{C.increment("D")},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","D"]})},this.opecodeTable[s.default("0034")]={mnemonic:"INC E",cycle:4,proc:()=>{C.increment("E")},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","E"]})},this.opecodeTable[s.default("0044")]={mnemonic:"INC H",cycle:4,proc:()=>{C.increment("H")},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","H"]})},this.opecodeTable[s.default("0054")]={mnemonic:"INC L",cycle:4,proc:()=>{C.increment("L")},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","L"]})},this.opecodeTable[s.default("0074")]={mnemonic:"INC A",cycle:4,proc:()=>{C.increment("A")},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","A"]})},this.opecodeTable[s.default("0064")]={mnemonic:"INC (HL)",cycle:11,proc:()=>{this.incrementAt(F())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","(HL)"]})},e[s.default("0064")]={mnemonic:"INC (IX+d)",cycle:23,proc:()=>{this.incrementAt(C.IX+m())},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["INC",`(IX${s})`]}}},t[s.default("0064")]={mnemonic:"INC (IY+d)",cycle:23,proc:()=>{this.incrementAt(C.IY+m())},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["INC",`(IY${s})`]}}},this.opecodeTable[s.default("0005")]={mnemonic:"DEC B",proc:()=>{C.decrement("B")},cycle:4,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","B"]})},this.opecodeTable[s.default("0015")]={mnemonic:"DEC C",proc:()=>{C.decrement("C")},cycle:4,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","C"]})},this.opecodeTable[s.default("0025")]={mnemonic:"DEC D",proc:()=>{C.decrement("D")},cycle:4,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","D"]})},this.opecodeTable[s.default("0035")]={mnemonic:"DEC E",proc:()=>{C.decrement("E")},cycle:4,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","E"]})},this.opecodeTable[s.default("0045")]={mnemonic:"DEC H",proc:()=>{C.decrement("H")},cycle:4,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","H"]})},this.opecodeTable[s.default("0055")]={mnemonic:"DEC L",proc:()=>{C.decrement("L")},cycle:4,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","L"]})},this.opecodeTable[s.default("0075")]={mnemonic:"DEC A",proc:()=>{C.decrement("A")},cycle:4,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","A"]})},this.opecodeTable[s.default("0065")]={mnemonic:"DEC (HL)",proc:()=>{this.decrementAt(F())},cycle:11,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","(HL)"]})},e[s.default("0065")]={mnemonic:"DEC (IX+d)",cycle:23,proc:()=>{this.decrementAt(C.IX+m())},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["DEC",`(IX${s})`]}}},t[s.default("0065")]={mnemonic:"DEC (IY+d)",cycle:23,proc:()=>{this.decrementAt(C.IY+m())},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c],mnemonic:["DEC",`(IY${s})`]}}},this.opecodeTable[s.default("0047")]={mnemonic:"DAA",cycle:4,proc:()=>{C.DAA()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DAA"]})},this.opecodeTable[s.default("0057")]={mnemonic:"CPL",cycle:4,proc:()=>{C.CPL()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CPL"]})},this.opecodeTable[s.default("0077")]={mnemonic:"CCF",cycle:4,proc:()=>{C.flagC()?C.clearFlagC():C.setFlagC()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["CCF"]})},this.opecodeTable[s.default("0067")]={mnemonic:"SCF",cycle:4,proc:()=>{C.setFlagC()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["SCF"]})},this.opecodeTable[s.default("0000")]={mnemonic:"NOP",cycle:4,proc:()=>{},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["NOP"]})},this.opecodeTable[s.default("0166")]={mnemonic:"HALT",cycle:4,proc:()=>{throw this.HALT=1,C.PC-=1,this.exec=(()=>{throw C.R=C.R+1&255,"halt"}),"halt"},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["HALT"]})},this.opecodeTable[s.default("0363")]={mnemonic:"DI",cycle:4,proc:()=>{this.IFF1=this.IFF2=0},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DI"]})},this.opecodeTable[s.default("0373")]={mnemonic:"EI",cycle:4,proc:()=>{this.IFF1?this.IFF2=1:(this.IFF1=this.IFF2=1,C.R=C.R+1&255,this.exec())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["EI"]})},a[s.default("0104")]={mnemonic:"NEG",cycle:8,proc:()=>{C.NEG()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["NEG"]})},a[s.default("0106")]={mnemonic:"IM0",cycle:8,proc:()=>{this.IM=0},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IM0"]})},a[s.default("0126")]={mnemonic:"IM1",cycle:8,proc:()=>{this.IM=1},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IM1"]})},a[s.default("0136")]={mnemonic:"IM2",cycle:8,proc:()=>{this.IM=2},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IM2"]})},this.opecodeTable[s.default("0011")]={mnemonic:"ADD HL,BC",cycle:11,proc:()=>{C.ADD_HL(X())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","HL","BC"]})},this.opecodeTable[s.default("0031")]={mnemonic:"ADD HL,DE",cycle:11,proc:()=>{C.ADD_HL(O())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","HL","DE"]})},this.opecodeTable[s.default("0051")]={mnemonic:"ADD HL,HL",cycle:11,proc:()=>{C.ADD_HL(F())},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","HL","HL"]})},this.opecodeTable[s.default("0071")]={mnemonic:"ADD HL,SP",cycle:11,proc:()=>{C.ADD_HL(C.SP)},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["ADD","HL","SP"]})},a[s.default("0112")]={mnemonic:"ADC HL,BC",cycle:15,proc:()=>{C.ADC_HL(X())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["ADC","HL","BC"]})},a[s.default("0132")]={mnemonic:"ADC HL,DE",cycle:15,proc:()=>{C.ADC_HL(O())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["ADC","HL","DE"]})},a[s.default("0152")]={mnemonic:"ADC HL,HL",cycle:15,proc:()=>{C.ADC_HL(F())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["ADC","HL","HL"]})},a[s.default("0172")]={mnemonic:"ADC HL,SP",cycle:15,proc:()=>{C.ADC_HL(C.SP)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["ADC","HL","SP"]})},a[s.default("0102")]={mnemonic:"SBC HL,BC",cycle:15,proc:()=>{C.SBC_HL(X())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SBC","HL","BC"]})},a[s.default("0122")]={mnemonic:"SBC HL,DE",cycle:15,proc:()=>{C.SBC_HL(O())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SBC","HL","DE"]})},a[s.default("0142")]={mnemonic:"SBC HL,HL",cycle:15,proc:()=>{C.SBC_HL(F())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SBC","HL","HL"]})},a[s.default("0162")]={mnemonic:"SBC HL,SP",cycle:15,proc:()=>{C.SBC_HL(C.SP)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SBC","HL","SP"]})},e[s.default("0011")]={mnemonic:"ADD IX,BC",cycle:15,proc:()=>{C.ADD_IX(X())},disasm:()=>({code:[221,9],mnemonic:["ADD","IX","BC"]})},e[s.default("0031")]={mnemonic:"ADD IX,DE",cycle:15,proc:()=>{C.ADD_IX(O())},disasm:()=>({code:[221,25],mnemonic:["ADD","IX","DE"]})},e[s.default("0051")]={mnemonic:"ADD IX,IX",cycle:15,proc:()=>{C.ADD_IX(C.IX)},disasm:()=>({code:[221,41],mnemonic:["ADD","IX","IX"]})},e[s.default("0071")]={mnemonic:"ADD IX,SP",cycle:15,proc:()=>{C.ADD_IX(C.SP)},disasm:()=>({code:[221,57],mnemonic:["ADD","IX","SP"]})},t[s.default("0011")]={mnemonic:"ADD IY,BC",cycle:15,proc:()=>{C.ADD_IY(X())},disasm:()=>({code:[253,9],mnemonic:["ADD","IY","BC"]})},t[s.default("0031")]={mnemonic:"ADD IY,DE",cycle:15,proc:()=>{C.ADD_IY(O())},disasm:()=>({code:[253,25],mnemonic:["ADD","IY","DE"]})},t[s.default("0051")]={mnemonic:"ADD IY,IY",cycle:15,proc:()=>{C.ADD_IY(C.IY)},disasm:()=>({code:[253,41],mnemonic:["ADD","IY","IY"]})},t[s.default("0071")]={mnemonic:"ADD IY,SP",cycle:15,proc:()=>{C.ADD_IY(C.SP)},disasm:()=>({code:[253,57],mnemonic:["ADD","IY","SP"]})},this.opecodeTable[s.default("0003")]={mnemonic:"INC BC",cycle:6,proc:()=>{C.incBC()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","BC"]})},this.opecodeTable[s.default("0023")]={mnemonic:"INC DE",cycle:6,proc:()=>{C.incDE()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","DE"]})},this.opecodeTable[s.default("0043")]={mnemonic:"INC HL",cycle:6,proc:()=>{C.incHL()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","HL"]})},this.opecodeTable[s.default("0063")]={mnemonic:"INC SP",cycle:6,proc:()=>{C.SP=C.SP+1&65535},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["INC","SP"]})},e[s.default("0043")]={mnemonic:"INC IX",cycle:10,proc:()=>{C.IX=C.IX+1&65535},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["INC","IX"]})},t[s.default("0043")]={mnemonic:"INC IY",cycle:10,proc:()=>{C.IY=C.IY+1&65535},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["INC","IY"]})},this.opecodeTable[s.default("0013")]={mnemonic:"DEC BC",cycle:6,proc:()=>{C.decBC()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","BC"]})},this.opecodeTable[s.default("0033")]={mnemonic:"DEC DE",cycle:6,proc:()=>{C.decDE()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","DE"]})},this.opecodeTable[s.default("0053")]={mnemonic:"DEC HL",cycle:6,proc:()=>{C.decHL()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","HL"]})},this.opecodeTable[s.default("0073")]={mnemonic:"DEC SP",cycle:6,proc:()=>{C.SP=C.SP-1&65535},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["DEC","SP"]})},e[s.default("0053")]={mnemonic:"DEC IX",cycle:10,proc:()=>{C.IX=C.IX-1&65535},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["DEC","IX"]})},t[s.default("0053")]={mnemonic:"DEC IY",cycle:10,proc:()=>{C.IY=C.IY-1&65535},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["DEC","IY"]})},this.opecodeTable[s.default("0007")]={mnemonic:"RLCA",cycle:4,proc:()=>{C.RLCA()},disasm:()=>({code:[s.default("0007")],mnemonic:["RLCA"]})},this.opecodeTable[s.default("0027")]={mnemonic:"RLA",cycle:4,proc:()=>{C.RLA()},disasm:()=>({code:[s.default("0027")],mnemonic:["RLA"]})},this.opecodeTable[s.default("0017")]={mnemonic:"RRCA",cycle:4,proc:()=>{C.RRCA()},disasm:()=>({code:[s.default("0017")],mnemonic:["RRCA"]})},this.opecodeTable[s.default("0037")]={mnemonic:"RRA",cycle:4,proc:()=>{C.RRA()},disasm:()=>({code:[s.default("0037")],mnemonic:["RRA"]})},e[s.default("0313")]={mnemonic:()=>n,proc:()=>{const e=m(),t=u();n[t].proc(e)},disasm:(e,t)=>{const c=e.peek(t+3);return n[c].disasm(e,t)}},t[s.default("0313")]={mnemonic:()=>o,proc:()=>{const e=m(),t=u();o[t].proc(e)},disasm:(e,t)=>{const c=e.peek(t+3);return o[c].disasm(e,t)}},c[s.default("0000")]={mnemonic:"RLC B",cycle:4,proc:()=>{_(C.RLC(L()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLC","B"]})},c[s.default("0001")]={mnemonic:"RLC C",cycle:4,proc:()=>{S(C.RLC(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLC","C"]})},c[s.default("0002")]={mnemonic:"RLC D",cycle:4,proc:()=>{P(C.RLC(I()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLC","D"]})},c[s.default("0003")]={mnemonic:"RLC E",cycle:4,proc:()=>{T(C.RLC(b()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLC","E"]})},c[s.default("0004")]={mnemonic:"RLC H",cycle:4,proc:()=>{H(C.RLC(g()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLC","H"]})},c[s.default("0005")]={mnemonic:"RLC L",cycle:4,proc:()=>{w(C.RLC(R()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLC","L"]})},c[s.default("0007")]={mnemonic:"RLC A",cycle:4,proc:()=>{B(C.RLC(E()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLC","A"]})},c[s.default("0006")]={mnemonic:"RLC (HL)",cycle:15,proc:()=>{const e=F();y(e,C.RLC(f(e)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLC","(HL)"]})},n[s.default("0006")]={mnemonic:"RLC (IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,C.RLC(f(t)))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c,e.peek(t+3)],mnemonic:["RLC",`(IX${s})`]}}},o[s.default("0006")]={mnemonic:"RLC (IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,C.RLC(f(t)))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c,e.peek(t+3)],mnemonic:["RLC",`(IY${s})`]}}},c[s.default("0020")]={mnemonic:"RL B",cycle:8,proc:()=>{_(C.RL(L()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RL","B"]})},c[s.default("0021")]={mnemonic:"RL C",cycle:8,proc:()=>{S(C.RL(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RL","C"]})},c[s.default("0022")]={mnemonic:"RL D",cycle:8,proc:()=>{P(C.RL(I()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RL","D"]})},c[s.default("0023")]={mnemonic:"RL E",cycle:8,proc:()=>{T(C.RL(b()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RL","E"]})},c[s.default("0024")]={mnemonic:"RL H",cycle:8,proc:()=>{H(C.RL(g()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RL","H"]})},c[s.default("0025")]={mnemonic:"RL L",cycle:8,proc:()=>{w(C.RL(R()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RL","L"]})},c[s.default("0026")]={mnemonic:"RL (HL)",cycle:15,proc:()=>{const e=F();y(e,C.RL(f(e)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RL","(HL)"]})},c[s.default("0027")]={mnemonic:"RL A",cycle:8,proc:()=>{B(C.RL(E()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RL","A"]})},n[s.default("0026")]={mnemonic:"RL (IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,C.RL(f(t)))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c,e.peek(t+3)],mnemonic:["RL",`(IX${s})`]}}},o[s.default("0026")]={mnemonic:"RL (IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,C.RL(f(t)))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c,e.peek(t+3)],mnemonic:["RL",`(IY${s})`]}}},c[s.default("0010")]={mnemonic:"RRC B",cycle:4,proc:()=>{_(C.RRC(L()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRC","B"]})},c[s.default("0011")]={mnemonic:"RRC C",cycle:4,proc:()=>{S(C.RRC(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRC","C"]})},c[s.default("0012")]={mnemonic:"RRC D",cycle:4,proc:()=>{P(C.RRC(I()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRC","D"]})},c[s.default("0013")]={mnemonic:"RRC E",cycle:4,proc:()=>{T(C.RRC(b()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRC","E"]})},c[s.default("0014")]={mnemonic:"RRC H",cycle:4,proc:()=>{H(C.RRC(g()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRC","H"]})},c[s.default("0015")]={mnemonic:"RRC L",cycle:4,proc:()=>{w(C.RRC(R()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRC","L"]})},c[s.default("0017")]={mnemonic:"RRC A",cycle:4,proc:()=>{B(C.RRC(E()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRC","A"]})},c[s.default("0016")]={mnemonic:"RRC (HL)",cycle:15,proc:()=>{const e=F();y(e,C.RRC(f(e)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRC","(HL)"]})},n[s.default("0016")]={mnemonic:"RRC (IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,C.RRC(f(t)))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c,e.peek(t+3)],mnemonic:["RRC",`(IX${s})`]}}},o[s.default("0016")]={mnemonic:"RRC (IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,C.RRC(f(t)))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c,e.peek(t+3)],mnemonic:["RRC",`(IY${s})`]}}},c[s.default("0030")]={mnemonic:"RR B",cycle:8,proc:()=>{_(C.RR(L()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RR","B"]})},c[s.default("0031")]={mnemonic:"RR C",cycle:8,proc:()=>{S(C.RR(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RR","C"]})},c[s.default("0032")]={mnemonic:"RR D",cycle:8,proc:()=>{P(C.RR(I()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RR","D"]})},c[s.default("0033")]={mnemonic:"RR E",cycle:8,proc:()=>{T(C.RR(b()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RR","E"]})},c[s.default("0034")]={mnemonic:"RR H",cycle:8,proc:()=>{H(C.RR(g()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RR","H"]})},c[s.default("0035")]={mnemonic:"RR L",cycle:8,proc:()=>{w(C.RR(R()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RR","L"]})},c[s.default("0036")]={mnemonic:"RR (HL)",cycle:15,proc:()=>{const e=F();y(e,C.RR(f(e)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RR","(HL)"]})},c[s.default("0037")]={mnemonic:"RR A",cycle:8,proc:()=>{B(C.RR(E()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RR","A"]})},n[s.default("0036")]={mnemonic:"RR (IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,C.RR(f(t)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1),e.peek(t+2),e.peek(t+3)],mnemonic:["RR","(IX+"+e.peek(t+2)+")"]})},o[s.default("0036")]={mnemonic:"RR (IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,C.RR(f(t)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1),e.peek(t+2),e.peek(t+3)],mnemonic:["RR","(IY+"+e.peek(t+2)+")"]})},c[s.default("0040")]={mnemonic:"SLA B",cycle:8,proc:()=>{_(C.SLA(L()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SLA","B"]})},c[s.default("0041")]={mnemonic:"SLA C",cycle:8,proc:()=>{S(C.SLA(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SLA","C"]})},c[s.default("0042")]={mnemonic:"SLA D",cycle:8,proc:()=>{P(C.SLA(I()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SLA","D"]})},c[s.default("0043")]={mnemonic:"SLA E",cycle:8,proc:()=>{T(C.SLA(b()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SLA","E"]})},c[s.default("0044")]={mnemonic:"SLA H",cycle:8,proc:()=>{H(C.SLA(g()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SLA","H"]})},c[s.default("0045")]={mnemonic:"SLA L",cycle:8,proc:()=>{w(C.SLA(R()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SLA","L"]})},c[s.default("0047")]={mnemonic:"SLA A",cycle:8,proc:()=>{B(C.SLA(E()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SLA","A"]})},c[s.default("0046")]={mnemonic:"SLA (HL)",cycle:15,proc:()=>{const e=F();y(e,C.SLA(f(e)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SLA","(HL)"]})},n[s.default("0046")]={mnemonic:"SLA (IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,C.SLA(f(t)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1),e.peek(t+2),e.peek(t+3)],mnemonic:["SLA","(IX+"+e.peek(t+2)+")"]})},o[s.default("0046")]={mnemonic:"SLA (IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,C.SLA(f(t)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1),e.peek(t+2),e.peek(t+3)],mnemonic:["SLA","(IY+"+e.peek(t+2)+")"]})},c[s.default("0050")]={mnemonic:"SRA B",cycle:8,proc:()=>{_(C.SRA(L()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRA","B"]})},c[s.default("0051")]={mnemonic:"SRA C",cycle:8,proc:()=>{S(C.SRA(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRA","C"]})},c[s.default("0052")]={mnemonic:"SRA D",cycle:8,proc:()=>{P(C.SRA(I()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRA","D"]})},c[s.default("0053")]={mnemonic:"SRA E",cycle:8,proc:()=>{T(C.SRA(b()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRA","E"]})},c[s.default("0054")]={mnemonic:"SRA H",cycle:8,proc:()=>{H(C.SRA(g()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRA","H"]})},c[s.default("0055")]={mnemonic:"SRA L",cycle:8,proc:()=>{w(C.SRA(R()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRA","L"]})},c[s.default("0057")]={mnemonic:"SRA A",cycle:8,proc:()=>{B(C.SRA(E()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRA","A"]})},c[s.default("0056")]={mnemonic:"SRA (HL)",cycle:15,proc:()=>{const e=F();y(e,C.SRA(f(e)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRA","(HL)"]})},n[s.default("0056")]={mnemonic:"SRA (IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,C.SRA(f(t)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1),e.peek(t+2),e.peek(t+3)],mnemonic:["SRA","(IX+"+e.peek(t+2)+")"]})},o[s.default("0056")]={mnemonic:"SRA (IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,C.SRA(f(t)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1),e.peek(t+2),e.peek(t+3)],mnemonic:["SRA","(IY+"+e.peek(t+2)+")"]})},c[s.default("0070")]={mnemonic:"SRL B",cycle:8,proc:()=>{_(C.SRL(L()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRL","B"]})},c[s.default("0071")]={mnemonic:"SRL C",cycle:8,proc:()=>{S(C.SRL(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRL","C"]})},c[s.default("0072")]={mnemonic:"SRL D",cycle:8,proc:()=>{P(C.SRL(I()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRL","D"]})},c[s.default("0073")]={mnemonic:"SRL E",cycle:8,proc:()=>{T(C.SRL(b()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRL","E"]})},c[s.default("0074")]={mnemonic:"SRL H",cycle:8,proc:()=>{H(C.SRL(g()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRL","H"]})},c[s.default("0075")]={mnemonic:"SRL L",cycle:8,proc:()=>{w(C.SRL(R()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRL","L"]})},c[s.default("0077")]={mnemonic:"SRL A",cycle:8,proc:()=>{B(C.SRL(E()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRL","A"]})},c[s.default("0076")]={mnemonic:"SRL (HL)",cycle:15,proc:()=>{const e=F();y(e,C.SRL(f(e)))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["SRL","(HL)"]})},n[s.default("0076")]={mnemonic:"SRL (IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,C.SRL(f(t)))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c,e.peek(t+3)],mnemonic:["SRL",`(IX${s})`]}}},o[s.default("0076")]={mnemonic:"SRL (IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,C.SRL(f(t)))},disasm:(e,t)=>{const c=e.peek(t+2),n=l.default.to8bitSigned(c),s=`${n>=0?"+":""}${n}`;return{code:[e.peek(t),e.peek(t+1),c,e.peek(t+3)],mnemonic:["SRL",`(IY${s})`]}}},a[s.default("0157")]={mnemonic:"RLD",cycle:18,proc:()=>{const e=F();let t=f(e);const c=240&E(),n=15&E(),s=t>>0&15;B(c|t>>4&15),y(e,t=s<<4|n)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RLD"]})},a[s.default("0147")]={mnemonic:"RRD",cycle:18,proc:()=>{const e=F();let t=f(e);const c=240&E(),n=15&E(),s=t>>4&15;B(c|t>>0&15),y(e,t=n<<4|s)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RRD"]})};const $=["B","C","D","E","H","L","(HL)","A"];for(let e=0;e<$.length;e++)for(let t=0;t<8;t++)c[s.default("0100")|t<<3|e]={mnemonic:"BIT "+t+","+$[e],cycle:(e=>6!==e?8:12)(e),proc:((e,t)=>6!==t?()=>{0!=(C["get"+$[t]]()&1<<e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()}:()=>{const t=F();0!=(f(t)&1<<e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()})(t,e),disasm:((e,t)=>(c,n)=>({code:[c.peek(n),c.peek(n+1)],mnemonic:["BIT",e,t]}))(t,$[e])};const x=(e,t,c,n)=>{const s=e.peek(t+2),o=l.default.to8bitSigned(s),i=`${o>=0?"+":""}${o}`;return{code:[f(t),f(t+1),s,f(t+3)],mnemonic:["BIT",""+c,`(${n}${i})`]}};n[s.default("0106")]={mnemonic:"BIT 0,(IX+d)",cycle:20,proc:e=>{1&f(C.IX+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,0,"IX")},n[s.default("0116")]={mnemonic:"BIT 1,(IX+d)",cycle:20,proc:e=>{2&f(C.IX+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,1,"IX")},n[s.default("0126")]={mnemonic:"BIT 2,(IX+d)",cycle:20,proc:e=>{4&f(C.IX+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,2,"IX")},n[s.default("0136")]={mnemonic:"BIT 3,(IX+d)",cycle:20,proc:e=>{8&f(C.IX+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,3,"IX")},n[s.default("0146")]={mnemonic:"BIT 4,(IX+d)",cycle:20,proc:e=>{16&f(C.IX+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,4,"IX")},n[s.default("0156")]={mnemonic:"BIT 5,(IX+d)",cycle:20,proc:e=>{32&f(C.IX+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,5,"IX")},n[s.default("0166")]={mnemonic:"BIT 6,(IX+d)",cycle:20,proc:e=>{64&f(C.IX+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,6,"IX")},n[s.default("0176")]={mnemonic:"BIT 7,(IX+d)",cycle:20,proc:e=>{128&f(C.IX+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,7,"IX")},o[s.default("0106")]={mnemonic:"BIT 0,(IY+d)",cycle:20,proc:e=>{1&f(C.IY+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,0,"IY")},o[s.default("0116")]={mnemonic:"BIT 1,(IY+d)",cycle:20,proc:e=>{2&f(C.IY+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,1,"IY")},o[s.default("0126")]={mnemonic:"BIT 2,(IY+d)",cycle:20,proc:e=>{4&f(C.IY+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,2,"IY")},o[s.default("0136")]={mnemonic:"BIT 3,(IY+d)",cycle:20,proc:e=>{8&f(C.IY+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,3,"IY")},o[s.default("0146")]={mnemonic:"BIT 4,(IY+d)",cycle:20,proc:e=>{16&f(C.IY+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,4,"IY")},o[s.default("0156")]={mnemonic:"BIT 5,(IY+d)",cycle:20,proc:e=>{32&f(C.IY+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,5,"IY")},o[s.default("0166")]={mnemonic:"BIT 6,(IY+d)",cycle:20,proc:e=>{64&f(C.IY+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,6,"IY")},o[s.default("0176")]={mnemonic:"BIT 7,(IY+d)",cycle:20,proc:e=>{128&f(C.IY+e)?C.clearFlagZ():C.setFlagZ(),C.setFlagH(),C.clearFlagN()},disasm:(e,t)=>x(e,t,7,"IY")};for(let e=0;e<$.length;e++)for(let t=0;t<8;t++)c[s.default("0300")|t<<3|e]={mnemonic:"SET "+t+","+$[e],cycle:(t=>6!==e?4:15)(),proc:((e,t)=>6!==t?()=>{C["set"+$[t]](C["get"+$[t]]()|1<<e)}:()=>{const t=F();y(t,f(t)|1<<e)})(t,e),disasm:((e,t)=>(c,n)=>({code:[c.peek(n),c.peek(n+1)],mnemonic:["SET",e,t]}))(t,$[e])};const Z=(e,t,c,n)=>{const s=e.peek(t+2),o=l.default.to8bitSigned(s),i=`${o>=0?"+":""}${o}`;return{code:[f(t+0),f(t+1),s,f(t+3)],mnemonic:["SET",""+c,`(${n}${i})`]}};n[s.default("0306")]={mnemonic:"SET 0,(IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,1|f(t))},disasm:(e,t)=>Z(e,t,0,"IX")},n[s.default("0316")]={mnemonic:"SET 1,(IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,2|f(t))},disasm:(e,t)=>Z(e,t,1,"IX")},n[s.default("0326")]={mnemonic:"SET 2,(IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,4|f(t))},disasm:(e,t)=>Z(e,t,2,"IX")},n[s.default("0336")]={mnemonic:"SET 3,(IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,8|f(t))},disasm:(e,t)=>Z(e,t,3,"IX")},n[s.default("0346")]={mnemonic:"SET 4,(IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,16|f(t))},disasm:(e,t)=>Z(e,t,4,"IX")},n[s.default("0356")]={mnemonic:"SET 5,(IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,32|f(t))},disasm:(e,t)=>Z(e,t,5,"IX")},n[s.default("0366")]={mnemonic:"SET 6,(IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,64|f(t))},disasm:(e,t)=>Z(e,t,6,"IX")},n[s.default("0376")]={mnemonic:"SET 7,(IX+d)",cycle:23,proc:e=>{const t=C.IX+e;y(t,128|f(t))},disasm:(e,t)=>Z(e,t,7,"IX")},o[s.default("0306")]={mnemonic:"SET 0,(IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,1|f(t))},disasm:(e,t)=>Z(e,t,0,"IY")},o[s.default("0316")]={mnemonic:"SET 1,(IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,2|f(t))},disasm:(e,t)=>Z(e,t,1,"IY")},o[s.default("0326")]={mnemonic:"SET 2,(IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,4|f(t))},disasm:(e,t)=>Z(e,t,2,"IY")},o[s.default("0336")]={mnemonic:"SET 3,(IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,8|f(t))},disasm:(e,t)=>Z(e,t,3,"IY")},o[s.default("0346")]={mnemonic:"SET 4,(IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,16|f(t))},disasm:(e,t)=>Z(e,t,4,"IY")},o[s.default("0356")]={mnemonic:"SET 5,(IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,32|f(t))},disasm:(e,t)=>Z(e,t,5,"IY")},o[s.default("0366")]={mnemonic:"SET 6,(IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,64|f(t))},disasm:(e,t)=>Z(e,t,6,"IY")},o[s.default("0376")]={mnemonic:"SET 7,(IY+d)",cycle:23,proc:e=>{const t=C.IY+e;y(t,128|f(t))},disasm:(e,t)=>Z(e,t,7,"IY")};const U=(e,t)=>{const c=~(1<<e);return()=>{C["set"+t](C["get"+t]()&c)}},G=(e,t)=>{const c="BCDEHL A".indexOf(t),n=e<<3;return()=>({code:[203,s.default("0200")|n|c],mnemonic:["RES",e,t]})},z=e=>{return(e=>()=>{const t=F(),c=f(t);y(t,c&e)})(255&~(1<<e))},K=e=>{return(t=>()=>({code:[203,s.default("0200")|t|6],mnemonic:["RES",e,"(HL)"]}))(e<<3)},W=(e,t)=>{return(e=>c=>{const n=C[t]+c,s=f(n);y(n,s&e)})(255&~(1<<e))},V=(e,t)=>{return(c=>(n,s)=>{const o=n.peek(s+2),i=l.default.to8bitSigned(o),r=`${i>=0?"+":""}${i}`,a=n.peek(s+3);return{code:[c,203,o,a],mnemonic:["RES",e,`(${t}${r})`]}})({IX:221,IY:253}[t])};c[s.default("0200")]={mnemonic:"RES 0,B",cycle:8,proc:U(0,"B"),disasm:G(0,"B")},c[s.default("0210")]={mnemonic:"RES 1,B",cycle:8,proc:U(1,"B"),disasm:G(1,"B")},c[s.default("0220")]={mnemonic:"RES 2,B",cycle:8,proc:U(2,"B"),disasm:G(2,"B")},c[s.default("0230")]={mnemonic:"RES 3,B",cycle:8,proc:U(3,"B"),disasm:G(3,"B")},c[s.default("0240")]={mnemonic:"RES 4,B",cycle:8,proc:U(4,"B"),disasm:G(4,"B")},c[s.default("0250")]={mnemonic:"RES 5,B",cycle:8,proc:U(5,"B"),disasm:G(5,"B")},c[s.default("0260")]={mnemonic:"RES 6,B",cycle:8,proc:U(6,"B"),disasm:G(6,"B")},c[s.default("0270")]={mnemonic:"RES 7,B",cycle:8,proc:U(7,"B"),disasm:G(7,"B")},c[s.default("0201")]={mnemonic:"RES 0,C",cycle:8,proc:U(0,"C"),disasm:G(0,"C")},c[s.default("0211")]={mnemonic:"RES 1,C",cycle:8,proc:U(1,"C"),disasm:G(1,"C")},c[s.default("0221")]={mnemonic:"RES 2,C",cycle:8,proc:U(2,"C"),disasm:G(2,"C")},c[s.default("0231")]={mnemonic:"RES 3,C",cycle:8,proc:U(3,"C"),disasm:G(3,"C")},c[s.default("0241")]={mnemonic:"RES 4,C",cycle:8,proc:U(4,"C"),disasm:G(4,"C")},c[s.default("0251")]={mnemonic:"RES 5,C",cycle:8,proc:U(5,"C"),disasm:G(5,"C")},c[s.default("0261")]={mnemonic:"RES 6,C",cycle:8,proc:U(6,"C"),disasm:G(6,"C")},c[s.default("0271")]={mnemonic:"RES 7,C",cycle:8,proc:U(7,"C"),disasm:G(7,"C")},c[s.default("0202")]={mnemonic:"RES 0,D",cycle:8,proc:U(0,"D"),disasm:G(0,"D")},c[s.default("0212")]={mnemonic:"RES 1,D",cycle:8,proc:U(1,"D"),disasm:G(1,"D")},c[s.default("0222")]={mnemonic:"RES 2,D",cycle:8,proc:U(2,"D"),disasm:G(2,"D")},c[s.default("0232")]={mnemonic:"RES 3,D",cycle:8,proc:U(3,"D"),disasm:G(3,"D")},c[s.default("0242")]={mnemonic:"RES 4,D",cycle:8,proc:U(4,"D"),disasm:G(4,"D")},c[s.default("0252")]={mnemonic:"RES 5,D",cycle:8,proc:U(5,"D"),disasm:G(5,"D")},c[s.default("0262")]={mnemonic:"RES 6,D",cycle:8,proc:U(6,"D"),disasm:G(6,"D")},c[s.default("0272")]={mnemonic:"RES 7,D",cycle:8,proc:U(7,"D"),disasm:G(7,"D")},c[s.default("0203")]={mnemonic:"RES 0,E",cycle:8,proc:U(0,"E"),disasm:G(0,"E")},c[s.default("0213")]={mnemonic:"RES 1,E",cycle:8,proc:U(1,"E"),disasm:G(1,"E")},c[s.default("0223")]={mnemonic:"RES 2,E",cycle:8,proc:U(2,"E"),disasm:G(2,"E")},c[s.default("0233")]={mnemonic:"RES 3,E",cycle:8,proc:U(3,"E"),disasm:G(3,"E")},c[s.default("0243")]={mnemonic:"RES 4,E",cycle:8,proc:U(4,"E"),disasm:G(4,"E")},c[s.default("0253")]={mnemonic:"RES 5,E",cycle:8,proc:U(5,"E"),disasm:G(5,"E")},c[s.default("0263")]={mnemonic:"RES 6,E",cycle:8,proc:U(6,"E"),disasm:G(6,"E")},c[s.default("0273")]={mnemonic:"RES 7,E",cycle:8,proc:U(7,"E"),disasm:G(7,"E")},c[s.default("0204")]={mnemonic:"RES 0,H",cycle:8,proc:U(0,"H"),disasm:G(0,"H")},c[s.default("0214")]={mnemonic:"RES 1,H",cycle:8,proc:U(1,"H"),disasm:G(1,"H")},c[s.default("0224")]={mnemonic:"RES 2,H",cycle:8,proc:U(2,"H"),disasm:G(2,"H")},c[s.default("0234")]={mnemonic:"RES 3,H",cycle:8,proc:U(3,"H"),disasm:G(3,"H")},c[s.default("0244")]={mnemonic:"RES 4,H",cycle:8,proc:U(4,"H"),disasm:G(4,"H")},c[s.default("0254")]={mnemonic:"RES 5,H",cycle:8,proc:U(5,"H"),disasm:G(5,"H")},c[s.default("0264")]={mnemonic:"RES 6,H",cycle:8,proc:U(6,"H"),disasm:G(6,"H")},c[s.default("0274")]={mnemonic:"RES 7,H",cycle:8,proc:U(7,"H"),disasm:G(7,"H")},c[s.default("0205")]={mnemonic:"RES 0,L",cycle:8,proc:U(0,"L"),disasm:G(0,"L")},c[s.default("0215")]={mnemonic:"RES 1,L",cycle:8,proc:U(1,"L"),disasm:G(1,"L")},c[s.default("0225")]={mnemonic:"RES 2,L",cycle:8,proc:U(2,"L"),disasm:G(2,"L")},c[s.default("0235")]={mnemonic:"RES 3,L",cycle:8,proc:U(3,"L"),disasm:G(3,"L")},c[s.default("0245")]={mnemonic:"RES 4,L",cycle:8,proc:U(4,"L"),disasm:G(4,"L")},c[s.default("0255")]={mnemonic:"RES 5,L",cycle:8,proc:U(5,"L"),disasm:G(5,"L")},c[s.default("0265")]={mnemonic:"RES 6,L",cycle:8,proc:U(6,"L"),disasm:G(6,"L")},c[s.default("0275")]={mnemonic:"RES 7,L",cycle:8,proc:U(7,"L"),disasm:G(7,"L")},c[s.default("0207")]={mnemonic:"RES 0,A",cycle:8,proc:U(0,"A"),disasm:G(0,"A")},c[s.default("0217")]={mnemonic:"RES 1,A",cycle:8,proc:U(1,"A"),disasm:G(1,"A")},c[s.default("0227")]={mnemonic:"RES 2,A",cycle:8,proc:U(2,"A"),disasm:G(2,"A")},c[s.default("0237")]={mnemonic:"RES 3,A",cycle:8,proc:U(3,"A"),disasm:G(3,"A")},c[s.default("0247")]={mnemonic:"RES 4,A",cycle:8,proc:U(4,"A"),disasm:G(4,"A")},c[s.default("0257")]={mnemonic:"RES 5,A",cycle:8,proc:U(5,"A"),disasm:G(5,"A")},c[s.default("0267")]={mnemonic:"RES 6,A",cycle:8,proc:U(6,"A"),disasm:G(6,"A")},c[s.default("0277")]={mnemonic:"RES 7,A",cycle:8,proc:U(7,"A"),disasm:G(7,"A")},c[s.default("0206")]={mnemonic:"RES 0,(HL)",cycle:15,proc:z(0),disasm:K(0)},c[s.default("0216")]={mnemonic:"RES 1,(HL)",cycle:15,proc:z(1),disasm:K(1)},c[s.default("0226")]={mnemonic:"RES 2,(HL)",cycle:15,proc:z(2),disasm:K(2)},c[s.default("0236")]={mnemonic:"RES 3,(HL)",cycle:15,proc:z(3),disasm:K(3)},c[s.default("0246")]={mnemonic:"RES 4,(HL)",cycle:15,proc:z(4),disasm:K(4)},c[s.default("0256")]={mnemonic:"RES 5,(HL)",cycle:15,proc:z(5),disasm:K(5)},c[s.default("0266")]={mnemonic:"RES 6,(HL)",cycle:15,proc:z(6),disasm:K(6)},c[s.default("0276")]={mnemonic:"RES 7,(HL)",cycle:15,proc:z(7),disasm:K(7)},n[s.default("0206")]={mnemonic:"RES 0,(IX+d)",cycle:23,proc:W(0,"IX"),disasm:V(0,"IX")},n[s.default("0216")]={mnemonic:"RES 1,(IX+d)",cycle:23,proc:W(1,"IX"),disasm:V(1,"IX")},n[s.default("0226")]={mnemonic:"RES 2,(IX+d)",cycle:23,proc:W(2,"IX"),disasm:V(2,"IX")},n[s.default("0236")]={mnemonic:"RES 3,(IX+d)",cycle:23,proc:W(3,"IX"),disasm:V(3,"IX")},n[s.default("0246")]={mnemonic:"RES 4,(IX+d)",cycle:23,proc:W(4,"IX"),disasm:V(4,"IX")},n[s.default("0256")]={mnemonic:"RES 5,(IX+d)",cycle:23,proc:W(5,"IX"),disasm:V(5,"IX")},n[s.default("0266")]={mnemonic:"RES 6,(IX+d)",cycle:23,proc:W(6,"IX"),disasm:V(6,"IX")},n[s.default("0276")]={mnemonic:"RES 7,(IX+d)",cycle:23,proc:W(7,"IX"),disasm:V(7,"IX")},o[s.default("0206")]={mnemonic:"RES 0,(IY+d)",cycle:23,proc:W(0,"IY"),disasm:V(0,"IY")},o[s.default("0216")]={mnemonic:"RES 1,(IY+d)",cycle:23,proc:W(1,"IY"),disasm:V(1,"IY")},o[s.default("0226")]={mnemonic:"RES 2,(IY+d)",cycle:23,proc:W(2,"IY"),disasm:V(2,"IY")},o[s.default("0236")]={mnemonic:"RES 3,(IY+d)",cycle:23,proc:W(3,"IY"),disasm:V(3,"IY")},o[s.default("0246")]={mnemonic:"RES 4,(IY+d)",cycle:23,proc:W(4,"IY"),disasm:V(4,"IY")},o[s.default("0256")]={mnemonic:"RES 5,(IY+d)",cycle:23,proc:W(5,"IY"),disasm:V(5,"IY")},o[s.default("0266")]={mnemonic:"RES 6,(IY+d)",cycle:23,proc:W(6,"IY"),disasm:V(6,"IY")},o[s.default("0276")]={mnemonic:"RES 7,(IY+d)",cycle:23,proc:W(7,"IY"),disasm:V(7,"IY")};const q=(e,t)=>{const c=e.peek(t),n=[c],o=[];let i,a,d,u=null;switch(c&s.default("0300")){case s.default("0000"):switch(o.push("JR"),u=t+(i=r.default.getSignedByte(e.peek(t+1)))+2,n.push(255&i),i=i+2>=0?"+"+(i+2):""+(i+2),c&s.default("0070")){case s.default("0030"):break;case s.default("0070"):o.push("C");break;case s.default("0050"):o.push("Z");break;case s.default("0060"):o.push("NC");break;case s.default("0040"):o.push("NZ");break;default:throw"UNKNOWN OPCODE"}o.push(l.default.HEX(u,4)+"H;("+i+")");break;case s.default("0300"):switch(o.push("JP"),c&s.default("0003")){case 1:o.push("(HL)");break;case 2:switch(a=e.peek(t+1),d=e.peek(t+2),u=r.default.pair(d,a),n.push(a),n.push(d),c&s.default("0070")){case s.default("0000"):o.push("NZ");break;case s.default("0010"):o.push("Z");break;case s.default("0020"):o.push("NC");break;case s.default("0030"):o.push("C");break;case s.default("0040"):o.push("PO");break;case s.default("0050"):o.push("PE");break;case s.default("0060"):o.push("P");break;case s.default("0070"):o.push("M")}o.push(l.default.HEX(d,2)+l.default.HEX(a,2)+"H");break;case 3:a=e.peek(t+1),d=e.peek(t+2),u=r.default.pair(d,a),n.push(a),n.push(d),o.push(l.default.HEX(d,2)+l.default.HEX(a,2)+"H")}break;default:throw"UNKNOWN OPCODE"}return{code:n,mnemonic:o,refAddrTo:u}};this.opecodeTable[s.default("0303")]={mnemonic:"JP nn",cycle:10,proc:()=>{const e=p();C.PC=e},disasm:q},this.opecodeTable[s.default("0302")]={mnemonic:"JP NZ,nn",cycle:10,proc:()=>{const e=p();C.flagZ()||(C.PC=e)},disasm:q},this.opecodeTable[s.default("0312")]={mnemonic:"JP Z,nn",cycle:10,proc:()=>{const e=p();C.flagZ()&&(C.PC=e)},disasm:q},this.opecodeTable[s.default("0322")]={mnemonic:"JP NC,nn",cycle:10,proc:()=>{const e=p();C.flagC()||(C.PC=e)},disasm:q},this.opecodeTable[s.default("0332")]={mnemonic:"JP C,nn",cycle:10,proc:()=>{const e=p();C.flagC()&&(C.PC=e)},disasm:q},this.opecodeTable[s.default("0342")]={mnemonic:"JP PO,nn",cycle:10,proc:()=>{const e=p();C.flagP()||(C.PC=e)},disasm:q},this.opecodeTable[s.default("0352")]={mnemonic:"JP PE,nn",cycle:10,proc:()=>{const e=p();C.flagP()&&(C.PC=e)},disasm:q},this.opecodeTable[s.default("0362")]={mnemonic:"JP P,nn",cycle:10,proc:()=>{const e=p();C.flagS()||(C.PC=e)},disasm:q},this.opecodeTable[s.default("0372")]={mnemonic:"JP M,nn",cycle:10,proc:()=>{const e=p();C.flagS()&&(C.PC=e)},disasm:q},this.opecodeTable[s.default("0030")]={mnemonic:"JR e",cycle:12,proc:()=>{const e=u();C.jumpRel(e)},disasm:q},this.opecodeTable[s.default("0070")]={mnemonic:"JR C,e",cycle:12,proc:()=>{const e=u();C.flagC()&&C.jumpRel(e)},disasm:q},this.opecodeTable[s.default("0050")]={mnemonic:"JR Z,e",cycle:12,proc:()=>{const e=u();C.flagZ()&&C.jumpRel(e)},disasm:q},this.opecodeTable[s.default("0060")]={mnemonic:"JR NC,e",cycle:12,proc:()=>{const e=u();C.flagC()||C.jumpRel(e)},disasm:q},this.opecodeTable[s.default("0040")]={mnemonic:"JR NZ,e",proc:()=>{const e=u();C.flagZ()||C.jumpRel(e)},cycle:12,disasm:q},this.opecodeTable[s.default("0351")]={mnemonic:"JP (HL)",cycle:4,proc:()=>{C.PC=F()},disasm:q},e[s.default("0351")]={mnemonic:"JP (IX)",cycle:8,proc:()=>{C.PC=C.IX},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["JP","(IX)"]})},t[s.default("0351")]={mnemonic:"JP (IY)",cycle:8,proc:()=>{C.PC=C.IY},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["JP","(IY)"]})},e[s.default("0104")]={mnemonic:"LD B,IXH",proc:()=>{_(C.IX>>8&255)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","B","IXH"]})},e[s.default("0115")]={mnemonic:"LD C,IXL",proc:()=>{S(255&C.IX)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","C","IXL"]})},e[s.default("0140")]={mnemonic:"LD IXH,B",proc:()=>{C.IX=65280&L()<<8|255&C.IX},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","IXH","B"]})},e[s.default("0147")]={mnemonic:"LD IXH,A",proc:()=>{C.IX=65280&E()<<8|255&C.IX},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","IXH","A"]})},e[s.default("0151")]={mnemonic:"LD IXL,C",proc:()=>{C.IX=65280&C.IX|255&D()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","IXL","C"]})},e[s.default("0157")]={mnemonic:"LD IXL,A",proc:()=>{C.IX=65280&C.IX|255&E()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","IXL","A"]})},e[s.default("0175")]={mnemonic:"LD A,IXL",proc:()=>{B(255&C.IX)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["LD","A","IXL"]})},e[s.default("0204")]={mnemonic:"ADD A,IXH",proc:()=>{C.addAcc(C.IX>>8&255)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["ADD","A","IXH"]})},e[s.default("0205")]={mnemonic:"ADD A,IXL",proc:()=>{C.addAcc(255&C.IX)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["ADD","A","IXL"]})},e[s.default("0275")]={mnemonic:"CP IXL",proc:()=>{C.compareAcc(255&C.IX)},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["CP","IXL"]})},this.opecodeTable[s.default("0020")]={mnemonic:"DJNZ",cycle:13,proc:()=>{const e=u();C.decrement("B"),L()&&C.jumpRel(e)},disasm:(e,t)=>{const c=r.default.getSignedByte(e.peek(t+1)),n=t+c+2;return{code:[e.peek(t),e.peek(t+1)],mnemonic:["DJNZ",l.default.HEX(n,4)+"H;("+(c+2>=0?"+":"")+(c+2)+")"],refAddrTo:n}}},this.opecodeTable[s.default("0315")]={mnemonic:"CALL nn",cycle:17,proc:()=>{const e=p();A(C.PC),C.PC=e},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0304")]={mnemonic:"CALL NZ,nn",cycle:"NZ→17,Z→10",proc:()=>{const e=p();return C.flagZ()?10:(A(C.PC),C.PC=e,17)},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL","NZ",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0314")]={mnemonic:"CALL Z,nn",cycle:"Z→17,NZ→10",proc:()=>{const e=p();return C.flagZ()?(A(C.PC),C.PC=e,17):10},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL","Z",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0324")]={mnemonic:"CALL NC,nn",cycle:"NC→17, C→10",proc:()=>{const e=p();return C.flagC()?10:(A(C.PC),C.PC=e,17)},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL","NC",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0334")]={mnemonic:"CALL C,nn",cycle:"C→17, NC→10",proc:()=>{const e=p();return C.flagC()?(A(C.PC),C.PC=e,17):10},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL","C",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0344")]={mnemonic:"CALL PO,nn",cycle:"Parity Odd→17, Even→10",proc:()=>{const e=p();return C.flagP()?10:(A(C.PC),C.PC=e,17)},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL","PO",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0354")]={mnemonic:"CALL PE,nn",cycle:"Parity Even→17, Odd→10",proc:()=>{const e=p();return C.flagP()?(A(C.PC),C.PC=e,17):10},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL","PE",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0364")]={mnemonic:"CALL P,nn",cycle:"P→17, M→10",proc:()=>{const e=p();return C.flagS()?10:(A(C.PC),C.PC=e,17)},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL","P",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0374")]={mnemonic:"CALL M,nn",cycle:"M→17, P→10",proc:()=>{const e=p();return C.flagS()?(A(C.PC),C.PC=e,17):10},disasm:(e,t)=>{const c=e.peek(t+1),n=e.peek(t+2),s=r.default.pair(n,c);return{code:[e.peek(t),c,n],mnemonic:["CALL","M",l.default.HEX(s,4)+"H"],refAddrTo:s}}},this.opecodeTable[s.default("0311")]={mnemonic:"RET",cycle:10,proc:()=>{C.PC=k()},disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET"]})},this.opecodeTable[s.default("0300")]={mnemonic:"RET NZ",cycle:"NZ→11, Z→5",proc:()=>C.flagZ()?5:(C.PC=k(),11),disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET","NZ"]})},this.opecodeTable[s.default("0310")]={mnemonic:"RET Z",cycle:"Z→5, NZ→11",proc:()=>C.flagZ()?(C.PC=k(),11):5,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET","Z"]})},this.opecodeTable[s.default("0320")]={mnemonic:"RET NC",cycle:"NC→11,C→5",proc:()=>C.flagC()?5:(C.PC=k(),11),disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET","NC"]})},this.opecodeTable[s.default("0330")]={mnemonic:"RET C",cycle:"C→11,NC→5",proc:()=>C.flagC()?(C.PC=k(),11):5,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET","C"]})},this.opecodeTable[s.default("0340")]={mnemonic:"RET PO",cycle:"Parity Odd→11, Parity Even→5",proc:()=>C.flagP()?5:(C.PC=k(),11),disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET","PO"]})},this.opecodeTable[s.default("0350")]={mnemonic:"RET PE",cycle:"Parity Even→11, Parity Odd→5",proc:()=>C.flagP()?(C.PC=k(),11):5,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET","PE"]})},this.opecodeTable[s.default("0360")]={mnemonic:"RET P",cycle:"P→11, M→5",proc:()=>C.flagS()?5:(C.PC=k(),11),disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET","P"]})},this.opecodeTable[s.default("0370")]={mnemonic:"RET M",cycle:"M→11, P→5",proc:()=>C.flagS()?(C.PC=k(),11):5,disasm:(e,t)=>({code:[e.peek(t)],mnemonic:["RET","M"]})},a[s.default("0115")]={mnemonic:"RETI",cycle:15,proc:()=>{C.PC=k(),this.IFF1=this.IFF2},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RETI"]})},a[s.default("0105")]={mnemonic:"RETN",cycle:14,proc:()=>{C.PC=k(),this.IFF1=this.IFF2},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["RETN"]})};const J=[0,8,16,24,32,40,48,56];for(let e=0;e<J.length;e++)this.opecodeTable[s.default("0307")|e<<3]={mnemonic:"RST "+l.default.HEX(J[e],2)+"H",proc:(e=>()=>{A(C.PC),C.PC=e})(J[e]),cycle:12,disasm:(e=>(t,c)=>({code:[t.peek(c)],mnemonic:["RST",l.default.HEX(e,2)+"H"]}))(J[e])};this.opecodeTable[s.default("0333")]={mnemonic:"IN A,(n)",cycle:11,proc:()=>{B(this.readIoPort(u()))},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[219,c],mnemonic:["IN","A",`(${l.default.HEX(c,2)}H)`]}}},a[s.default("0100")]={mnemonic:"IN B,(C)",cycle:12,proc:()=>{_(this.readIoPort(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IN","B","(C)"]})},a[s.default("0110")]={mnemonic:"IN C,(C)",cycle:12,proc:()=>{S(this.readIoPort(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IN","C","(C)"]})},a[s.default("0120")]={mnemonic:"IN D,(C)",cycle:12,proc:()=>{P(this.readIoPort(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IN","D","(C)"]})},a[s.default("0130")]={mnemonic:"IN E,(C)",cycle:12,proc:()=>{T(this.readIoPort(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IN","E","(C)"]})},a[s.default("0140")]={mnemonic:"IN H,(C)",cycle:12,proc:()=>{H(this.readIoPort(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IN","H","(C)"]})},a[s.default("0150")]={mnemonic:"IN L,(C)",cycle:12,proc:()=>{w(this.readIoPort(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IN","L","(C)"]})},a[s.default("0170")]={mnemonic:"IN A,(C)",cycle:12,proc:()=>{B(this.readIoPort(D()))},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IN","A","(C)"]})},a[s.default("0242")]={mnemonic:"INI",cycle:16,proc:()=>{_(L()-1&255),y(F(),this.readIoPort(D())),C.postINI()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["INI"]})},a[s.default("0262")]={mnemonic:"INIR",cycle:"21 x reg B",proc:()=>(_(L()-1&255),y(F(),this.readIoPort(D())),C.postINI(),0!==L()&&(C.PC-=2),21),disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["INIR"]})},a[s.default("0252")]={mnemonic:"IND",cycle:16,proc:()=>{_(L()-1&255),y(F(),this.readIoPort(D())),C.postIND()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["IND"]})},a[s.default("0272")]={mnemonic:"INDR",cycle:"21 x reg B",proc:()=>(_(L()-1&255),y(F(),this.readIoPort(D())),C.postIND(),0!==L()&&(C.PC-=2),21),disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["INDR"]})},this.opecodeTable[s.default("0323")]={mnemonic:"OUT (n),A",cycle:11,proc:()=>{this.writeIoPort(u(),E())},disasm:(e,t)=>{const c=e.peek(t+1);return{code:[211,c],mnemonic:["OUT",`(${l.default.HEX(c,2)}H)`,"A"]}}},a[s.default("0101")]={mnemonic:"OUT (C),B",cycle:12,proc:()=>{this.writeIoPort(D(),L())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUT","(C)","B"]})},a[s.default("0111")]={mnemonic:"OUT (C),C",cycle:12,proc:()=>{this.writeIoPort(D(),D())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUT","(C)","C"]})},a[s.default("0121")]={mnemonic:"OUT (C),D",cycle:12,proc:()=>{this.writeIoPort(D(),I())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUT","(C)","D"]})},a[s.default("0131")]={mnemonic:"OUT (C),E",cycle:12,proc:()=>{this.writeIoPort(D(),b())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUT","(C)","E"]})},a[s.default("0141")]={mnemonic:"OUT (C),H",cycle:12,proc:()=>{this.writeIoPort(D(),g())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUT","(C)","H"]})},a[s.default("0151")]={mnemonic:"OUT (C),L",cycle:12,proc:()=>{this.writeIoPort(D(),R())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUT","(C)","L"]})},a[s.default("0171")]={mnemonic:"OUT (C),A",cycle:12,proc:()=>{this.writeIoPort(D(),E())},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUT","(C)","A"]})},a[s.default("0243")]={mnemonic:"OUTI",cycle:16,proc:()=>{_(L()-1&255),this.writeIoPort(D(),f(F())),C.postOUTI()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUTI"]})},a[s.default("0263")]={mnemonic:"OTIR",cycle:"21 x reg B",proc:()=>(_(L()-1&255),this.writeIoPort(D(),f(F())),C.postOUTI(),0!==L()&&(C.PC-=2),21),disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OTIR"]})},a[s.default("0253")]={mnemonic:"OUTD",cycle:16,proc:()=>{_(L()-1&255),this.writeIoPort(D(),f(F())),C.postOUTD()},disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OUTD"]})},a[s.default("0273")]={mnemonic:"OTDR",cycle:"21 x reg B",proc:()=>(_(L()-1&255),this.writeIoPort(D(),f(F())),C.postOUTD(),0!==L()&&(C.PC-=2),21),disasm:(e,t)=>({code:[e.peek(t),e.peek(t+1)],mnemonic:["OTDR"]})}}onReadIoPort(e,t){this._onReadIoPort[e]=t}onWriteIoPort(e,t){this._onWriteIoPort[e]=t}static dasm(e,t,c,n){if(t=t||0,c=c||e.length-t,(n=n||0)-t<0)return void console.error("Z80.dasm: parameter error : (addr - offset) - out of range");if(c<0||t+c>e.length)return void console.error("Z80.dasm: parameter error : size - out of range");const s=[],i=new o.default;i.create({startAddr:n-t,size:c}),i.mem=e;const r=new d({memory:i});r.reg.PC=i.startAddr;const u=a.default.create("ORG",l.default.HEX(i.startAddr,4)+"H");for(u.setAddress(i.startAddr),s.push(u);r.reg.PC<i.startAddr+i.size;){const e=r.disassemble(r.reg.PC,n-t+c);e.setAddress(r.reg.PC),e.bytecode.length>0&&e.setComment("; "+l.default.HEX(e.address,4)+"H "+e.bytecode.map(e=>l.default.HEX(e,2)).join(" ")),s.push(e),r.reg.PC+=e.bytecode.length}return d.processAddressReference(s)}static processAddressReference(e){const t={};return e.forEach((e,c)=>{t[e.address]=c}),e.forEach((e,c,n)=>{if(null!=e.refAddrTo&&e.refAddrTo in t){n[t[e.refAddrTo]].refCount++}}),e.forEach((e,t,c)=>{e.refCount>0&&c[t].setLabel("$"+l.default.HEX(e.address,4)+"H")}),e}static dasmlines(e){return e.map(e=>{let t;t=e.refCount>0?"L"+l.default.HEX(e.address,4)+"H:":"       ",t+="   ";let c=e.mnemonic||"";const n=e.operand||"";if(c&&n)for(;c.length<8;)c+=" ";let s=t+"      "+c+n;if(c||n)for(;s.length<40;)s+=" ";return""!==e.comment&&(0!==e.refCount||c||n?s+=e.comment:s=e.comment),s.replace(/\s*$/,"")})}}c.default=d,d.exec=function(){this.reg.R=this.reg.R+1&255;const e=this.opecodeTable[this.fetch()],t=e.proc()||e.cycle||4;if(this.consumedTCycle+=t,null!=this.bpmap[this.reg.PC])throw console.log("*** BREAK AT $"+l.default.HEX(this.reg.PC,4)),"break"},t.exports=d},{"../lib/number-util":27,"../lib/oct":28,"./Z80-line-assembler":6,"./bin-util":8,"./memory-block":13,"./register":14}],8:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});class n{static pair(e,t){return((255&e)<<8)+(255&t)}static hibyte(e){return e>>8&255}static lobyte(e){return 255&e}static getSignedByte(e){return 128&(e&=255)?-(e=1+(255&~e)):e}}c.default=n,t.exports=n},{}],9:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./bin-util"));class o{constructor(){}create(e){if(e=e||{},this.size=e.size||65536,this.startAddr=e.startAddr||0,this.startAddr<0||this.startAddr>65535)throw new Error("Invalid start address of memory");if(this.size<0)throw new Error("Invalid memory size");if(this.startAddr+this.size>65536)throw new Error("Invalid combination of start address and memory size.")}peekByte(e){const t="Error: abstruct pokeByte was invoked."+`This method must be overrided by the class ${this.constructor.name}`;throw console.error(t),new Error(t)}pokeByte(e,t){const c="Error: abstruct pokeByte was invoked."+`This method must be overrided by the class ${this.constructor.name}`;throw console.error(c),new Error(c)}clear(){for(let e=0;e<this.size;e++)this.pokeByte(e,0)}peek(e){return this.peekByte(e)}poke(e,t){this.pokeByte(e,t)}peekPair(e){return s.default.pair(this.peek(e+1),this.peek(e+0))}}c.default=o,t.exports=o},{"./bin-util":8}],10:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./imem"));class o extends s.default{constructor(e){super(),this.create(e)}create(e){super.create(e),this.mem=new Array(this.size),this.memblk=new Map}setMemoryBlock(e,t){if(null==t){if(this.memblk.has(e)){const t=this.memblk.get(e),c=t.size,n=t.startAddr,s=n+c,o={peek:()=>0,poke:()=>{}};for(let e=n;e<s;e++)this.mem[e]=o;this.memblk.delete(e)}}else{this.memblk.set(e,t);const c=this.memblk.get(e),n=c.size,s=c.startAddr,o=s+n;for(let e=s;e<o;e++)this.mem[e]=t}}peekByte(e){return 255&this.mem[e-this.startAddr].peek(e)}pokeByte(e,t){this.mem[e-this.startAddr].poke(e,255&t)}}c.default=o,t.exports=o},{"./imem":9}],11:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./memory-block-cbw"));class o extends s.default{constructor(e){super(e),this.onPeek=((e,t)=>0),e.onPeek&&(this.onPeek=e.onPeek)}peek(e){const t=super.peekByte(e),c=this.onPeek(e,t);return null!=c&&void 0!==c?c:t}}c.default=o,t.exports=o},{"./memory-block-cbw":12}],12:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./memory-block"));class o extends s.default{constructor(e){super(e),this.onPoke=((e,t)=>{}),e.onPoke&&(this.onPoke=e.onPoke)}poke(e,t){super.pokeByte(e,t),this.onPoke(e,this.peekByte(e))}}c.default=o,t.exports=o},{"./memory-block":13}],13:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./imem"));class o extends s.default{constructor(e){super(),super.create(e),this.mem=new Array(this.size)}peekByte(e){return this.mem[e-this.startAddr]}pokeByte(e,t){this.mem[e-this.startAddr]=t}}c.default=o,t.exports=o},{"./imem":9}],14:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("../lib/number-util")),o=n(e("./bin-util"));class i{constructor(){const e=new ArrayBuffer(65536);this._flagTable=new Uint8Array(e),this._PTableIndex=0,this._ZSTableIndex=512,this._ZSPTableIndex=1024,this.initTable(),this.clear(),this._B=0,this._C=0,this._D=0,this._E=0,this._H=0,this._L=0,this._A=0,this._F=0,this.PC=0,this.SP=0,this.IX=0,this.IY=0,this.R=0,this.I=0}initTable(){const e=(e,t)=>{this._flagTable[this._PTableIndex+e]=t},t=e=>this._flagTable[this._PTableIndex+e],c=(e,t)=>{this._flagTable[this._ZSTableIndex+e]=t},n=(e,t)=>{this._flagTable[this._ZSPTableIndex+e]=t};let s=0,o=0,r=0;for(s=0;s<256;s++)o=0,0===s&&(o|=i.Z_FLAG),128&s&&(o|=i.S_FLAG),r=0,0!=(1&s)&&(r+=1),0!=(2&s)&&(r+=1),0!=(4&s)&&(r+=1),0!=(8&s)&&(r+=1),0!=(16&s)&&(r+=1),0!=(32&s)&&(r+=1),0!=(64&s)&&(r+=1),0!=(128&s)&&(r+=1),e(s,1&r?0:i.V_FLAG),c(s,o),n(s,o|t(s));for(s=0;s<256;s+=1)c(s+256,this.getZSTable(s)|i.C_FLAG),n(s+256,this.getZSPTable(s)|i.C_FLAG),e(s+256,t(s)|i.C_FLAG)}pair(e,t){return((255&e)<<8)+(255&t)}hi8(e){return e>>8&255}lo8(e){return 255&e}setB(e){this._B=255&e}getB(){return this._B}setC(e){this._C=255&e}getC(){return this._C}setD(e){this._D=255&e}getD(){return this._D}setE(e){this._E=255&e}getE(){return this._E}setH(e){this._H=255&e}getH(){return this._H}setL(e){this._L=255&e}getL(){return this._L}setA(e){this._A=255&e}getA(){return this._A}setF(e){this._F=255&e}getF(){return this._F}setBC(e){this._B=this.hi8(e),this._C=this.lo8(e)}getBC(){return this.pair(this._B,this._C)}setDE(e){this._D=this.hi8(e),this._E=this.lo8(e)}getDE(){return this.pair(this._D,this._E)}setHL(e){this._H=this.hi8(e),this._L=this.lo8(e)}getHL(){return this.pair(this._H,this._L)}setAF(e){this._A=this.hi8(e),this._F=this.lo8(e)}getAF(){return this.pair(this._A,this._F)}testFlag(e){return this._F&e?1:0}setFlag(e){this._F=this._F|e}clearFlag(e){this._F=255&this._F&~e}flagS(){return this._F&i.S_FLAG?1:0}flagZ(){return this._F&i.Z_FLAG?1:0}flagH(){return this._F&i.H_FLAG?1:0}flagP(){return this._F&i.V_FLAG?1:0}flagN(){return this._F&i.N_FLAG?1:0}flagC(){return this._F&i.C_FLAG?1:0}setFlagS(){this._F=this._F|i.S_FLAG}setFlagZ(){this._F=this._F|i.Z_FLAG}setFlagH(){this._F=this._F|i.H_FLAG}setFlagP(){this._F=this._F|i.V_FLAG}setFlagN(){this._F=this._F|i.N_FLAG}setFlagC(){this._F=this._F|i.C_FLAG}clearFlagS(){this._F=255&this._F&~i.S_FLAG}clearFlagZ(){this._F=255&this._F&~i.Z_FLAG}clearFlagH(){this._F=255&this._F&~i.H_FLAG}clearFlagP(){this._F=255&this._F&~i.V_FLAG}clearFlagN(){this._F=255&this._F&~i.N_FLAG}clearFlagC(){this._F=255&this._F&~i.C_FLAG}ADDW(e,t){const c=e+t;return this.setF(this.getF()&(i.S_FLAG|i.Z_FLAG|i.V_FLAG)|(4096&(e^c^t))>>8|c>>16&1),65535&c}ADD_HL(e){this.setHL(this.ADDW(this.getHL(),e))}ADC_HL(e){const t=this.getHL(),c=t+e+(this.getF()&i.C_FLAG);this.setF((4096&(t^c^e))>>8|c>>16&1|(32768&c)>>8|(65535&c?0:i.Z_FLAG)|((e^t^32768)&(e^c)&32768)>>13),this.setHL(c)}SBC_HL(e){const t=this.getHL(),c=t-e-(1&this.getF());this.setF((4096&(t^c^e))>>8|c>>16&1|(32768&c)>>8|(65535&c?0:i.Z_FLAG)|(e&t&(e^c)&32768)>>13|i.N_FLAG),this.setHL(c)}incBC(){this.setBC(this.getBC()+1)}decBC(){this.setBC(this.getBC()-1)}incHL(){this.setHL(this.getHL()+1)}decHL(){this.setHL(this.getHL()-1)}incDE(){this.setDE(this.getDE()+1)}decDE(){this.setDE(this.getDE()-1)}RLCA(){const e=this.getA();this.setA(255&(e<<1|(128&e)>>7)),this.setF(236&this.getF()|1&this.getA())}RLA(){const e=this.getF()&i.C_FLAG,t=this.getA();this.setF(236&this.getF()|(128&t)>>7),this.setA(255&(t<<1|e))}RRCA(){const e=this.getA();this.setF(236&this.getF()|1&e),this.setA(e>>1|e<<7&255)}RRA(){const e=this.getF()&i.C_FLAG,t=this.getA();this.setF(236&this.getF()|1&t),this.setA(t>>1|e<<7)}postIND(){this.decHL(),this.setF(this.getB()?i.N_FLAG:i.N_FLAG|i.Z_FLAG)}postINI(){this.incHL(),this.setF(this.getB()?i.N_FLAG:i.N_FLAG|i.Z_FLAG)}postOUTD(){this.decHL(),this.setF(this.getB()?i.N_FLAG:i.N_FLAG|i.Z_FLAG)}postOUTI(){this.incHL(),this.setF(this.getB()?i.N_FLAG:i.N_FLAG|i.Z_FLAG)}onLDD(){this.decDE(),this.decHL(),this.decBC(),this.setF(233&this.getF()|(this.getBC()?i.V_FLAG:0))}onLDI(){this.incDE(),this.incHL(),this.decBC(),this.setF(233&this.getF()|(this.getBC()?i.V_FLAG:0))}addAcc(e){const t=this.getA()+e;this.setF(this.getZSTable(255&t)|(256&t)>>8|(this.getA()^t^e)&i.H_FLAG|((e^this.getA()^128)&(e^t)&128)>>5),this.setA(255&t)}addAccWithCarry(e){const t=this.getA()+e+(this.getF()&i.C_FLAG);this.setF(this.getZSTable(255&t)|(256&t)>>8|(this.getA()^t^e)&i.H_FLAG|((e^this.getA()^128)&(e^t)&128)>>5),this.setA(255&t)}subAcc(e){const t=this.getA()-e&511;this.setF(this.getZSTable(255&t)|(256&t)>>8|i.N_FLAG|(this.getA()^t^e)&i.H_FLAG|((e^this.getA()^128)&(e^t)&128)>>5),this.setA(255&t)}subAccWithCarry(e){const t=this.getA()-e-(this.getF()&i.C_FLAG)&511;this.setF(this.getZSTable(255&t)|(256&t)>>8|i.N_FLAG|(this.getA()^t^e)&i.H_FLAG|((e^this.getA()^128)&(e^t)&128)>>5),this.setA(255&t)}andAcc(e){this.setA(255&this.getA()&e),this.setF(this.getZSPTable(this.getA())|i.H_FLAG)}orAcc(e){this.setA(this.getA()|255&e),this.setF(this.getZSPTable(this.getA()))}xorAcc(e){this.setA(this.getA()^255&e),this.setF(this.getZSPTable(this.getA()))}CPL(){this.setA(255&(255^this.getA())),this.setF(i.H_FLAG|i.N_FLAG)}NEG(){const e=this.getA();this.setA(0),this.subAcc(e)}getINCValue(e){return e=e+1&255,this.setF(this.getF()&i.C_FLAG|this.getZSTable(e)|(128===e?i.V_FLAG:0)|(15&e?0:i.H_FLAG)),e}getDECValue(e){return this.setF(this.getF()&i.C_FLAG|i.N_FLAG|(128===e?i.V_FLAG:0)|(15&e?0:i.H_FLAG)),e=e-1&255,this.setF(this.getF()|this.getZSTable(e)),e}compareAcc(e){const t=this.getA()-e;this.setF(this.getZSTable(255&t)|(256&t)>>8|i.N_FLAG|(this.getA()^t^e)&i.H_FLAG|((e^this.getA())&(e^t)&128)>>5)}CPI(e){const t=this.getA()-e;this.incHL(),this.decBC(),this.setF(this.getF()&i.C_FLAG|this.getZSTable(255&t)|(this.getA()^e^t)&i.H_FLAG|(this.getBC()?i.V_FLAG:0)|i.N_FLAG)}CPD(e){const t=this.getA()-e;this.decHL(),this.decBC(),this.setF(this.getF()&i.C_FLAG|this.getZSTable(255&t)|(this.getA()^e^t)&i.H_FLAG|(this.getBC()?i.V_FLAG:0)|i.N_FLAG)}RLC(e){const t=e>>7;return e=255&(e<<1|t),this.setF(this.getZSPTable(e)|t),e}RL(e){const t=e>>7;return e=255&(e<<1|1&this.getF()),this.setF(this.getZSPTable(e)|t),e}RRC(e){const t=1&e;return e=e>>1|t<<7&255,this.setF(this.getZSPTable(e)|t),e}RR(e){const t=1&e;return e=e>>1|this.getF()<<7&255,this.setF(this.getZSPTable(e)|t),e}SLA(e){const t=e>>7;return e=e<<1&255,this.setF(this.getZSPTable(e)|t),e}SRA(e){const t=1&e;return e=e>>1|128&e,this.setF(this.getZSPTable(e)|t),e}SRL(e){const t=1&e;return e>>=1,this.setF(this.getZSPTable(e)|t),e}onReadIoPort(e){this.setF(this.getF()&i.C_FLAG|this.getZSPTable(e))}LD_A_I(e){this.setA(this.I),this.setF(this.getF()&i.C_FLAG|this.getZSTable(this.I)|e<<2)}LD_A_R(e,t){this.setA(127&this.R|128&t),this.setF(this.getF()&i.C_FLAG|this.getZSTable(this.getA())|e<<2)}cloneRaw(){return{B:this.getB(),C:this.getC(),D:this.getD(),E:this.getE(),H:this.getH(),L:this.getL(),A:this.getA(),F:this.getF(),PC:this.PC,SP:this.SP,IX:this.IX,IY:this.IY,R:this.R,I:this.I}}clear(){this._B=0,this._C=0,this._D=0,this._E=0,this._H=0,this._L=0,this._A=0,this._F=0,this.PC=0,this.SP=0,this.IX=0,this.IY=0,this.R=0,this.I=0}setFrom(e){this.setB(e.getB()),this.setC(e.getC()),this.setD(e.getD()),this.setE(e.getE()),this.setH(e.getH()),this.setL(e.getL()),this.setA(e.getA()),this.setF(e.getF()),this.PC=e.PC,this.SP=e.SP,this.IX=e.IX,this.IY=e.IY,this.R=e.R,this.I=e.I}setPair(e,t){switch(e){case"SP":this.SP=t;break;case"PC":this.PC=t;break;case"IX":this.IX=t;break;case"IY":this.IY=t;break;case"BC":this.setBC(t);break;case"DE":this.setDE(t);break;case"HL":this.setHL(t);break;case"AF":this.setAF(t)}}debugDump(){console.info("B:"+s.default.HEX(this.getB(),2)+"H "+this.getB()+" C:"+s.default.HEX(this.getC(),2)+"H "+this.getC()+" / "+this.getBC()),console.info("D:"+s.default.HEX(this.getD(),2)+"H "+this.getD()+" E:"+s.default.HEX(this.getE(),2)+"H "+this.getE()+" / "+this.getDE()),console.info("H:"+s.default.HEX(this.getH(),2)+"H "+this.getH()+" L:"+s.default.HEX(this.getL(),2)+"H "+this.getL()+" / "+this.getHL()),console.info("A:"+s.default.HEX(this.getA(),2)+"H "+this.getA()),console.info("SZ-HPN-C"),console.info(s.default.bin(this.getF(),8)),console.info("PC:"+s.default.HEX(this.PC,4)+"H "+s.default.bin(this.PC,16)+"(2) "+this.PC),console.info("SP:"+s.default.HEX(this.SP,4)+"H "+s.default.bin(this.SP,16)+"(2) "+this.SP),console.info("I:"+s.default.HEX(this.I,2)+"H "+s.default.bin(this.I,8)+"(2) "+this.I+" R:"+s.default.HEX(this.R,2)+"H "+s.default.bin(this.R,8)+"(2) "+this.R)}ADD_IX(e){this.IX=this.ADDW(this.IX,e)}ADD_IY(e){this.IY=this.ADDW(this.IY,e)}jumpRel(e){this.PC+=o.default.getSignedByte(e)}increment(e){this["set"+e](this.getINCValue(this["get"+e]()))}decrement(e){this["set"+e](this.getDECValue(this["get"+e]()))}getZSTable(e){return this._flagTable[this._ZSTableIndex+e]}getZSPTable(e){return this._flagTable[this._ZSPTableIndex+e]}DAA(){let e=this.getA();const t=this.getF();t&i.C_FLAG&&(e|=256),t&i.H_FLAG&&(e|=512),t&i.N_FLAG&&(e|=1024),this.setAF(i.DAATable[e])}}c.default=i,i.S_FLAG=128,i.Z_FLAG=64,i.H_FLAG=16,i.V_FLAG=4,i.N_FLAG=2,i.C_FLAG=1,i.REG_R_ID2NAME={0:"B",1:"C",2:"D",3:"E",4:"H",5:"L",7:"A"},i.CONDITION_INDEX={NZ:0,Z:1,NC:2,C:3,PO:4,PE:5,P:6,N:7},i.DAATable=[68,256,512,772,1024,1284,1540,1792,2056,2316,4112,4372,4628,4880,5140,5392,4096,4356,4612,4864,5124,5376,5632,5892,6156,6408,8240,8500,8756,9008,9268,9520,8224,8484,8740,8992,9252,9504,9760,10020,10284,10536,12340,12592,12848,13108,13360,13620,12324,12576,12832,13092,13344,13604,13860,14112,14376,14636,16400,16660,16916,17168,17428,17680,16384,16644,16900,17152,17412,17664,17920,18180,18444,18696,20500,20752,21008,21268,21520,21780,20484,20736,20992,21252,21504,21764,22020,22272,22536,22796,24628,24880,25136,25396,25648,25908,24612,24864,25120,25380,25632,25892,26148,26400,26664,26924,28720,28980,29236,29488,29748,3e4,28704,28964,29220,29472,29732,29984,30240,30500,30764,31016,-32624,-32364,-32108,-31856,-31596,-31344,-32640,-32380,-32124,-31872,-31612,-31360,-31104,-30844,-30580,-30328,-28524,-28272,-28016,-27756,-27504,-27244,-28540,-28288,-28032,-27772,-27520,-27260,-27004,-26752,-26488,-26228,85,273,529,789,1041,1301,69,257,513,773,1025,1285,1541,1793,2057,2317,4113,4373,4629,4881,5141,5393,4097,4357,4613,4865,5125,5377,5633,5893,6157,6409,8241,8501,8757,9009,9269,9521,8225,8485,8741,8993,9253,9505,9761,10021,10285,10537,12341,12593,12849,13109,13361,13621,12325,12577,12833,13093,13345,13605,13861,14113,14377,14637,16401,16661,16917,17169,17429,17681,16385,16645,16901,17153,17413,17665,17921,18181,18445,18697,20501,20753,21009,21269,21521,21781,20485,20737,20993,21253,21505,21765,22021,22273,22537,22797,24629,24881,25137,25397,25649,25909,24613,24865,25121,25381,25633,25893,26149,26401,26665,26925,28721,28981,29237,29489,29749,30001,28705,28965,29221,29473,29733,29985,30241,30501,30765,31017,-32623,-32363,-32107,-31855,-31595,-31343,-32639,-32379,-32123,-31871,-31611,-31359,-31103,-30843,-30579,-30327,-28523,-28271,-28015,-27755,-27503,-27243,-28539,-28287,-28031,-27771,-27519,-27259,-27003,-26751,-26487,-26227,-24395,-24143,-23887,-23627,-23375,-23115,-24411,-24159,-23903,-23643,-23391,-23131,-22875,-22623,-22359,-22099,-20303,-20043,-19787,-19535,-19275,-19023,-20319,-20059,-19803,-19551,-19291,-19039,-18783,-18523,-18259,-18007,-16235,-15983,-15727,-15467,-15215,-14955,-16251,-15999,-15743,-15483,-15231,-14971,-14715,-14463,-14199,-13939,-12143,-11883,-11627,-11375,-11115,-10863,-12159,-11899,-11643,-11391,-11131,-10879,-10623,-10363,-10099,-9847,-8015,-7755,-7499,-7247,-6987,-6735,-8031,-7771,-7515,-7263,-7003,-6751,-6495,-6235,-5971,-5719,-3915,-3663,-3407,-3147,-2895,-2635,-3931,-3679,-3423,-3163,-2911,-2651,-2395,-2143,-1879,-1619,85,273,529,789,1041,1301,69,257,513,773,1025,1285,1541,1793,2057,2317,4113,4373,4629,4881,5141,5393,4097,4357,4613,4865,5125,5377,5633,5893,6157,6409,8241,8501,8757,9009,9269,9521,8225,8485,8741,8993,9253,9505,9761,10021,10285,10537,12341,12593,12849,13109,13361,13621,12325,12577,12833,13093,13345,13605,13861,14113,14377,14637,16401,16661,16917,17169,17429,17681,16385,16645,16901,17153,17413,17665,17921,18181,18445,18697,20501,20753,21009,21269,21521,21781,20485,20737,20993,21253,21505,21765,22021,22273,22537,22797,24629,24881,25137,25397,25649,25909,1540,1792,2056,2316,2572,2824,3084,3336,3592,3852,4112,4372,4628,4880,5140,5392,5632,5892,6156,6408,6664,6924,7176,7436,7692,7944,8240,8500,8756,9008,9268,9520,9760,10020,10284,10536,10792,11052,11304,11564,11820,12072,12340,12592,12848,13108,13360,13620,13860,14112,14376,14636,14892,15144,15404,15656,15912,16172,16400,16660,16916,17168,17428,17680,17920,18180,18444,18696,18952,19212,19464,19724,19980,20232,20500,20752,21008,21268,21520,21780,22020,22272,22536,22796,23052,23304,23564,23816,24072,24332,24628,24880,25136,25396,25648,25908,26148,26400,26664,26924,27180,27432,27692,27944,28200,28460,28720,28980,29236,29488,29748,3e4,30240,30500,30764,31016,31272,31532,31784,32044,32300,32552,-32624,-32364,-32108,-31856,-31596,-31344,-31104,-30844,-30580,-30328,-30072,-29812,-29560,-29300,-29044,-28792,-28524,-28272,-28016,-27756,-27504,-27244,-27004,-26752,-26488,-26228,-25972,-25720,-25460,-25208,-24952,-24692,85,273,529,789,1041,1301,1541,1793,2057,2317,2573,2825,3085,3337,3593,3853,4113,4373,4629,4881,5141,5393,5633,5893,6157,6409,6665,6925,7177,7437,7693,7945,8241,8501,8757,9009,9269,9521,9761,10021,10285,10537,10793,11053,11305,11565,11821,12073,12341,12593,12849,13109,13361,13621,13861,14113,14377,14637,14893,15145,15405,15657,15913,16173,16401,16661,16917,17169,17429,17681,17921,18181,18445,18697,18953,19213,19465,19725,19981,20233,20501,20753,21009,21269,21521,21781,22021,22273,22537,22797,23053,23305,23565,23817,24073,24333,24629,24881,25137,25397,25649,25909,26149,26401,26665,26925,27181,27433,27693,27945,28201,28461,28721,28981,29237,29489,29749,30001,30241,30501,30765,31017,31273,31533,31785,32045,32301,32553,-32623,-32363,-32107,-31855,-31595,-31343,-31103,-30843,-30579,-30327,-30071,-29811,-29559,-29299,-29043,-28791,-28523,-28271,-28015,-27755,-27503,-27243,-27003,-26751,-26487,-26227,-25971,-25719,-25459,-25207,-24951,-24691,-24395,-24143,-23887,-23627,-23375,-23115,-22875,-22623,-22359,-22099,-21843,-21591,-21331,-21079,-20823,-20563,-20303,-20043,-19787,-19535,-19275,-19023,-18783,-18523,-18259,-18007,-17751,-17491,-17239,-16979,-16723,-16471,-16235,-15983,-15727,-15467,-15215,-14955,-14715,-14463,-14199,-13939,-13683,-13431,-13171,-12919,-12663,-12403,-12143,-11883,-11627,-11375,-11115,-10863,-10623,-10363,-10099,-9847,-9591,-9331,-9079,-8819,-8563,-8311,-8015,-7755,-7499,-7247,-6987,-6735,-6495,-6235,-5971,-5719,-5463,-5203,-4951,-4691,-4435,-4183,-3915,-3663,-3407,-3147,-2895,-2635,-2395,-2143,-1879,-1619,-1363,-1111,-851,-599,-343,-83,85,273,529,789,1041,1301,1541,1793,2057,2317,2573,2825,3085,3337,3593,3853,4113,4373,4629,4881,5141,5393,5633,5893,6157,6409,6665,6925,7177,7437,7693,7945,8241,8501,8757,9009,9269,9521,9761,10021,10285,10537,10793,11053,11305,11565,11821,12073,12341,12593,12849,13109,13361,13621,13861,14113,14377,14637,14893,15145,15405,15657,15913,16173,16401,16661,16917,17169,17429,17681,17921,18181,18445,18697,18953,19213,19465,19725,19981,20233,20501,20753,21009,21269,21521,21781,22021,22273,22537,22797,23053,23305,23565,23817,24073,24333,24629,24881,25137,25397,25649,25909,70,258,514,774,1026,1286,1542,1794,2058,2318,1026,1286,1542,1794,2058,2318,4098,4358,4614,4866,5126,5378,5634,5894,6158,6410,5126,5378,5634,5894,6158,6410,8226,8486,8742,8994,9254,9506,9762,10022,10286,10538,9254,9506,9762,10022,10286,10538,12326,12578,12834,13094,13346,13606,13862,14114,14378,14638,13346,13606,13862,14114,14378,14638,16386,16646,16902,17154,17414,17666,17922,18182,18446,18698,17414,17666,17922,18182,18446,18698,20486,20738,20994,21254,21506,21766,22022,22274,22538,22798,21506,21766,22022,22274,22538,22798,24614,24866,25122,25382,25634,25894,26150,26402,26666,26926,25634,25894,26150,26402,26666,26926,28706,28966,29222,29474,29734,29986,30242,30502,30766,31018,29734,29986,30242,30502,30766,31018,-32638,-32378,-32122,-31870,-31610,-31358,-31102,-30842,-30578,-30326,-31610,-31358,-31102,-30842,-30578,-30326,-28538,-28286,-28030,-27770,-27518,-27258,-27002,-26750,-26486,-26226,13347,13607,13863,14115,14379,14639,16387,16647,16903,17155,17415,17667,17923,18183,18447,18699,17415,17667,17923,18183,18447,18699,20487,20739,20995,21255,21507,21767,22023,22275,22539,22799,21507,21767,22023,22275,22539,22799,24615,24867,25123,25383,25635,25895,26151,26403,26667,26927,25635,25895,26151,26403,26667,26927,28707,28967,29223,29475,29735,29987,30243,30503,30767,31019,29735,29987,30243,30503,30767,31019,-32637,-32377,-32121,-31869,-31609,-31357,-31101,-30841,-30577,-30325,-31609,-31357,-31101,-30841,-30577,-30325,-28537,-28285,-28029,-27769,-27517,-27257,-27001,-26749,-26485,-26225,-27517,-27257,-27001,-26749,-26485,-26225,-24409,-24157,-23901,-23641,-23389,-23129,-22873,-22621,-22357,-22097,-23389,-23129,-22873,-22621,-22357,-22097,-20317,-20057,-19801,-19549,-19289,-19037,-18781,-18521,-18257,-18005,-19289,-19037,-18781,-18521,-18257,-18005,-16249,-15997,-15741,-15481,-15229,-14969,-14713,-14461,-14197,-13937,-15229,-14969,-14713,-14461,-14197,-13937,-12157,-11897,-11641,-11389,-11129,-10877,-10621,-10361,-10097,-9845,-11129,-10877,-10621,-10361,-10097,-9845,-8029,-7769,-7513,-7261,-7001,-6749,-6493,-6233,-5969,-5717,-7001,-6749,-6493,-6233,-5969,-5717,-3929,-3677,-3421,-3161,-2909,-2649,-2393,-2141,-1877,-1617,-2909,-2649,-2393,-2141,-1877,-1617,71,259,515,775,1027,1287,1543,1795,2059,2319,1027,1287,1543,1795,2059,2319,4099,4359,4615,4867,5127,5379,5635,5895,6159,6411,5127,5379,5635,5895,6159,6411,8227,8487,8743,8995,9255,9507,9763,10023,10287,10539,9255,9507,9763,10023,10287,10539,12327,12579,12835,13095,13347,13607,13863,14115,14379,14639,13347,13607,13863,14115,14379,14639,16387,16647,16903,17155,17415,17667,17923,18183,18447,18699,17415,17667,17923,18183,18447,18699,20487,20739,20995,21255,21507,21767,22023,22275,22539,22799,21507,21767,22023,22275,22539,22799,24615,24867,25123,25383,25635,25895,26151,26403,26667,26927,25635,25895,26151,26403,26667,26927,28707,28967,29223,29475,29735,29987,30243,30503,30767,31019,29735,29987,30243,30503,30767,31019,-32637,-32377,-32121,-31869,-31609,-31357,-31101,-30841,-30577,-30325,-31609,-31357,-31101,-30841,-30577,-30325,-28537,-28285,-28029,-27769,-27517,-27257,-27001,-26749,-26485,-26225,-27517,-27257,-27001,-26749,-26485,-26225,-1346,-1094,-834,-582,-326,-66,70,258,514,774,1026,1286,1542,1794,2058,2318,2590,2842,3102,3354,3610,3870,4098,4358,4614,4866,5126,5378,5634,5894,6158,6410,6682,6942,7194,7454,7710,7962,8226,8486,8742,8994,9254,9506,9762,10022,10286,10538,10810,11070,11322,11582,11838,12090,12326,12578,12834,13094,13346,13606,13862,14114,14378,14638,14910,15162,15422,15674,15930,16190,16386,16646,16902,17154,17414,17666,17922,18182,18446,18698,18970,19230,19482,19742,19998,20250,20486,20738,20994,21254,21506,21766,22022,22274,22538,22798,23070,23322,23582,23834,24090,24350,24614,24866,25122,25382,25634,25894,26150,26402,26666,26926,27198,27450,27710,27962,28218,28478,28706,28966,29222,29474,29734,29986,30242,30502,30766,31018,31290,31550,31802,32062,32318,32570,-32638,-32378,-32122,-31870,-31610,-31358,-31102,-30842,-30578,-30326,-30054,-29794,-29542,-29282,-29026,-28774,-28538,-28286,-28030,-27770,13347,13607,13863,14115,14379,14639,14911,15163,15423,15675,15931,16191,16387,16647,16903,17155,17415,17667,17923,18183,18447,18699,18971,19231,19483,19743,19999,20251,20487,20739,20995,21255,21507,21767,22023,22275,22539,22799,23071,23323,23583,23835,24091,24351,24615,24867,25123,25383,25635,25895,26151,26403,26667,26927,27199,27451,27711,27963,28219,28479,28707,28967,29223,29475,29735,29987,30243,30503,30767,31019,31291,31551,31803,32063,32319,32571,-32637,-32377,-32121,-31869,-31609,-31357,-31101,-30841,-30577,-30325,-30053,-29793,-29541,-29281,-29025,-28773,-28537,-28285,-28029,-27769,-27517,-27257,-27001,-26749,-26485,-26225,-25953,-25701,-25441,-25189,-24933,-24673,-24409,-24157,-23901,-23641,-23389,-23129,-22873,-22621,-22357,-22097,-21825,-21573,-21313,-21061,-20805,-20545,-20317,-20057,-19801,-19549,-19289,-19037,-18781,-18521,-18257,-18005,-17733,-17473,-17221,-16961,-16705,-16453,-16249,-15997,-15741,-15481,-15229,-14969,-14713,-14461,-14197,-13937,-13665,-13413,-13153,-12901,-12645,-12385,-12157,-11897,-11641,-11389,-11129,-10877,-10621,-10361,-10097,-9845,-9573,-9313,-9061,-8801,-8545,-8293,-8029,-7769,-7513,-7261,-7001,-6749,-6493,-6233,-5969,-5717,-5445,-5185,-4933,-4673,-4417,-4165,-3929,-3677,-3421,-3161,-2909,-2649,-2393,-2141,-1877,-1617,-1345,-1093,-833,-581,-325,-65,71,259,515,775,1027,1287,1543,1795,2059,2319,2591,2843,3103,3355,3611,3871,4099,4359,4615,4867,5127,5379,5635,5895,6159,6411,6683,6943,7195,7455,7711,7963,8227,8487,8743,8995,9255,9507,9763,10023,10287,10539,10811,11071,11323,11583,11839,12091,12327,12579,12835,13095,13347,13607,13863,14115,14379,14639,14911,15163,15423,15675,15931,16191,16387,16647,16903,17155,17415,17667,17923,18183,18447,18699,18971,19231,19483,19743,19999,20251,20487,20739,20995,21255,21507,21767,22023,22275,22539,22799,23071,23323,23583,23835,24091,24351,24615,24867,25123,25383,25635,25895,26151,26403,26667,26927,27199,27451,27711,27963,28219,28479,28707,28967,29223,29475,29735,29987,30243,30503,30767,31019,31291,31551,31803,32063,32319,32571,-32637,-32377,-32121,-31869,-31609,-31357,-31101,-30841,-30577,-30325,-30053,-29793,-29541,-29281,-29025,-28773,-28537,-28285,-28029,-27769,-27517,-27257,-27001,-26749,-26485,-26225],t.exports=i},{"../lib/number-util":27,"./bin-util":8}],15:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./mz700-cg"));class o{constructor(e){this.addr=0,this.pattern=0,this.we=0,this.ssw=1,this.copy=0,this._screen=e;const t=[];for(let e=0;e<512;e++){t.push([0,0,0,0,0,0,0,0]);for(let c=0;c<8;c++)t[e][c]=s.default.ROM[e][c]}this._cg=new s.default(t,8,8)}setPattern(e){this.pattern=255&e}setAddrLo(e){this.addr=1792&this.addr|(255&e)<<0}setAddrHi(e){this.addr=255&this.addr|(e&o.ADDR)<<8}setCopy(e){this.copy=0===e?0:1}setWE(e){const t=this.we;this.we=0===e?0:1,t&&!this.we&&this.write()}setSSW(e){const t=this.ssw;this.ssw=0===e?0:1,t!==this.ssw&&this.applySSW()}applySSW(){0===this.ssw?(this._screen.changeCG(this._cg),this._screen.redraw()):(this._screen.restoreCG(),this._screen.redraw())}write(){const e=this.addr>>10&1,t=128+(this.addr>>3&127),c=256*e+t,n=this.addr>>0&7,o=0===this.copy?this.pattern:s.default.ROM[c][n];this._cg.setPattern(e,t,n,o),0===this.ssw&&this._screen.redrawChar(e,t)}}c.default=o,o.COPY=32,o.WE=16,o.SSW=8,o.ADDR=7,t.exports=o},{"./mz700-cg":25}],16:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.default=class{constructor(){this._handlers={},this._handlers={}}declareEvent(e){this._handlers[e]=[]}addEventListener(e,t){this._handlers[e].push(t)}fireEvent(e){this._handlers[e].forEach(e=>e())}}},{}],17:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./event-dispatcher"));class o extends s.default{constructor(e){super(),this.declareEvent("change"),this.initialize(),this._counterMax=e}initialize(){this._out=!1,this._counter=0}readOutput(){return this._out}count(){return this._counter++,this._counter>=this._counterMax/2&&(this._out=!this._out,this._counter=0,this.fireEvent("change"),!0)}}c.default=o,t.exports=o},{"./event-dispatcher":16}],18:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("../lib/flip-flop-counter"));class o extends s.default{constructor(e){super(e),this._reset=!1}count(){return!!this._reset&&s.default.prototype.count.call(this)}loadReset(e){e?this._reset||(this._reset=!0):this._reset&&(this._reset=!1,this.initialize())}}c.default=o,t.exports=o},{"../lib/flip-flop-counter":17}],19:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./event-dispatcher"));class o{constructor(){this._counter=[new i,new i,new i]}setCtrlWord(e){const t=(192&e)>>6;this._counter[t].setCtrlWord(63&e)}counter(e){return this._counter[e]}}c.default=o;class i extends s.default{constructor(){super(),this.counter=65535,this._written=!0,this._read=!0,this.out=!0,this.gate=!1,this.declareEvent("timeup"),this.RL=3,this.MODE=3,this.BCD=0,this.value=65535,this.counter=65535,this._written=!0,this._read=!0,this.out=!0,this.gate=!1}setCtrlWord(e){this.RL=(48&e)>>4,this.MODE=(14&e)>>1,this.BCD=0!=(1&e)?1:0,this.value=0,this.counter=0,this._written=!0,this._read=!0,this.out=!1,this.gate=!1}initCount(e,t){this.value=e,this.counter=e,this.addEventListener("timeup",t)}load(e){this.counter=0;let t=!1;switch(this.RL){case 0:break;case 1:this.value=255&e,this.counter=this.value,this.out=!1,t=!0;break;case 2:this.value=(255&e)<<8,this.counter=this.value,t=!0;break;case 3:this._written?(this._written=!1,this.value=65280&this.value|255&e,this.counter=this.value,t=!1):(this._written=!0,this.value=255&this.value|(255&e)<<8,this.counter=this.value,this.out=!1,t=!0)}if(t)switch(this.MODE){case 0:this.out=!1;break;case 1:break;case 2:case 6:this.out=!0;break;case 3:case 7:this.out=!0}return t}read(){switch(this.RL){case 0:break;case 1:return 255&this.counter;case 2:return this.counter>>8&255;case 3:return this._read?(this._read=!1,255&this.counter):(this._read=!0,this.counter>>8&255)}return null}setGate(e){this.gate=e}count(e){const t=this.out;switch(this.MODE){case 0:this.counter>0?(this.counter-=e,this.counter<=0&&(this.counter=0,this.out||(this.out=!0))):this.counter=this.value;break;case 1:break;case 2:case 6:this.counter-=e,this.out&&this.counter<=0?(this.out=!1,this.counter=this.value):this.out||(this.out=!0);break;case 3:case 7:this.counter-=e,this.counter>=this.value/2?this.out=!0:this.counter>0?this.out=!1:(this.out=!0,this.counter=this.value)}!t&&this.out&&this.fireEvent("timeup")}}t.exports=o},{"./event-dispatcher":16}],20:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});class n{constructor(e){this._mOn=!1,this._play=!1,this._rec=!1,this._motor=!1,this._wdata=null,this._twdata=null,this._rbit=null,this._trdata=null,this._cmt=null,this._pos=0,this._motorCallback=null,this._readTopBlank=0,this._motorCallback=e}isCmtSet(){return null!=this._cmt}getCmt(){return this._cmt}setCmt(e){this.motor()&&this.stop(),this._cmt=e,this._pos=0,this._twdata=null,this._rbit=null,this._trdata=null,this._readTopBlank=0}play(){const e=this.motor();null!=this._cmt&&(this._play=!0),!e&&this.motor()&&this._motorCallback(!0)}rec(){const e=this.motor();null!=this._cmt&&(this._play=!0,this._rec=!0),!e&&this.motor()&&this._motorCallback(!0)}stop(){const e=this.motor();this._play=!1,this._rec=!1,e&&!this.motor()&&this._motorCallback(!1)}ejectCmt(){this.stop();const e=this._cmt;return this._cmt=null,this._pos=0,this._twdata=null,this._rbit=null,this._trdata=null,this._readTopBlank=0,e}m_on(e){const t=this.motor();!this._mOn&&e&&(this._motor=!this._motor),this._mOn=e,!t&&this.motor()&&this._motorCallback(!0),t&&!this.motor()&&this._motorCallback(!1)}motor(){return null!=this._cmt&&this._play&&this._motor}wdata(e,t){if(this.motor()&&this._rec&&this._wdata!==e)if(this._wdata=e,e)this._twdata=t;else{null==this._twdata&&(this._twdata=t);const e=t-this._twdata>1400;this._pos<this._cmt.length?(this._cmt[this._pos]=e,this._pos++):(this._cmt.push(e),this._pos=this._cmt.length)}}rdata(e){if(this.motor()&&this._pos<this._cmt.length){if(0===this._pos&&this._readTopBlank<n.RDATA_TOP_BLANK_LEN)return++this._readTopBlank,!1;if(this._pos>=this._cmt.length)return console.log("MZ_DataRecorder stopped at the end of CMT."),this.stop(),!1;null==this._rbit&&(this._rbit=this._cmt[this._pos],this._pos++,this._trdata=e);const t=this._rbit?n.RDATA_CYCLE_HI_LONG:n.RDATA_CYCLE_HI_SHORT,c=e-this._trdata;return c>=t+n.RDATA_CYCLE_LO&&(this._rbit=null),c<t}return null}}c.default=n,n.RDATA_TOP_BLANK_LEN=1,n.RDATA_CYCLE_HI_LONG=1500,n.RDATA_CYCLE_HI_SHORT=700,n.RDATA_CYCLE_LO=700,t.exports=n},{}],21:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});class n{constructor(){this._map=[];for(let e=57344;e<59392;e++)this._map.push({r:e=>e,w:e=>e})}onRead(e,t){this._map[e-57344].r=t}onWrite(e,t){this._map[e-57344].w=t}read(e,t){return this._map[e-57344].r(t)}write(e,t){this._map[e-57344].w(t)}}c.default=n,t.exports=n},{}],22:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./number-util")),{HEX:o}=s.default;class i{constructor(e,t){const c=(e,t)=>(255&e[t])+256*(255&e[t+1]);this.attr=((e,t)=>255&e[t])(e,t+0);const n=((e,t,c)=>{let n="";for(let s=t;s<c&&13!==e[s];s++)0!==e[s]&&(n+=String.fromCharCode(e[s]));return n})(e,t+1,t+18);this.filename=n,this.fileSize=c(e,t+18),this.addrLoad=c(e,t+20),this.addrExec=c(e,t+22);const s=[];for(let c=0;c<128;c++)s.push(e[t+c]);this.buffer=s}setFilename(e){let t;for(e.length>16&&(e=e.substr(0,16)),this.filename=e,t=0;t<=16;t++)this.buffer[1+t]=0;for(e+="\r",t=0;t<e.length;t++)this.buffer[1+t]=255&e.charCodeAt(t)}setFilesize(e){this.fileSize=e,this.buffer[18]=e>>0&255,this.buffer[19]=e>>8&255}setAddrLoad(e){this.addrLoad=e,this.buffer[20]=e>>0&255,this.buffer[21]=e>>8&255}setAddrExec(e){this.addrExec=e,this.buffer[22]=e>>0&255,this.buffer[23]=e>>8&255}getHeadline(){return[";======================================================","; attribute :   "+o(this.attr,2)+"H","; filename  :   '"+this.filename+"'","; filesize  :   "+this.fileSize+" bytes","; load addr :   "+o(this.addrLoad,4)+"H","; start addr:   "+o(this.addrExec,4)+"H",";======================================================"].join("\n")}static get1stFilename(e){return e&&Array.isArray(e)&&e.length>0?e[0].header.filename:null}static createNew(){const e=new Array(128);for(let t=0;t<128;t++)e[t]=0;return e[0]=1,new i(e,0)}}c.default=i,t.exports=i},{"./number-util":27}],23:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./mz-tape-header")),o=n(e("./number-util")),{HEX:i}=o.default;class r{constructor(e){this._index=0,this._tapeData=e}isThereSignal(e,t){for(let c=0;c<t;c++)if(this._tapeData[this._index+c]!==e)return!1;return this._index+=t,!0}recognizeStartingMark(){return!!this.isThereSignal(!1,11e3)&&(!!this.isThereSignal(!0,40)&&(!!this.isThereSignal(!1,40)&&!!this.isThereSignal(!0,1)))}recognizeStarting2Mark(){return!!this.isThereSignal(!1,2750)&&(!!this.isThereSignal(!0,20)&&(!!this.isThereSignal(!1,20)&&!!this.isThereSignal(!0,1)))}readSignal(){return this._index<this._tapeData.length?this._tapeData[this._index++]:null}writeSignal(e){this._tapeData.push(e)}writeByte(e){this.writeSignal(!0);for(let t=0;t<8;t++)0!=(e&1<<7-t)?this.writeSignal(!0):this.writeSignal(!1)}writeBlock(e){e.forEach(function(e){this.writeByte(e)},this);const t=this.countOnBit(e);this.writeByte(t>>8&255),this.writeByte(t>>0&255),this.writeSignal(!0)}writeDuplexBlock(e){this.writeBlock(e);for(let e=0;e<256;e++)this.writeSignal(!1);this.writeBlock(e)}readByte(){let e=null;do{if(null==(e=this.readSignal()))return null;if(!e)throw"NO START BIT"}while(!e);let t=0;for(let e=0;e<8;e++){const c=this.readSignal();if(null==c)return null;c&&(t|=1<<7-e)}return t}readBytes(e){const t=[];for(let c=0;c<e;c++){const e=this.readByte();if(null==e)break;t.push(e)}return t}countOnBit(e){let t=0;const c=[0,1,2,3,4,5,6,7];return e.forEach(e=>{c.forEach(c=>{0!=(e&1<<c)&&t++})}),t&=65535}readBlock(e){const t=this.readBytes(e),c=this.readBytes(2);if(2!==c.length)throw"NO BLOCK CHECKSUM";const n=256*c[0]+c[1];if(!this.isThereSignal(!0,1))throw"NO BLOCK END BIT";if(this.countOnBit(t)!==n)throw"CHECKSUM ERROR";return t}readDuplexBlocks(e){const t=this.readBlock(e);if(null==t)throw"FAIL TO READ BLOCK[1]";if(!this.isThereSignal(!1,256))throw"NO DELIMITOR: Short x 256.";const c=this.readBlock(e);if(null==c)throw"FAIL TO READ BLOCK[2]";for(let e=0;e<t.length;e++)if(t[e]!==c[e])throw"FAIL TO VERIFY BLOCK 1 and 2";return t}readHeader(){if(!this.recognizeStartingMark())throw"NO STARTING MARK recognized";const e=this.readDuplexBlocks(128);if(null==e)throw"CANNOT READ MZT HEADER";return new s.default(e,0)}readDataBlock(e){if(!this.recognizeStarting2Mark())throw"NO STARTING MARK 2 recognized";return this.readDuplexBlocks(e)}outputStartingMark(){let e;for(e=0;e<11e3;e++)this.writeSignal(!1);for(e=0;e<40;e++)this.writeSignal(!0);for(e=0;e<40;e++)this.writeSignal(!1);this.writeSignal(!0)}writeHeader(e){this.outputStartingMark(),this.writeDuplexBlock(e)}writeStarting2Mark(){let e;for(e=0;e<2750;e++)this.writeSignal(!1);for(e=0;e<20;e++)this.writeSignal(!0);for(e=0;e<20;e++)this.writeSignal(!1);this.writeSignal(!0)}writeDataBlock(e){this.writeStarting2Mark(),this.writeDuplexBlock(e)}static toBytes(e){try{const t=new r(e),c=t.readHeader();if(null==c)throw"FAIL TO READ HEADER";const n=t.readDataBlock(c.fileSize);if(null==n)throw"FAIL TO READ DATA";const s=[];let o,a=!0;for(;a;)(a=!!(o=t.readByte()))&&(console.warn("MZ_Tape.toBytes rest bytes["+o.length+"] =",i(o,2)),s.push(o));return c.buffer.concat(n)}catch(e){console.log("MZ_Tape.toBytes:Error "+e)}return[]}static fromBytes(e){if(e.length<128)throw"FAIL TO WRITE HEADER";const t=new s.default(e.slice(0,128),0),c=new r([]);return c.writeHeader(t.buffer),c.writeDataBlock(e.slice(128)),c._tapeData}static parseMZT(e){const t=[];let c=0;for(;c+128<=e.length;){const n=new s.default(e,c);if((c+=128)+n.fileSize>e.length)return null;const o=[];for(let t=0;t<n.fileSize;t++)o.push(e[c+t]);c+=n.fileSize,t.push({header:n,body:{buffer:o}})}return t}}c.default=r,t.exports=r},{"./mz-tape-header":22,"./number-util":27}],24:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("./mz700-cg"));class o{constructor(){this._ctx=null,this.opt={canvas:null,cols:o.size.cols,rows:o.size.rows,CG:null,color:o.colors.white,backgroundColor:o.colors.blue},this.vramText=[],this.vramAttr=[]}create(e){e=e||{},Object.keys(this.opt).forEach(t=>{t in e&&(this.opt[t]=e[t])}),this._canvas=this.opt.canvas,null==this.opt.CG&&(this.opt.CG=new s.default(s.default.ROM,8,8)),this._font=this.opt.CG,this.vramText=[],this.vramAttr=[];for(let e=0;e<this.opt.cols*this.opt.rows;e++)this.vramText.push(0),this.vramAttr.push(113);this.idxloc=((e,t,c)=>{for(let n=0;n<c;n++)for(let c=0;c<t;c++)e.push({x:o.charSize.dotWidth*c,y:o.charSize.dotHeight*n});return e})([],this.opt.cols,this.opt.rows)}setupRendering(){this._ctx=this._canvas.getContext("2d"),this._ctx.imageSmoothingEnabled=!0}redrawChar(e,t){const c=e<<7,n=this.opt.cols*this.opt.rows;for(let e=0;e<n;e++){const n=this.vramAttr[e];this.vramText[e]===t&&(128&n)===c&&this.writeVram(e,n,t)}}writeVram(e,t,c){this._writeVram(e,t,c),this.vramText[e]=c,this.vramAttr[e]=t}_writeVram(e,t,c){const n=this.idxloc[e];this._ctx&&this._ctx.putImageData(this._font.get(t,c).getImageData(),n.x,n.y)}redraw(){const e=this.opt.cols*this.opt.rows;for(let t=0;t<e;t++)this._writeVram(t,this.vramAttr[t],this.vramText[t])}getImageData(){return this._ctx.getImageData(0,0,320,200)}changeCG(e){this._font=e}restoreCG(){this._font=this.opt.CG}clear(){const e=this.opt.rows*this.opt.cols,t=o.str2chars(" ");for(let c=0;c<e;c++)this.putChars(t,c,0)}puts(e,t,c){const n=o.str2chars(e);return this.putChars(n,t,c)}putChars(e,t,c){const n=this.opt.rows*this.opt.cols,s=this.opt.color<<4|this.opt.backgroundColor;let i=0,r=c*this.opt.cols+t;return e.forEach(function(e){if(r<n){const t=o.char2dispcode(e);this.writeVram(r,t.attr<<7|s,t.dispcode),r++,i++}},this),i}static char2dispcode(e){const t=o.MapChar2DispCode[e];return t||{attr:0,dispcode:239}}static str2chars(e){const t=[];let c=!1,n="";return e.split("").forEach(e=>{c?";"===e?(t.push(n.toUpperCase()),c=!1,n=""):n+=e:"&"===e?(c=!0,n=""):t.push(e)}),t}}c.default=o,o.colors={black:0,blue:1,red:2,magenta:3,green:4,cyan:5,yellow:6,white:7},o.size={cols:40,rows:25},o.charSize={dotWidth:8,dotHeight:8},o.TableDispCode2Char=[[[" ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O"],["P","Q","R","S","T","U","V","W","X","Y","Z","┼","└","┘","├","┴"],["0","1","2","3","4","5","6","7","8","9","-","=",";","/",".",","],["","","","","","","","","","","","","","","",""],["→","SPADE","","","DIA","←","CLUB","●","○","?","●反転","","","","","",":"],["↑","<","[","HEART","]","@","",">","","BACKSLASH","HATCH","","","","",""],["π","!",'"',"#","$","%","AMP","'","(",")","+","*","","","",""],["","","","","","","","","","","","","","","",""],["↓","チ","コ","ソ","シ","イ","ハ","キ","ク","ニ","マ","ノ","リ","モ","ミ","ラ"],["セ","タ","ス","ト","カ","ナ","ヒ","テ","サ","ン","ツ","ロ","ケ","「","ァ","ャ"],["ワ","ヌ","フ","ア","ウ","エ","オ","ヤ","ユ","ヨ","ホ","ヘ","レ","メ","ル","ネ"],["ム","」","ィ","ュ","ヲ","、","ゥ","ョ","゜","・","ェ","ッ","゛","。","ォ","ー"],["PUSHDOWN","~DOWN","~UP","~RIGHT","~LEFT","~HOME","~CLEAR","UFO","CARRIGHT","CARUP","HUMAN","LHUMAN","RHUMAN","DHUMAN","FILLEDFACE","FACE"],["日","月","火","水","木","金","土","生","年","時","分","秒","円","￥","￡","蛇"],[" ","","","","","","","","","","","","","","",""],[" ","","","","","","","","","","","","","","",""]],[[" ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o"],["p","q","r","s","t","u","v","w","x","y","z","","","","",""],["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""],["","ち","こ","そ","し","い","は","き","く","に","ま","の","り","も","み","ら"],["せ","た","す","と","か","な","ひ","て","さ","ん","つ","ろ","け","","ぁ","ゃ"],["わ","ぬ","ふ","あ","う","え","お","や","ゆ","よ","ほ","へ","れ","め","る","ね"],["む","","ぃ","ゅ","を","","ぅ","ょ","","","ぇ","っ","","","ぉ",""],["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","",""]]],o.MapChar2DispCode={},o.initializer=void o.TableDispCode2Char.forEach((e,t)=>{e.forEach((e,c)=>{e.forEach((e,n)=>{e in o.MapChar2DispCode||(o.MapChar2DispCode[e]={attr:t,dispcode:c<<4|n})})})}),t.exports=o},{"./mz700-cg":25}],25:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});const n=Function("return this")();n.ImageData||(n.ImageData=e("canvas").ImageData);class s{constructor(e,t,c){this._fontTable=null,this._fontTable=null,this._patternBuffer=e,this._width=t,this._height=c,this.createFontTable()}createFontTable(){this._fontTable=new Array(65536);for(let e=0;e<2;e++)for(let t=0;t<256;t++)this.initFont(e,t);for(let e=0;e<65536;e++)this._fontTable[e]||console.warn(`mz700cg._fontTable[0x${e.toString(16)}] is null`)}initFont(e,t){const c=this._patternBuffer[256*e+t];for(let n=0;n<8;n++)for(let i=0;i<8;i++){const r=e<<7|i<<4|n,a=s.tableIndex(0|r,t),l=s.tableIndex(8|r,t),d=new o(c,s.Colors[i],s.Colors[n],this._width,this._height);this._fontTable[a]=d,this._fontTable[l]=d}}setPattern(e,t,c,n){const s=256*e+t;this._patternBuffer[s][c]=n,this.initFont(e,t)}get(e,t){return this._fontTable[s.tableIndex(e,t)]}static tableIndex(e,t){return e<<8|t}}c.default=s,s.Colors=[{R:0,G:0,B:0,A:255},{R:0,G:0,B:255,A:255},{R:255,G:0,B:0,A:255},{R:255,G:0,B:255,A:255},{R:0,G:255,B:0,A:255},{R:0,G:255,B:255,A:255},{R:255,G:255,B:0,A:255},{R:255,G:255,B:255,A:255}],s.ROM=[[0,0,0,0,0,0,0,0],[24,36,66,126,66,66,66,0],[124,34,34,60,34,34,124,0],[28,34,64,64,64,34,28,0],[120,36,34,34,34,36,120,0],[126,64,64,120,64,64,126,0],[126,64,64,120,64,64,64,0],[28,34,64,78,66,34,28,0],[66,66,66,126,66,66,66,0],[28,8,8,8,8,8,28,0],[14,4,4,4,4,68,56,0],[66,68,72,112,72,68,66,0],[64,64,64,64,64,64,126,0],[66,102,90,90,66,66,66,0],[66,98,82,74,70,66,66,0],[24,36,66,66,66,36,24,0],[124,66,66,124,64,64,64,0],[24,36,66,66,74,36,26,0],[124,66,66,124,72,68,66,0],[60,66,64,60,2,66,60,0],[62,8,8,8,8,8,8,0],[66,66,66,66,66,66,60,0],[66,66,66,36,36,24,24,0],[66,66,66,90,90,102,66,0],[66,66,36,24,36,66,66,0],[34,34,34,28,8,8,8,0],[126,2,4,24,32,64,126,0],[8,8,8,8,255,8,8,8],[8,8,8,8,15,0,0,0],[8,8,8,8,248,0,0,0],[8,8,8,8,15,8,8,8],[8,8,8,8,255,0,0,0],[60,66,70,90,98,66,60,0],[8,24,40,8,8,8,62,0],[60,66,2,12,48,64,126,0],[60,66,2,60,2,66,60,0],[4,12,20,36,126,4,4,0],[126,64,120,4,2,68,56,0],[28,32,64,124,66,66,60,0],[126,66,4,8,16,16,16,0],[60,66,66,60,66,66,60,0],[60,66,66,62,2,4,56,0],[0,0,0,126,0,0,0,0],[0,0,126,0,126,0,0,0],[0,0,8,0,0,8,8,16],[0,2,4,8,16,32,64,0],[0,0,0,0,0,24,24,0],[0,0,0,0,0,8,8,16],[0,255,0,0,0,0,0,0],[64,64,64,64,64,64,64,64],[128,128,128,128,128,128,128,255],[1,1,1,1,1,1,1,255],[0,0,0,255,0,0,0,0],[16,16,16,16,16,16,16,16],[255,255,0,0,0,0,0,0],[192,192,192,192,192,192,192,192],[0,0,0,0,0,255,0,0],[4,4,4,4,4,4,4,4],[0,0,0,0,255,255,255,255],[15,15,15,15,15,15,15,15],[0,0,0,0,0,0,0,255],[1,1,1,1,1,1,1,1],[0,0,0,0,0,0,255,255],[3,3,3,3,3,3,3,3],[0,0,8,4,254,4,8,0],[8,28,62,127,127,28,62,0],[255,127,63,31,15,7,3,1],[255,255,255,255,255,255,255,255],[8,28,62,127,62,28,8,0],[0,0,16,32,127,32,16,0],[8,28,42,127,42,8,8,0],[0,60,126,126,126,126,60,0],[0,60,66,66,66,66,60,0],[60,66,2,12,16,0,16,0],[255,195,129,129,129,129,195,255],[0,0,0,0,3,4,8,8],[0,0,0,0,192,32,16,16],[128,192,224,240,248,252,254,255],[1,3,7,15,31,63,127,255],[0,0,8,0,0,8,0,0],[0,8,28,42,8,8,8,0],[14,24,48,96,48,24,14,0],[60,32,32,32,32,32,60,0],[54,127,127,127,62,28,8,0],[60,4,4,4,4,4,60,0],[28,34,74,86,76,32,30,0],[255,254,252,248,240,224,192,128],[112,24,12,6,12,24,112,0],[160,80,160,80,160,80,160,80],[0,64,32,16,8,4,2,0],[170,85,170,85,170,85,170,85],[240,240,240,240,15,15,15,15],[0,0,0,0,15,8,8,8],[0,0,0,0,248,8,8,8],[8,8,8,8,248,8,8,8],[0,0,0,0,255,8,8,8],[0,0,1,62,84,20,20,0],[8,8,8,8,0,0,8,0],[36,36,36,0,0,0,0,0],[36,36,126,36,126,36,36,0],[8,30,40,28,10,60,8,0],[0,98,100,8,16,38,70,0],[48,72,72,48,74,68,58,0],[4,8,16,0,0,0,0,0],[4,8,16,16,16,8,4,0],[32,16,8,8,8,16,32,0],[0,8,8,62,8,8,0,0],[8,42,28,62,28,42,8,0],[15,15,15,15,240,240,240,240],[129,66,36,24,24,36,66,129],[16,16,32,192,0,0,0,0],[8,8,4,3,0,0,0,0],[255,0,0,0,0,0,0,0],[128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128],[255,1,1,1,1,1,1,1],[0,0,255,0,0,0,0,0],[32,32,32,32,32,32,32,32],[1,2,4,8,16,32,64,128],[128,64,32,16,8,4,2,1],[0,0,0,0,255,0,0,0],[8,8,8,8,8,8,8,8],[255,255,255,255,0,0,0,0],[240,240,240,240,240,240,240,240],[0,0,0,0,0,0,255,0],[2,2,2,2,2,2,2,2],[0,0,0,0,0,255,255,255],[7,7,7,7,7,7,7,7],[0,8,8,8,42,28,8,0],[4,56,8,62,8,8,16,0],[0,62,2,2,2,2,62,0],[0,34,34,18,2,4,24,0],[0,48,2,50,2,4,56,0],[2,4,8,24,40,8,8,0],[0,8,4,34,34,34,34,0],[8,62,8,62,8,8,8,0],[0,30,18,34,2,4,24,0],[0,28,0,0,0,0,62,0],[0,62,2,2,20,8,4,0],[4,4,4,4,4,8,16,0],[36,36,36,36,4,8,16,0],[0,62,16,62,16,16,14,0],[0,28,0,28,0,60,2,0],[28,0,62,2,2,4,8,0],[16,62,18,20,16,16,14,0],[0,30,18,42,6,4,24,0],[0,62,2,4,8,20,34,0],[16,16,16,24,20,16,16,0],[16,62,18,18,18,18,36,0],[8,8,62,8,8,16,32,0],[32,32,62,32,32,32,30,0],[28,0,62,8,8,8,16,0],[20,62,20,20,4,8,16,0],[0,48,0,2,2,4,56,0],[0,42,42,42,2,4,8,0],[0,62,34,34,34,34,62,0],[16,30,36,4,4,4,8,0],[30,16,16,16,0,0,0,0],[0,0,62,2,12,8,16,0],[0,0,16,62,18,20,16,0],[0,62,34,34,2,4,8,0],[0,62,2,20,8,20,32,0],[0,62,2,2,2,4,24,0],[62,2,10,12,8,8,16,0],[8,62,34,34,2,4,8,0],[0,62,8,8,8,8,62,0],[4,62,4,12,20,36,4,0],[16,16,62,18,20,16,16,0],[0,28,4,4,4,4,62,0],[0,62,2,62,2,2,62,0],[8,62,8,8,42,42,8,0],[0,16,40,4,2,2,0,0],[0,32,32,34,36,40,48,0],[0,2,2,20,8,20,32,0],[0,8,40,40,42,42,44,0],[8,62,4,8,28,42,8,0],[0,8,16,32,34,62,2,0],[0,0,0,8,8,8,120,0],[0,0,4,8,24,40,8,0],[0,0,0,28,4,4,62,0],[0,62,2,62,2,4,8,0],[0,0,0,0,64,32,16,0],[0,0,8,62,34,2,12,0],[0,0,60,4,60,4,60,0],[112,80,112,0,0,0,0,0],[0,0,0,0,0,0,32,0],[0,0,0,62,8,8,62,0],[0,0,0,42,42,2,12,0],[16,72,32,0,0,0,0,0],[0,0,0,0,112,80,112,0],[0,0,4,62,12,20,36,0],[0,0,0,28,0,0,0,0],[28,28,62,28,8,0,62,0],[255,247,247,247,213,227,247,255],[255,247,227,213,247,247,247,255],[255,255,247,251,129,251,247,255],[255,255,239,223,129,223,239,255],[187,187,187,131,187,187,187,255],[227,221,191,191,191,221,227,255],[24,36,126,255,90,36,0,0],[224,71,66,126,66,71,224,0],[34,62,42,8,8,73,127,65],[28,28,8,62,8,8,20,34],[0,17,210,252,210,17,0,0],[0,136,75,63,75,136,0,0],[34,20,8,8,62,8,28,28],[60,126,255,219,255,231,126,60],[60,66,129,165,129,153,66,60],[62,34,34,62,34,34,62,0],[62,34,62,34,62,34,66,0],[8,42,42,8,20,34,65,0],[8,9,58,12,28,42,73,0],[8,8,62,8,28,42,73,0],[8,20,62,73,62,28,127,0],[0,8,8,62,8,8,127,0],[8,72,126,72,62,8,127,0],[32,62,72,60,40,126,8,0],[4,126,84,127,82,127,10,0],[8,20,34,127,18,18,36,0],[56,18,127,23,59,82,20,0],[127,73,73,127,65,65,65,0],[34,20,62,8,62,8,8,0],[12,18,16,56,16,16,62,0],[0,192,200,84,84,85,34,0],[0,0,0,0,0,2,255,2],[2,2,2,2,2,2,7,2],[2,2,2,2,2,2,255,2],[0,0,32,80,136,5,2,0],[0,14,17,34,196,4,2,1],[0,255,0,129,66,66,129,0],[0,112,136,68,35,32,64,128],[0,196,164,148,143,148,164,196],[0,35,37,41,241,41,37,35],[136,144,160,192,192,168,152,184],[168,176,184,192,192,160,144,136],[128,64,32,16,31,32,64,128],[0,0,36,36,231,36,36,0],[8,8,62,0,0,62,8,8],[8,16,32,16,8,4,2,4],[85,170,85,170,85,170,85,170],[0,0,0,0,0,0,0,0],[0,112,112,112,0,0,0,0],[0,7,7,7,0,0,0,0],[0,119,119,119,0,0,0,0],[0,0,0,0,0,112,112,112],[0,112,112,112,0,112,112,112],[0,7,7,7,0,112,112,112],[0,119,119,119,0,112,112,112],[0,0,0,0,0,7,7,7],[0,112,112,112,0,7,7,7],[0,7,7,7,0,7,7,7],[0,119,119,119,0,7,7,7],[0,0,0,0,0,119,119,119],[0,112,112,112,0,119,119,119],[0,7,7,7,0,119,119,119],[0,119,119,119,0,119,119,119],[0,0,0,0,0,0,0,0],[0,0,56,4,60,68,58,0],[64,64,92,98,66,98,92,0],[0,0,60,66,64,66,60,0],[2,2,58,70,66,70,58,0],[0,0,60,66,126,64,60,0],[12,18,16,124,16,16,16,0],[0,0,58,70,70,58,2,60],[64,64,92,98,66,66,66,0],[8,0,24,8,8,8,28,0],[4,0,12,4,4,4,68,56],[64,64,68,72,80,104,68,0],[24,8,8,8,8,8,28,0],[0,0,118,73,73,73,73,0],[0,0,92,98,66,66,66,0],[0,0,60,66,66,66,60,0],[0,0,92,98,98,92,64,64],[0,0,58,70,70,58,2,2],[0,0,92,98,64,64,64,0],[0,0,62,64,60,2,124,0],[16,16,124,16,16,18,12,0],[0,0,66,66,66,66,60,0],[0,0,66,66,66,36,24,0],[0,0,65,73,73,73,54,0],[0,0,68,40,16,40,68,0],[0,0,66,66,70,58,2,60],[0,0,126,4,24,32,126,0],[8,8,8,8,255,8,8,8],[8,8,8,8,15,0,0,0],[8,8,8,8,248,0,0,0],[8,8,8,8,15,8,8,8],[8,8,8,8,255,0,0,0],[60,66,70,90,98,66,60,0],[8,24,40,8,8,8,62,0],[60,66,2,12,48,64,126,0],[60,66,2,60,2,66,60,0],[4,12,20,36,126,4,4,0],[126,64,120,4,2,68,56,0],[28,32,64,124,66,66,60,0],[126,66,4,8,16,16,16,0],[60,66,66,60,66,66,60,0],[60,66,66,62,2,4,56,0],[0,0,0,126,0,0,0,0],[0,0,126,0,126,0,0,0],[0,0,8,0,0,8,8,16],[0,2,4,8,16,32,64,0],[0,0,0,0,0,24,24,0],[0,0,0,0,0,8,8,16],[0,255,0,0,0,0,0,0],[64,64,64,64,64,64,64,64],[128,128,128,128,128,128,128,255],[1,1,1,1,1,1,1,255],[0,0,0,255,0,0,0,0],[16,16,16,16,16,16,16,16],[255,255,0,0,0,0,0,0],[192,192,192,192,192,192,192,192],[0,0,0,0,0,255,0,0],[4,4,4,4,4,4,4,4],[0,0,0,0,255,255,255,255],[15,15,15,15,15,15,15,15],[0,0,0,0,0,0,0,255],[1,1,1,1,1,1,1,1],[0,0,0,0,0,0,255,255],[3,3,3,3,3,3,3,3],[0,0,8,4,254,4,8,0],[8,28,62,127,127,28,62,0],[255,127,63,31,15,7,3,1],[255,255,255,255,255,255,255,255],[8,28,62,127,62,28,8,0],[0,0,16,32,127,32,16,0],[8,28,42,127,42,8,8,0],[0,60,126,126,126,126,60,0],[0,60,66,66,66,66,60,0],[60,66,2,12,16,0,16,0],[255,195,129,129,129,129,195,255],[0,0,0,0,3,4,8,8],[0,0,0,0,192,32,16,16],[128,192,224,240,248,252,254,255],[1,3,7,15,31,63,127,255],[0,0,8,0,0,8,0,0],[0,8,28,42,8,8,8,0],[14,24,48,96,48,24,14,0],[60,32,32,32,32,32,60,0],[54,127,127,127,62,28,8,0],[60,4,4,4,4,4,60,0],[28,34,74,86,76,32,30,0],[255,254,252,248,240,224,192,128],[112,24,12,6,12,24,112,0],[160,80,160,80,160,80,160,80],[0,64,32,16,8,4,2,0],[170,85,170,85,170,85,170,85],[240,240,240,240,15,15,15,15],[0,0,0,0,15,8,8,8],[0,0,0,0,248,8,8,8],[8,8,8,8,248,8,8,8],[0,0,0,0,255,8,8,8],[0,0,1,62,84,20,20,0],[8,8,8,8,0,0,8,0],[36,36,36,0,0,0,0,0],[36,36,126,36,126,36,36,0],[8,30,40,28,10,60,8,0],[0,98,100,8,16,38,70,0],[48,72,72,48,74,68,58,0],[4,8,16,0,0,0,0,0],[4,8,16,16,16,8,4,0],[32,16,8,8,8,16,32,0],[0,8,8,62,8,8,0,0],[8,42,28,62,28,42,8,0],[15,15,15,15,240,240,240,240],[129,66,36,24,24,36,66,129],[16,16,32,192,0,0,0,0],[8,8,4,3,0,0,0,0],[255,0,0,0,0,0,0,0],[128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128],[255,1,1,1,1,1,1,1],[0,0,255,0,0,0,0,0],[32,32,32,32,32,32,32,32],[4,8,17,34,68,136,16,32],[32,16,136,68,34,17,8,4],[0,0,0,0,255,0,0,0],[8,8,8,8,8,8,8,8],[255,255,255,255,0,0,0,0],[240,240,240,240,240,240,240,240],[0,0,0,0,0,0,255,0],[2,2,2,2,2,2,2,2],[0,0,0,0,0,255,255,255],[7,7,7,7,7,7,7,7],[0,8,8,8,42,28,8,0],[16,254,32,124,2,2,252,0],[0,252,2,0,0,128,126,0],[60,8,16,126,8,16,12,0],[64,64,64,64,68,68,56,0],[132,130,130,130,130,144,96,0],[132,158,132,132,156,166,92,0],[16,126,8,126,4,2,96,24],[12,24,48,96,48,24,12,0],[158,128,128,128,128,144,222,0],[16,126,16,126,16,112,156,114],[56,84,146,146,146,146,100,0],[68,68,68,100,4,8,16,0],[32,248,32,248,34,34,28,0],[112,16,20,126,148,148,100,0],[96,0,156,162,194,130,28,0],[68,68,254,68,88,64,62,0],[32,252,64,94,128,160,190,0],[8,254,8,56,72,56,8,16],[32,34,44,48,64,128,126,0],[34,249,37,36,36,36,72,0],[32,250,65,68,156,166,28,0],[224,38,69,132,132,136,112,0],[254,4,8,16,16,8,4,0],[32,254,16,8,68,32,24,0],[16,32,32,112,72,136,134,0],[128,124,2,2,2,4,24,0],[124,8,16,44,66,2,36,24],[132,190,132,132,132,132,72,0],[30,16,16,16,0,0,0,0],[0,32,112,32,120,148,104,0],[0,0,88,228,40,32,16,0],[32,228,42,50,98,162,36,0],[4,68,124,74,178,151,102,0],[56,0,16,74,74,138,48,0],[32,252,32,124,170,146,100,0],[24,0,60,66,2,4,8,0],[16,0,124,8,16,40,70,0],[32,253,33,124,162,162,100,0],[72,76,50,226,36,16,16,8],[8,156,170,202,202,140,24,0],[8,14,8,8,120,142,120,0],[158,132,158,132,156,166,220,0],[0,32,80,136,4,2,2,0],[32,230,44,52,100,164,34,0],[4,68,124,74,178,146,100,0],[124,8,16,60,66,26,36,24],[32,228,42,50,102,171,38,0],[32,253,33,96,160,98,62,0],[0,0,0,0,8,8,8,120],[0,0,72,68,68,68,32,0],[0,0,16,184,212,152,48,0],[16,254,32,116,184,72,126,0],[0,0,0,0,0,64,32,16],[0,32,0,120,4,4,8,0],[0,0,32,56,32,120,96,0],[112,80,112,0,0,0,0,0],[0,0,0,0,0,0,32,0],[0,32,0,120,16,48,76,0],[0,0,0,248,4,4,24,0],[32,144,64,0,0,0,0,0],[0,0,0,0,0,112,80,112],[0,32,116,32,120,164,104,0],[0,0,0,28,0,0,0,0],[28,28,62,28,8,0,62,0],[255,247,247,247,213,227,247,255],[255,247,227,213,247,247,247,255],[255,255,247,251,129,251,247,255],[255,255,239,223,129,223,239,255],[187,187,187,131,187,187,187,255],[227,221,191,191,191,221,227,255],[24,36,126,255,90,36,0,0],[224,71,66,126,66,71,224,0],[34,62,42,8,8,73,127,65],[28,28,8,62,8,8,20,34],[0,17,210,252,210,17,0,0],[0,136,75,63,75,136,0,0],[34,20,8,8,62,8,28,28],[60,126,255,219,255,231,126,60],[60,66,129,165,129,153,66,60],[62,34,34,62,34,34,62,0],[62,34,62,34,62,34,66,0],[8,42,42,8,20,34,65,0],[8,9,58,12,28,42,73,0],[8,8,62,8,28,42,73,0],[8,20,62,73,62,28,127,0],[0,8,8,62,8,8,127,0],[8,72,126,72,62,8,127,0],[32,62,72,60,40,126,8,0],[4,126,84,127,82,127,10,0],[8,20,34,127,18,18,36,0],[56,18,127,23,59,82,20,0],[127,73,73,127,65,65,65,0],[34,20,62,8,62,8,8,0],[12,18,16,56,16,16,62,0],[0,192,200,84,84,85,34,0],[0,0,0,0,0,2,255,2],[2,2,2,2,2,2,7,2],[2,2,2,2,2,2,255,2],[0,0,32,80,136,5,2,0],[0,14,17,34,196,4,2,1],[0,255,0,129,66,66,129,0],[0,112,136,68,35,32,64,128],[0,196,164,148,143,148,164,196],[0,35,37,41,241,41,37,35],[136,144,160,192,192,168,152,184],[168,176,184,192,192,160,144,136],[128,64,32,16,31,32,64,128],[0,0,36,36,231,36,36,0],[8,8,62,0,0,62,8,8],[8,16,32,16,8,4,2,4],[85,170,85,170,85,170,85,170],[0,0,0,0,0,0,0,0],[0,112,112,112,0,0,0,0],[0,7,7,7,0,0,0,0],[0,119,119,119,0,0,0,0],[0,0,0,0,0,112,112,112],[0,112,112,112,0,112,112,112],[0,7,7,7,0,112,112,112],[0,119,119,119,0,112,112,112],[0,0,0,0,0,7,7,7],[0,112,112,112,0,7,7,7],[0,7,7,7,0,7,7,7],[0,119,119,119,0,7,7,7],[0,0,0,0,0,119,119,119],[0,112,112,112,0,119,119,119],[0,7,7,7,0,119,119,119],[0,119,119,119,0,119,119,119]];class o{constructor(e,t,c,n,s){this.getImageData=(()=>{const o=Array(4*n*s).fill(0);let i=0;for(let n=0;n<8;n++){const s=e[n];for(let e=0;e<8;e++)0!=(s&128>>e)?(o[i+0]=t.R,o[i+1]=t.G,o[i+2]=t.B,o[i+3]=t.A):(o[i+0]=c.R,o[i+1]=c.G,o[i+2]=c.B,o[i+3]=c.A),i+=4}const r=Uint8ClampedArray.from(o),a=new ImageData(r,n,s);return this.getImageData=(()=>a),this.getImageData()})}}t.exports=s},{canvas:34}],26:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});const n={ascii2dispcode:[240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,193,194,195,196,197,198,240,240,240,240,240,240,240,240,240,0,97,98,99,100,101,102,103,104,105,107,106,47,42,46,45,32,33,34,35,36,37,38,39,40,41,79,44,81,43,87,73,85,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,82,89,84,80,69,199,200,201,202,203,204,205,206,207,223,231,232,233,234,236,237,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,192,128,189,157,177,181,185,180,158,178,182,186,190,159,179,183,187,191,163,133,164,165,166,148,135,136,156,130,152,132,146,144,131,145,129,154,151,147,149,137,161,175,139,134,150,162,171,170,138,142,176,173,141,167,168,169,143,140,174,172,155,160,153,188,184,64,59,58,112,60,113,239,61,67,86,63,30,74,28,93,62,92,31,95,94,55,123,127,54,122,126,51,75,76,29,108,91,120,65,53,52,116,48,56,117,57,77,111,110,50,119,118,114,115,71,124,83,49,78,109,72,70,125,68,27,88,121,66,96]};c.default=n,t.exports=n},{}],27:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});class n{static zs(e,t,c){const n=e.toString(t);return n.length>c?n:`${new Array(c).fill("0").join("")}${n}`.slice(-c)}static bin(e,t){return n.zs(e,2,t)}static hex(e,t){return n.zs(e,16,t).toUpperCase()}static HEX(e,t){return n.zs(e,16,t).toUpperCase()}static to8bitSigned(e){if(0!=(-256&e))throw new Error([`Invalid input value ${e}`,"(should be between 0 and 255)"].join(" "));return e>=128?-(255&~(e-1)):0|e}static to8bitUnsigned(e){if(e<-128||127<e)throw new Error([`Invalid input value ${e}`,"(should be between -128 and 127)"].join(" "));return e<0?255&~-(e+1):0|e}}c.default=n,t.exports=n},{}],28:[function(e,t,c){"use strict";function n(e){return parseInt(e,8)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=n,t.exports=n},{}],29:[function(e,t,c){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(c,"__esModule",{value:!0});const s=n(e("../Z80/bin-util")),o={parseAddress:(e,t)=>{const c=o.parseNumLiteralPair(e);if(null==c)return null;let n=c[1],i=c[0];if(null!=t)"function"==typeof n&&(n=n(t)),"function"==typeof i&&(i=i(t));else if("function"==typeof n||"function"==typeof i)return null;return s.default.pair(n,i)},parseNumLiteral:e=>{const t=o._parseNumLiteral(e);if("number"==typeof t){if(t<-128||256<=t)throw"operand "+e+" out of range";return 255&t}return t=>o.dereferLowByte(e,t)},parseNumLiteralPair:e=>{const t=o._parseNumLiteral(e);if("number"==typeof t){if(t<-32768||65535<t)throw"operand "+e+" out of range";return[255&t,t>>8&255]}return[t=>o.dereferLowByte(e,t),t=>o.dereferHighByte(e,t)]},parseRelAddr:(e,t)=>{let c=o._parseNumLiteral(e);if("number"==typeof c){const n=e.charAt(0);if("+"!==n&&"-"!==n&&(c=c-t+2),(c-=2)<-128||256<=c)throw"operand "+e+" out of range";return 255&c}return c=>o.derefer(e,c)-t&255},dereferLowByte:(e,t)=>255&o.derefer(e,t),dereferHighByte:(e,t)=>o.derefer(e,t)>>8&255,derefer:(e,t)=>e in t?t[e]:0,_parseNumLiteral:e=>{if(/^[+-]?[0-9]+$/.test(e)||/^[+-]?[0-9A-F]+H$/i.test(e)){let t,c=0;const n=/^-/.test(e)?-1:1;return/[hH]$/.test(e)?(t=e.match(/^[+-]?([0-9a-fA-F]+)[hH]$/),c=parseInt(t[1],16)):/^[+-]?0/.test(e)?(t=e.match(/^[+-]?([0-7]+)$/),c=parseInt(t[1],8)):(t=e.match(/^[+-]?([0-9]+)$/),c=parseInt(t[1],10)),n*c}return e}};c.default=o,t.exports=o},{"../Z80/bin-util":8}],30:[function(e,t,c){(function(c){"use strict";var n=e("object-assign");function s(e,t){if(e===t)return 0;for(var c=e.length,n=t.length,s=0,o=Math.min(c,n);s<o;++s)if(e[s]!==t[s]){c=e[s],n=t[s];break}return c<n?-1:n<c?1:0}function o(e){return c.Buffer&&"function"==typeof c.Buffer.isBuffer?c.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var i=e("util/"),r=Object.prototype.hasOwnProperty,a=Array.prototype.slice,l="foo"===function(){}.name;function d(e){return Object.prototype.toString.call(e)}function u(e){return!o(e)&&("function"==typeof c.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var m=t.exports=k,p=/\s*function\s+([^\(\s]*)\s*/;function f(e){if(i.isFunction(e)){if(l)return e.name;var t=e.toString().match(p);return t&&t[1]}}function h(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function y(e){if(l||!i.isFunction(e))return i.inspect(e);var t=f(e);return"[Function"+(t?": "+t:"")+"]"}function A(e,t,c,n,s){throw new m.AssertionError({message:c,actual:e,expected:t,operator:n,stackStartFunction:s})}function k(e,t){e||A(e,!0,t,"==",m.ok)}function C(e,t,c,n){if(e===t)return!0;if(o(e)&&o(t))return 0===s(e,t);if(i.isDate(e)&&i.isDate(t))return e.getTime()===t.getTime();if(i.isRegExp(e)&&i.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(u(e)&&u(t)&&d(e)===d(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===s(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(o(e)!==o(t))return!1;var r=(n=n||{actual:[],expected:[]}).actual.indexOf(e);return-1!==r&&r===n.expected.indexOf(t)||(n.actual.push(e),n.expected.push(t),function(e,t,c,n){if(null===e||void 0===e||null===t||void 0===t)return!1;if(i.isPrimitive(e)||i.isPrimitive(t))return e===t;if(c&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var s=L(e),o=L(t);if(s&&!o||!s&&o)return!1;if(s)return e=a.call(e),t=a.call(t),C(e,t,c);var r,l,d=b(e),u=b(t);if(d.length!==u.length)return!1;for(d.sort(),u.sort(),l=d.length-1;l>=0;l--)if(d[l]!==u[l])return!1;for(l=d.length-1;l>=0;l--)if(r=d[l],!C(e[r],t[r],c,n))return!1;return!0}(e,t,c,n))}return c?e===t:e==t}function L(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function D(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function I(e,t,c,n){var s;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof c&&(n=c,c=null),s=function(e){var t;try{e()}catch(e){t=e}return t}(t),n=(c&&c.name?" ("+c.name+").":".")+(n?" "+n:"."),e&&!s&&A(s,c,"Missing expected exception"+n);var o="string"==typeof n,r=!e&&i.isError(s),a=!e&&s&&!c;if((r&&o&&D(s,c)||a)&&A(s,c,"Got unwanted exception"+n),e&&s&&c&&!D(s,c)||!e&&s)throw s}m.AssertionError=function(e){var t;this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=h(y((t=this).actual),128)+" "+t.operator+" "+h(y(t.expected),128),this.generatedMessage=!0);var c=e.stackStartFunction||A;if(Error.captureStackTrace)Error.captureStackTrace(this,c);else{var n=new Error;if(n.stack){var s=n.stack,o=f(c),i=s.indexOf("\n"+o);if(i>=0){var r=s.indexOf("\n",i+1);s=s.substring(r+1)}this.stack=s}}},i.inherits(m.AssertionError,Error),m.fail=A,m.ok=k,m.equal=function(e,t,c){e!=t&&A(e,t,c,"==",m.equal)},m.notEqual=function(e,t,c){e==t&&A(e,t,c,"!=",m.notEqual)},m.deepEqual=function(e,t,c){C(e,t,!1)||A(e,t,c,"deepEqual",m.deepEqual)},m.deepStrictEqual=function(e,t,c){C(e,t,!0)||A(e,t,c,"deepStrictEqual",m.deepStrictEqual)},m.notDeepEqual=function(e,t,c){C(e,t,!1)&&A(e,t,c,"notDeepEqual",m.notDeepEqual)},m.notDeepStrictEqual=function e(t,c,n){C(t,c,!0)&&A(t,c,n,"notDeepStrictEqual",e)},m.strictEqual=function(e,t,c){e!==t&&A(e,t,c,"===",m.strictEqual)},m.notStrictEqual=function(e,t,c){e===t&&A(e,t,c,"!==",m.notStrictEqual)},m.throws=function(e,t,c){I(!0,e,t,c)},m.doesNotThrow=function(e,t,c){I(!1,e,t,c)},m.ifError=function(e){if(e)throw e},m.strict=n(function e(t,c){t||A(t,!0,c,"==",e)},m,{equal:m.strictEqual,deepEqual:m.deepStrictEqual,notEqual:m.notStrictEqual,notDeepEqual:m.notDeepStrictEqual}),m.strict.strict=m.strict;var b=Object.keys||function(e){var t=[];for(var c in e)r.call(e,c)&&t.push(c);return t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"object-assign":37,"util/":33}],31:[function(e,t,c){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var c=function(){};c.prototype=t.prototype,e.prototype=new c,e.prototype.constructor=e}},{}],32:[function(e,t,c){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],33:[function(e,t,c){(function(t,n){var s=/%[sdj%]/g;c.format=function(e){if(!A(e)){for(var t=[],c=0;c<arguments.length;c++)t.push(r(arguments[c]));return t.join(" ")}c=1;for(var n=arguments,o=n.length,i=String(e).replace(s,function(e){if("%%"===e)return"%";if(c>=o)return e;switch(e){case"%s":return String(n[c++]);case"%d":return Number(n[c++]);case"%j":try{return JSON.stringify(n[c++])}catch(e){return"[Circular]"}default:return e}}),a=n[c];c<o;a=n[++c])h(a)||!L(a)?i+=" "+a:i+=" "+r(a);return i},c.deprecate=function(e,s){if(k(n.process))return function(){return c.deprecate(e,s).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(s);t.traceDeprecation?console.trace(s):console.error(s),o=!0}return e.apply(this,arguments)}};var o,i={};function r(e,t){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(t)?n.showHidden=t:t&&c._extend(n,t),k(n.showHidden)&&(n.showHidden=!1),k(n.depth)&&(n.depth=2),k(n.colors)&&(n.colors=!1),k(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=a),d(n,e,n.depth)}function a(e,t){var c=r.styles[t];return c?"["+r.colors[c][0]+"m"+e+"["+r.colors[c][1]+"m":e}function l(e,t){return e}function d(e,t,n){if(e.customInspect&&t&&b(t.inspect)&&t.inspect!==c.inspect&&(!t.constructor||t.constructor.prototype!==t)){var s=t.inspect(n,e);return A(s)||(s=d(e,s,n)),s}var o=function(e,t){if(k(t))return e.stylize("undefined","undefined");if(A(t)){var c="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(c,"string")}if(y(t))return e.stylize(""+t,"number");if(f(t))return e.stylize(""+t,"boolean");if(h(t))return e.stylize("null","null")}(e,t);if(o)return o;var i=Object.keys(t),r=function(e){var t={};return e.forEach(function(e,c){t[e]=!0}),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),I(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return u(t);if(0===i.length){if(b(t)){var a=t.name?": "+t.name:"";return e.stylize("[Function"+a+"]","special")}if(C(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(D(t))return e.stylize(Date.prototype.toString.call(t),"date");if(I(t))return u(t)}var l,L="",g=!1,R=["{","}"];(p(t)&&(g=!0,R=["[","]"]),b(t))&&(L=" [Function"+(t.name?": "+t.name:"")+"]");return C(t)&&(L=" "+RegExp.prototype.toString.call(t)),D(t)&&(L=" "+Date.prototype.toUTCString.call(t)),I(t)&&(L=" "+u(t)),0!==i.length||g&&0!=t.length?n<0?C(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),l=g?function(e,t,c,n,s){for(var o=[],i=0,r=t.length;i<r;++i)_(t,String(i))?o.push(m(e,t,c,n,String(i),!0)):o.push("");return s.forEach(function(s){s.match(/^\d+$/)||o.push(m(e,t,c,n,s,!0))}),o}(e,t,n,r,i):i.map(function(c){return m(e,t,n,r,c,g)}),e.seen.pop(),function(e,t,c){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return c[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+c[1];return c[0]+t+" "+e.join(", ")+" "+c[1]}(l,L,R)):R[0]+L+R[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function m(e,t,c,n,s,o){var i,r,a;if((a=Object.getOwnPropertyDescriptor(t,s)||{value:t[s]}).get?r=a.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):a.set&&(r=e.stylize("[Setter]","special")),_(n,s)||(i="["+s+"]"),r||(e.seen.indexOf(a.value)<0?(r=h(c)?d(e,a.value,null):d(e,a.value,c-1)).indexOf("\n")>-1&&(r=o?r.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+r.split("\n").map(function(e){return"   "+e}).join("\n")):r=e.stylize("[Circular]","special")),k(i)){if(o&&s.match(/^\d+$/))return r;(i=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(i=i.substr(1,i.length-2),i=e.stylize(i,"name")):(i=i.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),i=e.stylize(i,"string"))}return i+": "+r}function p(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function h(e){return null===e}function y(e){return"number"==typeof e}function A(e){return"string"==typeof e}function k(e){return void 0===e}function C(e){return L(e)&&"[object RegExp]"===g(e)}function L(e){return"object"==typeof e&&null!==e}function D(e){return L(e)&&"[object Date]"===g(e)}function I(e){return L(e)&&("[object Error]"===g(e)||e instanceof Error)}function b(e){return"function"==typeof e}function g(e){return Object.prototype.toString.call(e)}function R(e){return e<10?"0"+e.toString(10):e.toString(10)}c.debuglog=function(e){if(k(o)&&(o=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!i[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var n=t.pid;i[e]=function(){var t=c.format.apply(c,arguments);console.error("%s %d: %s",e,n,t)}}else i[e]=function(){};return i[e]},c.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=p,c.isBoolean=f,c.isNull=h,c.isNullOrUndefined=function(e){return null==e},c.isNumber=y,c.isString=A,c.isSymbol=function(e){return"symbol"==typeof e},c.isUndefined=k,c.isRegExp=C,c.isObject=L,c.isDate=D,c.isError=I,c.isFunction=b,c.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},c.isBuffer=e("./support/isBuffer");var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _(e,t){return Object.prototype.hasOwnProperty.call(e,t)}c.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[R(e.getHours()),R(e.getMinutes()),R(e.getSeconds())].join(":"),[e.getDate(),E[e.getMonth()],t].join(" ")),c.format.apply(c,arguments))},c.inherits=e("inherits"),c._extend=function(e,t){if(!t||!L(t))return e;for(var c=Object.keys(t),n=c.length;n--;)e[c[n]]=t[c[n]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":32,_process:38,inherits:31}],34:[function(e,t,c){const n=e("./lib/parse-font");c.parseFont=n,c.createCanvas=function(e,t){return Object.assign(document.createElement("canvas"),{width:e,height:t})},c.createImageData=function(e,t,c){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(e);case 2:return new ImageData(e,t);default:return new ImageData(e,t,c)}},c.loadImage=function(e,t){return new Promise(function(c,n){const s=Object.assign(document.createElement("img"),t);function o(){s.onload=null,s.onerror=null}s.onload=function(){o(),c(s)},s.onerror=function(){o(),n(new Error('Failed to load the image "'+e+'"'))},s.src=e})}},{"./lib/parse-font":35}],35:[function(e,t,c){"use strict";const n="'([^']+)'|\"([^\"]+)\"|[\\w\\s-]+",s=new RegExp("(bold|bolder|lighter|[1-9]00) +","i"),o=new RegExp("(italic|oblique) +","i"),i=new RegExp("(small-caps) +","i"),r=new RegExp("(ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded) +","i"),a=new RegExp("([\\d\\.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q) *((?:"+n+")( *, *(?:"+n+"))*)"),l={};t.exports=function(e){if(l[e])return l[e];const t=a.exec(e);if(!t)return;const c={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(t[1]),unit:t[2],family:t[3].replace(/["']/g,"").replace(/ *, */g,",")};let n,d,u,m,p=e.substring(0,t.index);switch((n=s.exec(p))&&(c.weight=n[1]),(d=o.exec(p))&&(c.style=d[1]),(u=i.exec(p))&&(c.variant=u[1]),(m=r.exec(p))&&(c.stretch=m[1]),c.unit){case"pt":c.size/=.75;break;case"pc":c.size*=16;break;case"in":c.size*=96;break;case"cm":c.size*=96/2.54;break;case"mm":c.size*=96/25.4;break;case"%":break;case"em":case"rem":c.size*=16/.75;break;case"q":c.size*=96/25.4/4}return l[e]=c}},{}],36:[function(e,t,c){!function(){"use strict";function e(){this._numOfTimer=1,this._delay=1,this._iteration=1,this._func=null,this._timerIds=null,this._calcFreq=null,this._tickStart=(new Date).getTime(),this._count=0,this._tickEnd=(new Date).getTime()}e.prototype.setNumOfTimer=function(e){this.updateTimer(function(){this._numOfTimer=e})},e.prototype.setTimerInterval=function(e){this.updateTimer(function(){this._delay=e})},e.prototype.setProcCount=function(e){this.updateTimer(function(){this._iteration=e})},e.prototype.setProc=function(e){this.updateTimer(function(){this._func=e})},e.prototype.isRunning=function(){return null!=this._timerIds},e.prototype.start=function(){if(!this.isRunning()){this._timerIds=[],this._tickStart=(new Date).getTime(),this._count=0,this._tickEnd=(new Date).getTime();for(var e=0;e<this._numOfTimer;e++)this._timerIds.push(setInterval(function(){if(null!=this._timerIds)for(var e=0;e<this._iteration;e++)null!=this._timerIds&&(this._count++,this._func())}.bind(this),this._delay))}},e.prototype.stop=function(){this.isRunning()&&(this._tickEnd=(new Date).getTime(),this._timerIds.forEach(function(e){clearInterval(e)}),this._timerIds=null)},e.prototype.getElapse=function(){return this._tickEnd-this._tickStart},e.prototype.getCalculatedFreq=function(){return this._calcFreq},e.prototype.getActualFreq=function(){var e=this.getElapse();return 0==e?null:this._count/(e/1e3)},e.prototype.getStat=function(){var e=this.getCalculatedFreq(),t=this.getElapse(),c=this.getActualFreq();return{parameter:{numOfTimer:this._numOfTimer,interval:this._delay,iteration:this._iteration,calcFreq:e},result:{elapse:t,actualFreq:c,actParCalc:c/e}}},e.prototype.updateTimer=function(e){var t=this.isRunning();t&&this.stop(),e.call(this),0!=this._delay?this._calcFreq=this._iteration*(1e3/this._delay)*this._numOfTimer:this._calcFreq=null,t&&this.start()},e.setInterval=function(t,c,n,s){if(n=n||0,s=s||0,0==n&&0==s){for(;c*++n<20;);for(c=Math.round(c*n);n/++s>500;);n=Math.round(n/s)}var o=new e;return o.setProc(t),o.setNumOfTimer(n),o.setTimerInterval(c),o.setProcCount(s),o.start(),o},e.clearInterval=function(e){e.stop()};try{t.exports={setInterval:e.setInterval,clearInterval:e.clearInterval}}catch(t){Function("return this;")().FractionalTimer=e}}()},{}],37:[function(e,t,c){"use strict";var n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},c=0;c<10;c++)t["_"+String.fromCharCode(c)]=c;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var c,i,r=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),a=1;a<arguments.length;a++){for(var l in c=Object(arguments[a]))s.call(c,l)&&(r[l]=c[l]);if(n){i=n(c);for(var d=0;d<i.length;d++)o.call(c,i[d])&&(r[i[d]]=c[i[d]])}}return r}},{}],38:[function(e,t,c){var n,s,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{s="function"==typeof clearTimeout?clearTimeout:r}catch(e){s=r}}();var l,d=[],u=!1,m=-1;function p(){u&&l&&(u=!1,l.length?d=l.concat(d):m=-1,d.length&&f())}function f(){if(!u){var e=a(p);u=!0;for(var t=d.length;t;){for(l=d,d=[];++m<t;)l&&l[m].run();m=-1,t=d.length}l=null,u=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===r||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)t[c-1]=arguments[c];d.push(new h(e,t)),1!==d.length||u||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],39:[function(e,t,c){"use strict";const n=e("./lib/transworker.js"),s=n,o=e("./lib/shared-transworker.js"),i=e("./lib/websocket-client.js"),r=e("./lib/websocket-server.js");n.Options=e("./lib/transworker-options.js"),n.WebSocketClient=i,n.WebSocketServer=r,n.createInterface=function(e,t,c){c=c||new n.Options,e.constructor!==n.Options&&(c=new n.Options(c));const i=c.shared?new o:new s;return i._shared=c.shared,i._syncType=c.syncType,i.createInvoker(e,t),i},n.createInvoker=function(e,t,c,o){const i=new s;return i._syncType=n.SyncTypeCallback,i.createInvoker(e,t,c,o),i},n.createSharedInvoker=function(e,t,c,s){const i=new o;return i._syncType=n.SyncTypeCallback,i.createInvoker(e,t,c,s),i},n.createWorker=function(e){const t=new s;return"function"==typeof e&&(e=new e),t.createWorker(e),t},n.createSharedWorker=function(e){const t=new o;return"function"==typeof e&&(e=new e),t.createWorker(e),t},t.exports=n},{"./lib/shared-transworker.js":40,"./lib/transworker-options.js":41,"./lib/transworker.js":42,"./lib/websocket-client.js":43,"./lib/websocket-server.js":44}],40:[function(e,t,c){"use strict";const n=e("./transworker.js");function s(){}s.prototype=new n,s.prototype.subscribeWorkerConsole=function(){this.subscribe("TransWorker.post_log",e=>console.log(e)),this.subscribe("TransWorker.post_error",e=>console.err(e)),this.subscribe("TransWorker.post_warn",e=>console.warn(e))},s.prototype.connectWorker=function(e){this.worker=new SharedWorker(e),this.messagePort=this.worker.port,this.messagePort.onmessage=this.onReceiveWorkerMessage.bind(this),this.messagePort.start()},s.prototype.publishWorkerConsole=function(){const e={log:this.worker.console.log,warn:this.worker.console.warn,error:this.worker.console.error},t=(t,c)=>{this.messagePort?this.postNotify(`TransWorker.post_${t}`,c.join(" ")):e[t].apply(this.worker,c)};this.worker.console={log:(...e)=>t("log",e),error:(...e)=>t("error",e),warn:(...e)=>t("warn",e)}},s.prototype.setupOnConnect=function(){this.worker.onconnect=(e=>{this.messagePort=e.ports[0],this.messagePort.addEventListener("message",this.onReceiveClientMessage.bind(this)),this.messagePort.start()})},t.exports=s},{"./transworker.js":42}],41:[function(e,t,c){"use strict";const n=e("assert"),s=e("./transworker.js");t.exports=function(e){(e=e||{shared:!1,syncType:s.SyncTypeCallback}).shared=null!=e.shared&&e.shared,e.syncType=null!=e.syncType?e.syncType:s.SyncTypeCallback,n.ok("boolean"==typeof e.shared&&(e.syncType===s.SyncTypeCallback||e.syncType===s.SyncTypePromise)),this.shared=e.shared,this.syncType=e.syncType}},{"./transworker.js":42,assert:30}],42:[function(e,t,c){"use strict";const{v4:n}=e("uuid"),s=Function("return this;")();let o=s.constructor.name;function i(){"Window"==o?(this.callbacks={},this._uuid=n(),this.queryId=0,this._onNotify={},this._callbacker=null):(this.worker=s,this.client=null,this.messagePort=null,this._txObjReceiver={})}o||("[object Window]"==s?o="Window":"[object WorkerGlobalScope]"==s&&(o="DedicatedWorkerGlobalScope")),i.context=o,i.SyncTypeCallback=Function,i.SyncTypePromise=Promise,i.prototype.createInvoker=function(e,t,c,n){this._callbacker=c;const s=Object.getOwnPropertyNames(t.prototype);if(this._syncType===i.SyncTypePromise)for(const e of s)this[e]=this.createPromiseWrapper(e).bind(this);else for(const e of s)this[e]=this.createCallbackWrapper(e).bind(this);return n=n||{},Object.keys(n).forEach(e=>{name in this._onNotify||(this._onNotify[e]=[]),this._onNotify[e].push((...t)=>{n[e].apply(this._callbacker,t)})}),this.subscribeWorkerConsole(),this.connectWorker(e)},i.prototype.onReceiveWorkerMessage=function(e){switch(e.data.type){case"response":try{if(e.data.uuid!==this._uuid)break;this.callbacks[e.data.queryId].apply(this._callbacker,e.data.param)}catch(t){console.warn("*** exception: ",t,"in method",e.data.method,"params:",JSON.stringify(e.data.param))}delete this.callbacks[e.data.queryId];break;case"notify":try{this._onNotify[e.data.name].forEach(t=>t(e.data.param))}catch(t){console.warn("*** exception: ",t,"in notify",e.data.name,"params:",JSON.stringify(e.data.param))}}},i.prototype.connectWorker=function(e){this.worker=new Worker(e),this.messagePort=this.worker,this.messagePort.onmessage=this.onReceiveWorkerMessage.bind(this)},i.prototype.subscribeWorkerConsole=function(){},i.prototype.subscribe=function(e,t){if(!t||"function"!=typeof t)throw new Error(`Could not subscribe to '${e}' with the handler of non-function`);e in this._onNotify||(this._onNotify[e]=[]),this._onNotify[e].push((...e)=>t.apply(this,e))},i.prototype.createCallbackWrapper=function(e){return(...t)=>{try{const c=this.queryId++;t.length>0&&"function"==typeof t.slice(-1)[0]?this.callbacks[c]=t.splice(-1,1)[0]:this.callbacks[c]=(()=>{}),this.postMessage({method:e,param:t,uuid:this._uuid,queryId:c})}catch(e){console.error(e.stack)}}},i.prototype.postMessage=function(e,t){this.messagePort.postMessage(e,t)},i.prototype.invokeMethod=function(e,t,c){return new Promise((n,s)=>{try{const o=this.queryId++;this.callbacks[o]=(e=>n(e)),this.postMessage({method:e,param:t,uuid:this._uuid,queryId:o},c)}catch(e){s(e)}})},i.prototype.createPromiseWrapper=function(e){return(...t)=>this.invokeMethod(e,t)},i.prototype.transferObject=function(e,t){return this.invokeMethod("onTransferableObject",[e,t],[t])},i.prototype.createWorker=function(e){this.client=e,this.client._transworker=this,this.publishWorkerConsole(),this.injectSubClassMethod(),this.setupOnConnect()},i.prototype.injectSubClassMethod=function(){Object.getOwnPropertyNames(this.constructor.prototype).forEach(e=>{this.client[e]=((...t)=>{this.constructor.prototype[e].apply(this,t)})})},i.prototype.publishWorkerConsole=function(){},i.prototype.setupOnConnect=function(){this.messagePort=this.worker,this.messagePort.onmessage=this.onReceiveClientMessage.bind(this)},i.prototype.onReceiveClientMessage=function(e){const t=t=>{this.postMessage({type:"response",uuid:e.data.uuid,queryId:e.data.queryId,method:e.data.method,param:[t]})},c=t=>{console.warn("*** exception: ",t,"in method",e.data.method,"params:",JSON.stringify(e.data.param))};try{const n=this.client[e.data.method].apply(this.client,e.data.param);n&&n.constructor===Promise?n.then(e=>{t(e)}).catch(e=>{c(e)}):t(n)}catch(e){c(e)}},i.prototype.postNotify=function(e,t,c){this.postMessage({type:"notify",name:e,param:t},c)},i.prototype.onTransferableObject=function(e,t){this._txObjReceiver[e](t)},i.prototype.listenTransferableObject=function(e,t){this._txObjReceiver[e]=t},"Window"==i.context?(i.prototype.create=i.prototype.createInvoker,i.create=i.createInvoker):"DedicatedWorkerGlobalScope"!=i.context&&"WorkerGlobalScope"!=i.context||(i.prototype.create=i.prototype.createWorker,i.create=i.createWorker),s.TransWorker=i,t.exports=i},{uuid:45}],43:[function(e,t,c){"use strict";const n=e("./transworker.js");n.Options=e("./transworker-options.js");t.exports=class extends n{static createInterface(e,t,c){(c=c||new n.Options).constructor!==n.Options&&(c=new n.Options(c));const s=new n.WebSocketClient;return s._shared=!1,s._syncType=c.syncType,s.createInvoker(e,t).then(()=>s)}connectWorker(e){return new Promise((t,c)=>{try{const n=new WebSocket(e);this.worker=null,this.messagePort=n,this.messagePort.onmessage=(e=>{const t=JSON.parse(e.data);this.onReceiveWorkerMessage({data:t})}),n.onopen=(()=>{t()})}catch(e){c(e)}})}postMessage(e){this.messagePort.send(JSON.stringify(e))}}},{"./transworker-options.js":41,"./transworker.js":42}],44:[function(e,t,c){"use strict";const n=e("ws"),s=e("./transworker.js");class o extends s{static listen(e,t){this.wss=new n.Server({server:e}),this.wss.on("connection",async e=>{const c=new o(e);try{const e=t(c);await c.setupClient(e)}catch(e){console.error(`Error: ${e.stack}`)}})}constructor(e){super(),this.worker=null,this.messagePort=e,this.messagePort.onmessage=(e=>{try{const t=JSON.parse(e.data);this.onReceiveClientMessage({data:t})}catch(e){console.error(`Error: ${e.stack}`)}})}async setupClient(e){e instanceof Promise?this.client=await e:this.client=e,this.client._transworker=this,this.injectSubClassMethod()}postMessage(e){this.messagePort.send(JSON.stringify(e))}}t.exports=o},{"./transworker.js":42,ws:60}],45:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(c,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(c,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(c,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(c,"NIL",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(c,"version",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(c,"validate",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(c,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(c,"parse",{enumerable:!0,get:function(){return u.default}});var n=m(e("./v1.js")),s=m(e("./v3.js")),o=m(e("./v4.js")),i=m(e("./v5.js")),r=m(e("./nil.js")),a=m(e("./version.js")),l=m(e("./validate.js")),d=m(e("./stringify.js")),u=m(e("./parse.js"));function m(e){return e&&e.__esModule?e:{default:e}}},{"./nil.js":47,"./parse.js":48,"./stringify.js":52,"./v1.js":53,"./v3.js":54,"./v4.js":56,"./v5.js":57,"./validate.js":58,"./version.js":59}],46:[function(e,t,c){"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function s(e,t){const c=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(c>>16)<<16|65535&c}function o(e,t,c,n,o,i){return s((r=s(s(t,e),s(n,i)))<<(a=o)|r>>>32-a,c);var r,a}function i(e,t,c,n,s,i,r){return o(t&c|~t&n,e,t,s,i,r)}function r(e,t,c,n,s,i,r){return o(t&n|c&~n,e,t,s,i,r)}function a(e,t,c,n,s,i,r){return o(t^c^n,e,t,s,i,r)}function l(e,t,c,n,s,i,r){return o(c^(t|~n),e,t,s,i,r)}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var d=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let c=0;c<t.length;++c)e[c]=t.charCodeAt(c)}return function(e){const t=[],c=32*e.length;for(let n=0;n<c;n+=8){const c=e[n>>5]>>>n%32&255,s=parseInt("0123456789abcdef".charAt(c>>>4&15)+"0123456789abcdef".charAt(15&c),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let c=1732584193,o=-271733879,d=-1732584194,u=271733878;for(let t=0;t<e.length;t+=16){const n=c,m=o,p=d,f=u;c=i(c,o,d,u,e[t],7,-680876936),u=i(u,c,o,d,e[t+1],12,-389564586),d=i(d,u,c,o,e[t+2],17,606105819),o=i(o,d,u,c,e[t+3],22,-1044525330),c=i(c,o,d,u,e[t+4],7,-176418897),u=i(u,c,o,d,e[t+5],12,1200080426),d=i(d,u,c,o,e[t+6],17,-1473231341),o=i(o,d,u,c,e[t+7],22,-45705983),c=i(c,o,d,u,e[t+8],7,1770035416),u=i(u,c,o,d,e[t+9],12,-1958414417),d=i(d,u,c,o,e[t+10],17,-42063),o=i(o,d,u,c,e[t+11],22,-1990404162),c=i(c,o,d,u,e[t+12],7,1804603682),u=i(u,c,o,d,e[t+13],12,-40341101),d=i(d,u,c,o,e[t+14],17,-1502002290),o=i(o,d,u,c,e[t+15],22,1236535329),c=r(c,o,d,u,e[t+1],5,-165796510),u=r(u,c,o,d,e[t+6],9,-1069501632),d=r(d,u,c,o,e[t+11],14,643717713),o=r(o,d,u,c,e[t],20,-373897302),c=r(c,o,d,u,e[t+5],5,-701558691),u=r(u,c,o,d,e[t+10],9,38016083),d=r(d,u,c,o,e[t+15],14,-660478335),o=r(o,d,u,c,e[t+4],20,-405537848),c=r(c,o,d,u,e[t+9],5,568446438),u=r(u,c,o,d,e[t+14],9,-1019803690),d=r(d,u,c,o,e[t+3],14,-187363961),o=r(o,d,u,c,e[t+8],20,1163531501),c=r(c,o,d,u,e[t+13],5,-1444681467),u=r(u,c,o,d,e[t+2],9,-51403784),d=r(d,u,c,o,e[t+7],14,1735328473),o=r(o,d,u,c,e[t+12],20,-1926607734),c=a(c,o,d,u,e[t+5],4,-378558),u=a(u,c,o,d,e[t+8],11,-2022574463),d=a(d,u,c,o,e[t+11],16,1839030562),o=a(o,d,u,c,e[t+14],23,-35309556),c=a(c,o,d,u,e[t+1],4,-1530992060),u=a(u,c,o,d,e[t+4],11,1272893353),d=a(d,u,c,o,e[t+7],16,-155497632),o=a(o,d,u,c,e[t+10],23,-1094730640),c=a(c,o,d,u,e[t+13],4,681279174),u=a(u,c,o,d,e[t],11,-358537222),d=a(d,u,c,o,e[t+3],16,-722521979),o=a(o,d,u,c,e[t+6],23,76029189),c=a(c,o,d,u,e[t+9],4,-640364487),u=a(u,c,o,d,e[t+12],11,-421815835),d=a(d,u,c,o,e[t+15],16,530742520),o=a(o,d,u,c,e[t+2],23,-995338651),c=l(c,o,d,u,e[t],6,-198630844),u=l(u,c,o,d,e[t+7],10,1126891415),d=l(d,u,c,o,e[t+14],15,-1416354905),o=l(o,d,u,c,e[t+5],21,-57434055),c=l(c,o,d,u,e[t+12],6,1700485571),u=l(u,c,o,d,e[t+3],10,-1894986606),d=l(d,u,c,o,e[t+10],15,-1051523),o=l(o,d,u,c,e[t+1],21,-2054922799),c=l(c,o,d,u,e[t+8],6,1873313359),u=l(u,c,o,d,e[t+15],10,-30611744),d=l(d,u,c,o,e[t+6],15,-1560198380),o=l(o,d,u,c,e[t+13],21,1309151649),c=l(c,o,d,u,e[t+4],6,-145523070),u=l(u,c,o,d,e[t+11],10,-1120210379),d=l(d,u,c,o,e[t+2],15,718787259),o=l(o,d,u,c,e[t+9],21,-343485551),c=s(c,n),o=s(o,m),d=s(d,p),u=s(u,f)}return[c,o,d,u]}(function(e){if(0===e.length)return[];const t=8*e.length,c=new Uint32Array(n(t));for(let n=0;n<t;n+=8)c[n>>5]|=(255&e[n/8])<<n%32;return c}(e),8*e.length))};c.default=d},{}],47:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;c.default="00000000-0000-0000-0000-000000000000"},{}],48:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var o=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");let t;const c=new Uint8Array(16);return c[0]=(t=parseInt(e.slice(0,8),16))>>>24,c[1]=t>>>16&255,c[2]=t>>>8&255,c[3]=255&t,c[4]=(t=parseInt(e.slice(9,13),16))>>>8,c[5]=255&t,c[6]=(t=parseInt(e.slice(14,18),16))>>>8,c[7]=255&t,c[8]=(t=parseInt(e.slice(19,23),16))>>>8,c[9]=255&t,c[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,c[11]=t/4294967296&255,c[12]=t>>>24&255,c[13]=t>>>16&255,c[14]=t>>>8&255,c[15]=255&t,c};c.default=o},{"./validate.js":58}],49:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;c.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],50:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(){if(!n)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(s)};const n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),s=new Uint8Array(16)},{}],51:[function(e,t,c){"use strict";function n(e,t,c,n){switch(e){case 0:return t&c^~t&n;case 1:return t^c^n;case 2:return t&c^t&n^c&n;case 3:return t^c^n}}function s(e,t){return e<<t|e>>>32-t}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var o=function(e){const t=[1518500249,1859775393,2400959708,3395469782],c=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let c=0;c<t.length;++c)e.push(t.charCodeAt(c))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const o=e.length/4+2,i=Math.ceil(o/16),r=new Array(i);for(let t=0;t<i;++t){const c=new Uint32Array(16);for(let n=0;n<16;++n)c[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];r[t]=c}r[i-1][14]=8*(e.length-1)/Math.pow(2,32),r[i-1][14]=Math.floor(r[i-1][14]),r[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){const o=new Uint32Array(80);for(let t=0;t<16;++t)o[t]=r[e][t];for(let e=16;e<80;++e)o[e]=s(o[e-3]^o[e-8]^o[e-14]^o[e-16],1);let i=c[0],a=c[1],l=c[2],d=c[3],u=c[4];for(let e=0;e<80;++e){const c=Math.floor(e/20),r=s(i,5)+n(c,a,l,d)+u+t[c]+o[e]>>>0;u=d,d=l,l=s(a,30)>>>0,a=i,i=r}c[0]=c[0]+i>>>0,c[1]=c[1]+a>>>0,c[2]=c[2]+l>>>0,c[3]=c[3]+d>>>0,c[4]=c[4]+u>>>0}return[c[0]>>24&255,c[0]>>16&255,c[0]>>8&255,255&c[0],c[1]>>24&255,c[1]>>16&255,c[1]>>8&255,255&c[1],c[2]>>24&255,c[2]>>16&255,c[2]>>8&255,255&c[2],c[3]>>24&255,c[3]>>16&255,c[3]>>8&255,255&c[3],c[4]>>24&255,c[4]>>16&255,c[4]>>8&255,255&c[4]]};c.default=o},{}],52:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).substr(1));var i=function(e,t=0){const c=(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!(0,s.default)(c))throw TypeError("Stringified UUID is invalid");return c};c.default=i},{"./validate.js":58}],53:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n=o(e("./rng.js")),s=o(e("./stringify.js"));function o(e){return e&&e.__esModule?e:{default:e}}let i,r,a=0,l=0;var d=function(e,t,c){let o=t&&c||0;const d=t||new Array(16);let u=(e=e||{}).node||i,m=void 0!==e.clockseq?e.clockseq:r;if(null==u||null==m){const t=e.random||(e.rng||n.default)();null==u&&(u=i=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==m&&(m=r=16383&(t[6]<<8|t[7]))}let p=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:l+1;const h=p-a+(f-l)/1e4;if(h<0&&void 0===e.clockseq&&(m=m+1&16383),(h<0||p>a)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,l=f,r=m;const y=(1e4*(268435455&(p+=122192928e5))+f)%4294967296;d[o++]=y>>>24&255,d[o++]=y>>>16&255,d[o++]=y>>>8&255,d[o++]=255&y;const A=p/4294967296*1e4&268435455;d[o++]=A>>>8&255,d[o++]=255&A,d[o++]=A>>>24&15|16,d[o++]=A>>>16&255,d[o++]=m>>>8|128,d[o++]=255&m;for(let e=0;e<6;++e)d[o+e]=u[e];return t||(0,s.default)(d)};c.default=d},{"./rng.js":50,"./stringify.js":52}],54:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n=o(e("./v35.js")),s=o(e("./md5.js"));function o(e){return e&&e.__esModule?e:{default:e}}var i=(0,n.default)("v3",48,s.default);c.default=i},{"./md5.js":46,"./v35.js":55}],55:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(e,t,c){function o(e,o,i,r){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let c=0;c<e.length;++c)t.push(e.charCodeAt(c));return t}(e)),"string"==typeof o&&(o=(0,s.default)(o)),16!==o.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(o),a.set(e,o.length),(a=c(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,i){r=r||0;for(let e=0;e<16;++e)i[r+e]=a[e];return i}return(0,n.default)(a)}try{o.name=e}catch(e){}return o.DNS=i,o.URL=r,o},c.URL=c.DNS=void 0;var n=o(e("./stringify.js")),s=o(e("./parse.js"));function o(e){return e&&e.__esModule?e:{default:e}}const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";c.DNS=i;const r="6ba7b811-9dad-11d1-80b4-00c04fd430c8";c.URL=r},{"./parse.js":48,"./stringify.js":52}],56:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n=o(e("./rng.js")),s=o(e("./stringify.js"));function o(e){return e&&e.__esModule?e:{default:e}}var i=function(e,t,c){const o=(e=e||{}).random||(e.rng||n.default)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){c=c||0;for(let e=0;e<16;++e)t[c+e]=o[e];return t}return(0,s.default)(o)};c.default=i},{"./rng.js":50,"./stringify.js":52}],57:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n=o(e("./v35.js")),s=o(e("./sha1.js"));function o(e){return e&&e.__esModule?e:{default:e}}var i=(0,n.default)("v5",80,s.default);c.default=i},{"./sha1.js":51,"./v35.js":55}],58:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n,s=(n=e("./regex.js"))&&n.__esModule?n:{default:n};var o=function(e){return"string"==typeof e&&s.default.test(e)};c.default=o},{"./regex.js":49}],59:[function(e,t,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var n,s=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var o=function(e){if(!(0,s.default)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)};c.default=o},{"./validate.js":58}],60:[function(e,t,c){"use strict";t.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},{}]},{},[4]);
//# sourceMappingURL=mz700-worker.min.js.map